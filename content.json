{"meta":{"title":"éº¦ç”°éº¦ç©—","subtitle":"","description":"","author":"vison","url":"http://visonforcoding.xyz","root":"/"},"pages":[{"title":"å…³äºŽ","date":"2021-11-29T09:49:46.136Z","updated":"2021-11-29T09:49:46.136Z","comments":true,"path":"about/index.html","permalink":"http://visonforcoding.xyz/about/index.html","excerpt":"","text":"13å¹´ï¼Œç½‘ç»œå·¥ç¨‹ä¸“ä¸šæ¯•ä¸š PHP/JAVA/PYTHONç¼–ç¨‹å¼€å‘ wechat: AI348462402 å¤‡æ³¨ï¼šgithub.io è½¯ä»¶å¼€å‘ã€æŠ€æœ¯æ‹›è˜å’¨è¯¢ã€æŠ€æœ¯é¡¾é—®"},{"title":"æ‰€æœ‰æ ‡ç­¾","date":"2021-10-30T02:59:33.284Z","updated":"2021-10-30T02:59:33.284Z","comments":true,"path":"tags/index.html","permalink":"http://visonforcoding.xyz/tags/index.html","excerpt":"","text":""},{"title":"æ‰€æœ‰åˆ†ç±»","date":"2021-10-30T02:59:33.284Z","updated":"2021-10-30T02:59:33.284Z","comments":true,"path":"categories/index.html","permalink":"http://visonforcoding.xyz/categories/index.html","excerpt":"","text":""},{"title":"æˆ‘çš„æœ‹å‹ä»¬","date":"2021-10-30T02:59:33.284Z","updated":"2021-10-30T02:59:33.284Z","comments":true,"path":"friends/index.html","permalink":"http://visonforcoding.xyz/friends/index.html","excerpt":"è¿™é‡Œå†™å‹é“¾ä¸Šæ–¹çš„å†…å®¹ã€‚","text":"è¿™é‡Œå†™å‹é“¾ä¸Šæ–¹çš„å†…å®¹ã€‚ è¿™é‡Œå¯ä»¥å†™å‹é“¾é¡µé¢ä¸‹æ–¹çš„æ–‡å­—å¤‡æ³¨ï¼Œä¾‹å¦‚è‡ªå·±çš„å‹é“¾è§„èŒƒã€ç¤ºä¾‹ç­‰ã€‚"}],"posts":[{"title":"èŠèŠå¾®ä¿¡ä½“ç³»çš„å‡ å¤§å¹³å°","slug":"èŠèŠå¾®ä¿¡ä½“ç³»çš„å‡ å¤§å¹³å°","date":"2021-12-08T05:31:53.000Z","updated":"2021-12-08T05:32:54.307Z","comments":true,"path":"2021/12/08/èŠèŠå¾®ä¿¡ä½“ç³»çš„å‡ å¤§å¹³å°/","link":"","permalink":"http://visonforcoding.xyz/2021/12/08/%E8%81%8A%E8%81%8A%E5%BE%AE%E4%BF%A1%E4%BD%93%E7%B3%BB%E7%9A%84%E5%87%A0%E5%A4%A7%E5%B9%B3%E5%8F%B0/","excerpt":"å½“å‰å¾®ä¿¡æœ‰å•†æˆ·å¹³å°ã€å¼€æ”¾å¹³å°ã€å¾®ä¿¡å·(å°ç¨‹åº)æ€»å…±3å¤§å¹³å°ã€‚è·Ÿè®¢é˜…å·ã€æœåŠ¡å·ä¸€æ ·ï¼Œæ¦‚å¿µåè¯éžå¸¸å¤š,æžå®¹æ˜“å¼„æ··ã€‚è·Ÿå…¶å¼€å‘æ–‡æ¡£ä¸€æ ·ï¼Œå¾®ä¿¡ä½“ç³»è¢«ä¸å°‘å¼€å‘åæ§½å¾ˆæ·±ã€‚ çŽ°åœ¨å°±é’ˆå¯¹å¾®ä¿¡ä½“ç³»äº§å“å¹³å°åšä¸€ä¸ªæ€»ç»“ï¼Œé¿å…æ··æ·†å’Œäº†è§£å„ä¸ªæ¦‚å¿µç”¨é€”ã€‚","text":"å½“å‰å¾®ä¿¡æœ‰å•†æˆ·å¹³å°ã€å¼€æ”¾å¹³å°ã€å¾®ä¿¡å·(å°ç¨‹åº)æ€»å…±3å¤§å¹³å°ã€‚è·Ÿè®¢é˜…å·ã€æœåŠ¡å·ä¸€æ ·ï¼Œæ¦‚å¿µåè¯éžå¸¸å¤š,æžå®¹æ˜“å¼„æ··ã€‚è·Ÿå…¶å¼€å‘æ–‡æ¡£ä¸€æ ·ï¼Œå¾®ä¿¡ä½“ç³»è¢«ä¸å°‘å¼€å‘åæ§½å¾ˆæ·±ã€‚ çŽ°åœ¨å°±é’ˆå¯¹å¾®ä¿¡ä½“ç³»äº§å“å¹³å°åšä¸€ä¸ªæ€»ç»“ï¼Œé¿å…æ··æ·†å’Œäº†è§£å„ä¸ªæ¦‚å¿µç”¨é€”ã€‚ å¹³å°äº§å“ å¼€æ”¾å¹³å°ï¼Œhttps://open.weixin.qq.com/ å…¬ä¼—å¹³å°(å«å°ç¨‹åº) https://mp.weixin.qq.com/ å•†æˆ·å¹³å° https://pay.weixin.qq.com/ å…¬ä¼—å¹³å°å›žé¡¾ä¸€ä¸‹å¾®ä¿¡åŽ†å²ï¼š 2011å¹´1æœˆ21æ—¥ï¼Œå¾®ä¿¡æ­£å¼å‘å¸ƒ 2011å¹´5æœˆï¼Œå¾®ä¿¡æŽ¨å‡ºäº†â€è¯­éŸ³æ¶ˆæ¯â€è¿™ä¸ªå…³é”®åŠŸèƒ½ 2012å¹´5æœˆï¼Œå¾®ä¿¡æŽ¨å‡ºâ€æœ‹å‹åœˆâ€ 2013å¹´8æœˆï¼Œå¾®ä¿¡æ·»åŠ äº†å…¬ä¼—å·ã€å¾®ä¿¡æ”¯ä»˜ 2017å¹´1æœˆï¼Œå°ç¨‹åºçš„å¼€å‘æŒ‡å—å’Œ API æ­£å¼å‘å¸ƒ åœ¨13å¹´æŽ¨å‡ºçš„å¾®ä¿¡å…¬ä¼—å·å¾®ä¿¡æ”¯ä»˜èƒ½åŠ›ï¼Œå½¼æ—¶å…¬ä¼—å·å’Œå¾®ä¿¡æ”¯ä»˜å¤§å—æ¬¢è¿Žã€‚å…¬ä¼—å·åˆåˆ†ä¸ºæœåŠ¡å·å’Œè®¢é˜…å·ï¼Œè®¢é˜…å·å¯ä»¥è¯´æ˜¯æ­å¼€äº†è‡ªåª’ä½“çˆ†å‘çš„å¸·å¹•ã€‚è‡ªæ­¤å¯ä»¥è¯´ä¸­å›½è‡ªåª’ä½“1.0æ—¶ä»£æ¥ä¸´ï¼Œ2.0æ—¶ä»£æˆ‘è®¤ä¸ºæ˜¯æŠ–éŸ³ã€å¿«æ‰‹ç­‰å¹³å°çš„å…´èµ·ã€‚ è®¢é˜…å·ä¸»è¦æœåŠ¡åª’ä½“ã€ä¸ªäººç­‰ç”¨äºŽä¿¡æ¯å‘å¸ƒ æœåŠ¡å·æä¾›æ›´å¤šçš„è¿è¥èƒ½åŠ›å’Œè‡ªä¸»å¼€å‘æŽ¥å£èƒ½åŠ›,é€‚åˆä¼ä¸š å°ç¨‹åºç›¸å¯¹äºŽå…¬ä¼—å·ï¼Œç›¸æ¯”å…¬ä¼—å·å†…çš„H5åº”ç”¨æœ‰æ›´å¥½çš„ç”¨æˆ·ä½“éªŒå’Œæ›´å¤šçš„å¾®ä¿¡æä¾›çš„æŽ¥å£èƒ½åŠ›ã€‚ æœåŠ¡å·ã€è®¢é˜…å·åŠŸèƒ½åŒºåˆ« è…¾è®¯å®¢æœå®˜æ–¹å¯¹äºŽå…¬ä¼—å·ã€è®¢é˜…å·çš„å®šä¹‰åŒºåˆ« è¿™ä¸ªé“¾æŽ¥æ˜¯è€é“¾æŽ¥äº†ï¼Œè¿™é‡Œçš„è¯´æ³•æ˜¯åªæœ‰å¾®ä¿¡è®¤è¯çš„æœåŠ¡å·æ‰å…·å¤‡å¾®ä¿¡æ”¯ä»˜åŠŸèƒ½ã€‚ ä½†æ˜¯åœ¨æœ€æ–°çš„å•†æˆ·å¹³å°å…¬ä¼—å·æŽ¥å…¥æ”¯ä»˜é‡Œçš„ä»‹ç»æ˜¯æ”¯æŒè®¢é˜…å·æŽ¥å…¥æ”¯ä»˜åŠŸèƒ½ã€‚ çŽ°åœ¨æˆ‘ä»¬äº†è§£åˆ°äº†ï¼Œå…¬ä¼—å·(æœåŠ¡å·ã€è®¢é˜…å·)ã€å°ç¨‹åºçš„åŠŸèƒ½å’ŒåŒºåˆ«äº†ã€‚ å¦‚æžœä½ æ˜¯ä¸ªäººè‡ªåª’ä½“æˆ–ç»„ç»‡ï¼Œæ²¡æœ‰è®¡ç®—æœºæŠ€æœ¯å¼€å‘èƒ½åŠ›é‚£ä¹ˆä½ å¤§æ¦‚éœ€è¦è®¢é˜…å· å¦‚æžœä½ æ˜¯ä¼ä¸šï¼Œæœ‰å¼€å‘èƒ½åŠ›é‚£ä¹ˆä½ å¤§æ¦‚éœ€è¦çš„æ˜¯æœåŠ¡å· å¦‚æžœä½ ä½œä¸ºä¼ä¸šï¼Œåˆéœ€è¦æ›´å¥½ä½“éªŒçš„ç”¨å¾®ä¿¡ä½œä¸ºå…¥å£çš„ç§»åŠ¨åº”ç”¨é‚£ä¹ˆç›¸è¾ƒäºŽå¾®ä¿¡å†…çš„H5åº”ç”¨ä½ å¯èƒ½æ›´åº”è¯¥é€‰æ‹©å°ç¨‹åº å…¬ä¼—å·æ˜¯æœåŠ¡å·ã€è®¢é˜…å·çš„ç»Ÿç§° å…¬ä¼—å·(æœåŠ¡å·ã€è®¢é˜…å·)ã€å°ç¨‹åºç®¡ç†å…¥å£éƒ½æ˜¯ https://mp.weixin.qq.com å¾®ä¿¡æ”¯ä»˜åœ¨ä¸­å›½,å‡ ä¹Ž99%çš„ä¼ä¸šåº”è¯¥éƒ½ä¼šä½¿ç”¨åˆ°å¾®ä¿¡æ”¯ä»˜ï¼Œæ‰€ä»¥å¯¹æŽ¥å¾®ä¿¡æ”¯ä»˜æ˜¯ä¼ä¸šåº”ç”¨å¼€å‘è€…ä¸å¯é¿å…çš„å·¥ä½œã€‚ å…¶ä¸­ï¼Œ JSAPIæ”¯ä»˜ Nativeæ”¯ä»˜ APPæ”¯ä»˜ å°ç¨‹åºæ”¯ä»˜ éƒ½æ˜¯å¼€å‘è€…ä»¬ä¼šæ¶‰åŠåˆ°çš„å¯èƒ½éœ€è¦å¯¹æŽ¥çš„æ”¯ä»˜æ–¹å¼ã€‚ JSAPIæ”¯ä»˜ å•†æˆ·å·²æœ‰H5å•†åŸŽç½‘ç«™ï¼Œç”¨æˆ·é€šè¿‡æ¶ˆæ¯æˆ–æ‰«æäºŒç»´ç åœ¨å¾®ä¿¡å†…æ‰“å¼€ç½‘é¡µæ—¶ï¼Œå¯ä»¥è°ƒç”¨å¾®ä¿¡æ”¯ä»˜å®Œæˆä¸‹å•è´­ä¹°çš„æµç¨‹ã€‚ åº”ç”¨è½½ä½“ï¼šå¾®ä¿¡æµè§ˆå™¨å†…æ‰“å¼€çš„åº”ç”¨ ä»ŽæŠ€æœ¯è§’åº¦è®²ï¼Œå°±æ˜¯åœ¨å¾®ä¿¡å†…æ‰“å¼€ç§»åŠ¨é¡µé¢,é€šè¿‡JS(javascript)è°ƒç”¨å¾®ä¿¡çš„APIå”¤èµ·æ”¯ä»˜ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒJSAPIå”¤èµ·åªèƒ½æ˜¯åœ¨å¾®ä¿¡å†…è°ƒç”¨ï¼Œå³JSAPIæ”¯ä»˜ä¸€å®šæ˜¯åœ¨å¾®ä¿¡æµè§ˆå™¨å†…è§¦å‘ æ­¤æ”¯ä»˜æ–¹å¼åœºæ™¯æœ‰ï¼š ä»Žå…¬ä¼—å·å¯¼èˆªæˆ–æ¶ˆæ¯ç‚¹å¼€çš„H5ç½‘é¡µ H5ç½‘é¡µé“¾æŽ¥ï¼Œå¾®ä¿¡æ‰«ç æ‰“å¼€ H5æ”¯ä»˜ è¦æ±‚å•†æˆ·å·²æœ‰H5å•†åŸŽç½‘ç«™ï¼Œå¹¶ä¸”å·²ç»è¿‡ICPå¤‡æ¡ˆã€‚é€šè¿‡å¾®ä¿¡H5æ”¯ä»˜å¯ä»¥å®žçŽ°åœ¨éžå¾®ä¿¡æµè§ˆå™¨ï¼ˆå¦‚QQæµè§ˆå™¨ã€è°·æ­Œæµè§ˆå™¨ã€Safariç­‰ï¼‰ä¸­ä½¿ç”¨å¾®ä¿¡æ”¯ä»˜çš„åœºæ™¯ã€‚ åº”ç”¨è½½ä½“ï¼šéžå¾®ä¿¡æµè§ˆå™¨æ‰“å¼€çš„H5åº”ç”¨ å¾®ä¿¡å®˜æ–¹H5æ”¯ä»˜ä»‹ç» è¿™ç§æ”¯ä»˜å·²ç»ä¸èƒ½ä»Žå®˜æ–¹çš„å¯¼èˆªé¡µé¢æ‰¾åˆ°äº†ï¼Œåªèƒ½ä»Žæœç´¢å¼•æ“Žæœç´¢å‡ºå…¥å£äº†ã€‚ æˆ‘çŒœæƒ³å¤§æ¦‚ä¹Ÿæ˜¯å› ä¸ºä¸Šé¢è¯´çš„ï¼Œå®˜æ–¹å¹¶ä¸å»ºè®®è¿™ä¹ˆåšã€‚çŽ°åœ¨å¾ˆå¤šä¼ä¸šä¼šè€ƒè™‘å°†ç¬¬äºŒæ›²çº¿ä¸šåŠ¡åº”ç”¨ä½¿ç”¨H5çš„æ–¹å¼åµŒå…¥åˆ°ä¸»ä¸šåŠ¡APPå†…ï¼Œä»¥è¾¾åˆ°å¿«é€Ÿè¿­ä»£çš„ç›®çš„ã€‚è¿™æ ·å¯èƒ½çš„æƒ…å†µå°±æ˜¯ï¼Œä¸€ä¸ªAPPå†…æœ‰å¤šç§å¾®ä¿¡æ”¯ä»˜æ–¹å¼ï¼Œä¸»ä¸šåŠ¡çš„åŽŸç”ŸAPPæ”¯ä»˜å’Œç¬¬äºŒæ›²çº¿ä¸šåŠ¡çš„H5æ”¯ä»˜æ–¹å¼ã€‚ èµ·å…³é”®çš„åœ°æ–¹åœ¨äºŽï¼Œä½¿ç”¨deeplinkè·³è½¬åˆ°å¾®ä¿¡å®¢æˆ·ç«¯è¿›è¡Œå”¤èµ·å¾®ä¿¡æ”¯ä»˜ã€‚ ç»Ÿä¸€ä¸‹å•æŽ¥å£è¿”å›žæ”¯ä»˜ç›¸å…³å‚æ•°ç»™å•†æˆ·åŽå°ï¼Œå¦‚æ”¯ä»˜è·³è½¬urlï¼ˆå‚æ•°åâ€œmweb_urlâ€ï¼‰ï¼Œå•†æˆ·é€šè¿‡mweb_urlè°ƒèµ·å¾®ä¿¡æ”¯ä»˜ä¸­é—´é¡µ ç»Ÿä¸€ä¸‹å•APIæŽ¥å£è¿”å›žæ”¯ä»˜è·³è½¬é“¾æŽ¥ mweb_url. mweb_urlä¸ºæ‹‰èµ·å¾®ä¿¡æ”¯ä»˜æ”¶é“¶å°çš„ä¸­é—´é¡µé¢ï¼Œå¯é€šè¿‡è®¿é—®è¯¥urlæ¥æ‹‰èµ·å¾®ä¿¡å®¢æˆ·ç«¯ï¼Œå®Œæˆæ”¯ä»˜,mweb_urlçš„æœ‰æ•ˆæœŸä¸º5åˆ†é’Ÿã€‚ Nativeæ”¯ä»˜ Nativeæ”¯ä»˜æ˜¯æŒ‡å•†æˆ·ç³»ç»ŸæŒ‰å¾®ä¿¡æ”¯ä»˜åè®®ç”Ÿæˆæ”¯ä»˜äºŒç»´ç ï¼Œç”¨æˆ·å†ç”¨å¾®ä¿¡â€œæ‰«ä¸€æ‰«â€å®Œæˆæ”¯ä»˜çš„æ¨¡å¼ã€‚è¯¥æ¨¡å¼é€‚ç”¨äºŽPCç½‘ç«™ã€å®žä½“åº—å•å“æˆ–è®¢å•ã€åª’ä½“å¹¿å‘Šæ”¯ä»˜ç­‰åœºæ™¯ Nativeæ”¯ä»˜å³æ‰«ç æ”¯ä»˜ï¼Œä¸»è¦åº”ç”¨åœºæ™¯æ˜¯åœ¨PCç½‘ç«™åº”ç”¨é€šè¿‡å¾®ä¿¡æ‰«æç½‘ç«™ç”Ÿæˆçš„å¸¦æœ‰å•†å“ä¿¡æ¯çš„æ”¯ä»˜äºŒç»´ç è¿›è¡Œæ”¯ä»˜ã€‚ åº”ç”¨è½½ä½“ï¼šä¼ä¸šçš„PCç½‘ç«™ Appæ”¯ä»˜ APPæ”¯ä»˜æ˜¯æŒ‡å•†æˆ·é€šè¿‡åœ¨ç§»åŠ¨ç«¯åº”ç”¨APPä¸­é›†æˆå¼€æ”¾SDKè°ƒèµ·å¾®ä¿¡æ”¯ä»˜æ¨¡å—æ¥å®Œæˆæ”¯ä»˜ã€‚é€‚ç”¨äºŽåœ¨ç§»åŠ¨ç«¯APPä¸­é›†æˆå¾®ä¿¡æ”¯ä»˜åŠŸèƒ½çš„åœºæ™¯ã€‚ åº”ç”¨è½½ä½“ï¼šä¼ä¸šçš„APP å°ç¨‹åºæ”¯ä»˜ å•†æˆ·å·²æœ‰å¾®ä¿¡å°ç¨‹åºï¼Œç”¨æˆ·é€šè¿‡å¥½å‹åˆ†äº«æˆ–æ‰«æäºŒç»´ç åœ¨å¾®ä¿¡å†…æ‰“å¼€å°ç¨‹åºæ—¶ï¼Œå¯ä»¥è°ƒç”¨å¾®ä¿¡æ”¯ä»˜å®Œæˆä¸‹å•è´­ä¹°çš„æµç¨‹ã€‚ ç±»ä¼¼äºŽJSAPIæ”¯ä»˜ï¼Œåªæ˜¯æ˜¯åœ¨å°ç¨‹åºå†…å”¤èµ·ã€‚ åº”ç”¨è½½ä½“ï¼šå¾®ä¿¡å°ç¨‹åº å°ç»“ ä¸Šè¿°5ç§æ”¯ä»˜æ–¹å¼,æ”¯ä»˜åŠ¨ä½œéƒ½æ˜¯åœ¨å¾®ä¿¡APPå†… è¦ä¹ˆæœ¬èº«ä¸šåŠ¡åº”ç”¨å°±åœ¨å¾®ä¿¡å†…,è¦ä¹ˆæ˜¯ä½¿ç”¨å¾®ä¿¡æ‰«ç æˆ–è€…APPè·³è½¬åˆ°å¾®ä¿¡ æ‰€æœ‰æ”¯ä»˜æ–¹å¼éƒ½éœ€è¦è°ƒç”¨ä¸€ä¸ªæŽ¥å£ç»Ÿä¸€ä¸‹å•,ç»Ÿä¸€ä¸‹å•æŽ¥å£éœ€è¦2ä¸ªé‡è¦å‚æ•°appidã€mchid ç”±äºŽå¾®ä¿¡æ”¯ä»˜çš„äº§å“ä½“ç³»å…¨éƒ¨æ­è½½äºŽå¾®ä¿¡çš„ç¤¾äº¤ä½“ç³»ä¹‹ä¸Šï¼Œæ‰€ä»¥ç›´è¿žå•†æˆ·æˆ–æœåŠ¡å•†å•†æˆ·æŽ¥å…¥å¾®ä¿¡æ”¯ä»˜ä¹‹å‰ï¼Œéƒ½éœ€è¦æœ‰ä¸€ä¸ªå¾®ä¿¡ç¤¾äº¤è½½ä½“ï¼Œè¯¥è½½ä½“å¯¹åº”çš„IDå³ä¸ºAPPIDã€‚ ç»Ÿä¸€ä¸‹å•æ‰€éœ€è¦çš„appidå³ä¸ºè½½ä½“çš„appidã€‚ä¸åŒè½½ä½“éœ€è¦åœ¨ä¸åŒå¹³å°ç”³è¯·appidã€‚ å°ç¨‹åºã€å…¬ä¼—å·å‰å¾€å…¬ä¼—å¹³å°ç”³è¯·,è‡ªæœ‰APPå‰å¾€å¼€æ”¾å¹³å°ç”³è¯· mchidæ˜¯å•†æˆ·ID,æ˜¯æ”¶æ¬¾è´¦å·ã€‚éœ€å‰å¾€å•†æˆ·å¹³å°ç”³è¯·ã€‚ ä¸€ä¸ªmchidåªèƒ½å¯¹åº”ä¸€ä¸ªç»“ç®—å¸ç§ï¼Œè‹¥éœ€è¦ä½¿ç”¨å¤šä¸ªå¸ç§æ”¶æ¬¾ï¼Œéœ€è¦ç”³è¯·å¯¹åº”æ•°é‡çš„mchidã€‚ å¾®ä¿¡æ”¯ä»˜äº¤æ˜“å‘èµ·ä¾èµ–äºŽå…¬ä¼—å·ã€å°ç¨‹åºã€ç§»åŠ¨åº”ç”¨ï¼ˆå³APPIDï¼‰ä¸Žå•†æˆ·å·ï¼ˆå³MCHIDï¼‰çš„ç»‘å®šå…³ç³»ï¼Œå› æ­¤å•†æˆ·åœ¨å®Œæˆç­¾çº¦åŽï¼Œéœ€è¦ç¡®è®¤å½“å‰å•†æˆ·å·åŒappidçš„ç»‘å®šå…³ç³»ï¼Œæ–¹å¯ä½¿ç”¨ã€‚ APPIDå’Œmchidå¯ä»¥æ˜¯å¤šå¯¹å¤šçš„ç»‘å®šå…³ç³»,åŒæ—¶è®¤è¯ä¸»ä½“ä¹Ÿä¼šé€ æˆç»‘å®šå¤±è´¥ã€‚ appidå’Œmchidç»‘å®šæŒ‡å¼• åŒä¸»ä½“ç»‘å®šå¯è‡ªåŠ©å¤„ç† å¼‚ä¸»ä½“ç»‘å®šå¯èƒ½ä¼šå—èµ„æ ¼é™å®š å•†æˆ·å·ä¸Žå…¶ä»–ç±»åž‹è´¦å·å»ºç«‹å…³è”å…³ç³»åŽï¼Œæš‚ä¸æ”¯æŒè§£ç»‘ ç»‘å®šçš„APPIDå¦‚å·²æœ‰ç»‘å®šå•†æˆ·å·ï¼Œåˆ™å‘èµ·ç»‘å®šç”³è¯·çš„å•†æˆ·å·éœ€ä¸ŽAPPIDå·²ç»‘å®šçš„å•†æˆ·å·è´¹çŽ‡ä¸€è‡´ ç¬¬ä¸‰æ–¹å¹³å°åœ¨å¼€æ”¾å¹³å°ä¸­å¯ä»¥æ–°å»ºç¬¬ä¸‰æ–¹å¹³å°åº”ç”¨ã€‚ å¾®ä¿¡å¼€æ”¾å¹³å°-ç¬¬ä¸‰æ–¹å¹³å°ï¼ˆç®€ç§°ç¬¬ä¸‰æ–¹å¹³å°ï¼‰å¼€æ”¾ç»™æ‰€æœ‰é€šè¿‡å¼€å‘è€…èµ„è´¨è®¤è¯çš„å¼€å‘è€…ä½¿ç”¨ã€‚åœ¨å¾—åˆ°å…¬ä¼—å·æˆ–å°ç¨‹åºè¿è¥è€…ï¼ˆç®€ç§°è¿è¥è€…ï¼‰æŽˆæƒåŽï¼Œç¬¬ä¸‰æ–¹å¹³å°å¼€å‘è€…å¯ä»¥é€šè¿‡è°ƒç”¨å¾®ä¿¡å¼€æ”¾å¹³å°çš„æŽ¥å£èƒ½åŠ›ï¼Œä¸ºå…¬ä¼—å·æˆ–å°ç¨‹åºçš„è¿è¥è€…æä¾›è´¦å·ç”³è¯·ã€å°ç¨‹åºåˆ›å»ºã€æŠ€æœ¯å¼€å‘ã€è¡Œä¸šæ–¹æ¡ˆã€æ´»åŠ¨è¥é”€ã€æ’ä»¶èƒ½åŠ›ç­‰å…¨æ–¹ä½æœåŠ¡ã€‚ ç®€è€Œè¨€ä¹‹æ˜¯ï¼šå¦‚æžœä½ çš„ä¼ä¸šæ²¡æœ‰ç ”å‘èƒ½åŠ›ï¼Œå¯ä»¥æ‰¾æ­¤ç±»æœåŠ¡å•†åœ¨èŽ·å–ä½ çš„æŽˆæƒåŽä»£ä½ åŽ»å¼€å‘ä¸€äº›åŠŸèƒ½ã€‚æ­¤ç±»æœåŠ¡å•†éœ€è¦é¦–å…ˆæ–°å»ºç¬¬ä¸‰æ–¹å¹³å°ã€‚ è¡¥å……åˆ°ç›®å‰ä¸ºæ­¢ï¼Œ3å¤§å¹³å°éƒ½å·²ç»æµ®å‡ºæ°´é¢ï¼Œæœ€åŽåšä¸€ä¸ªæ€»ç»“è¡¥å……ã€‚ å…¬ä¼—å¹³å°ï¼Œè¿è¥è€…èº«ä»½ä¹Ÿä¼šå‚ä¸Žå¾ˆå¤šç®¡ç†å·¥ä½œ å¼€æ”¾å¹³å°ï¼Œæ›´å¤šæ˜¯å¼€å‘è€…ä»‹å…¥,æä¾›æ— ç¤¾äº¤è½½ä½“çš„APPæ”¯ä»˜åº”ç”¨åˆ›å»ºä»¥åŠå…¶ä»–çš„å¾®ä¿¡æ‰«ç ç™»å½•ã€ç¬¬ä¸‰æ–¹å¹³å°ç­‰åŠŸèƒ½ å•†æˆ·å¹³å°ï¼Œä¸Žè´¢åŠ¡å…³ç³»ç´§å¯†ï¼Œä¸Žå¾®ä¿¡æ”¯ä»˜åŠŸèƒ½æ¯æ¯ç›¸å…³ ç¬¬ä¸‰æ–¹å¹³å°ï¼Œä¸Žå…¬ä¼—å·/å°ç¨‹åºæœåŠ¡å•†ç›¸å…³ï¼Œæä¾›ç»™æ— ç ”å‘èƒ½åŠ›çš„ä¼ä¸šï¼ŒæŽˆæƒæœåŠ¡å•†ä»£å¼€å‘çš„èƒ½åŠ›ã€‚","categories":[],"tags":[{"name":"ç¼–ç äººç”Ÿ","slug":"ç¼–ç äººç”Ÿ","permalink":"http://visonforcoding.xyz/tags/%E7%BC%96%E7%A0%81%E4%BA%BA%E7%94%9F/"}]},{"title":"spring-bootè®°å½•å¹¶ç»Ÿè®¡sqlæŽ¢ç´¢,çº¿ç¨‹å®‰å…¨æ–¹å¼","slug":"java/spring-bootè®°å½•sqlæŽ¢ç´¢","date":"2021-12-04T03:28:29.000Z","updated":"2021-12-04T03:58:28.535Z","comments":true,"path":"2021/12/04/java/spring-bootè®°å½•sqlæŽ¢ç´¢/","link":"","permalink":"http://visonforcoding.xyz/2021/12/04/java/spring-boot%E8%AE%B0%E5%BD%95sql%E6%8E%A2%E7%B4%A2/","excerpt":"ç›®æ ‡è®°å½•æ¯æ¬¡è¯·æ±‚å†…çš„httpã€esã€mysqlè€—æ—¶ï¼Œæœ¬ç¯‡è®¨è®ºmysqléƒ¨åˆ† ä¸ºä»€ä¹ˆè¯´è¦æŽ¢ç´¢ï¼Œè¿™ä¸æ˜¯å¾ˆç®€å•çš„äº‹ä¹ˆï¼Ÿä½†æ˜¯èƒ½æ»¡è¶³ä»¥ä¸‹å‡ ç‚¹ä¹ˆï¼Ÿ èƒ½è®°å½•limitç­‰å‚æ•° èƒ½å°†å‚æ•°å’Œsqlå†™ä¸€èµ·ï¼Œèƒ½ç›´æŽ¥ä½¿ç”¨ èƒ½è®°å½•è€—æ—¶ èƒ½è®¡æ•°ç´¯åŠ ,ç»Ÿè®¡ä¸€æ¬¡è¯·æ±‚ä¸­sqlæ‰§è¡Œçš„æ€»æ•°å’Œæ€»è€—æ—¶","text":"ç›®æ ‡è®°å½•æ¯æ¬¡è¯·æ±‚å†…çš„httpã€esã€mysqlè€—æ—¶ï¼Œæœ¬ç¯‡è®¨è®ºmysqléƒ¨åˆ† ä¸ºä»€ä¹ˆè¯´è¦æŽ¢ç´¢ï¼Œè¿™ä¸æ˜¯å¾ˆç®€å•çš„äº‹ä¹ˆï¼Ÿä½†æ˜¯èƒ½æ»¡è¶³ä»¥ä¸‹å‡ ç‚¹ä¹ˆï¼Ÿ èƒ½è®°å½•limitç­‰å‚æ•° èƒ½å°†å‚æ•°å’Œsqlå†™ä¸€èµ·ï¼Œèƒ½ç›´æŽ¥ä½¿ç”¨ èƒ½è®°å½•è€—æ—¶ èƒ½è®¡æ•°ç´¯åŠ ,ç»Ÿè®¡ä¸€æ¬¡è¯·æ±‚ä¸­sqlæ‰§è¡Œçš„æ€»æ•°å’Œæ€»è€—æ—¶ springåŽŸç”Ÿèƒ½åŠ›logging.level.org.hibernate.SQL=debug logging.level.org.hibernate.type.descriptor.sql.BasicBinder=trace é€šè¿‡ä¸Šé¢ä¸¤æ¡é…ç½®ã€‚ âœ”ï¸å¯ä»¥æ˜¾ç¤ºsql. âŒä¸èƒ½å’Œå‚æ•°ä¸€è¡Œæ˜¾ç¤º âŒä¸èƒ½æ˜¾ç¤ºlimitå‚æ•° âŒä¸èƒ½è®¡æ•°å’Œè®°å½•è€—æ—¶ 2021-02-23 19:35:42.932 DEBUG 97586 --- [ restartedMain] org.hibernate.SQL : select admin0_.id as id1_0_, admin0_.create_time as create_t2_0_, admin0_.modify_time as modify_t3_0_, admin0_.email as email4_0_, admin0_.password as password5_0_, admin0_.status as status6_0_, admin0_.username as username7_0_ from admin admin0_ where admin0_.username&#x3D;? 2021-02-23 19:35:42.949 TRACE 97586 --- [ restartedMain] o.h.type.descriptor.sql.BasicBinder : binding parameter [1] as [VARCHAR] - [root] åŽŸç”Ÿlog+org.hibernate.EmptyInterceptororg.hibernate.EmptyInterceptoræä¾›é’©å­ï¼Œhibernateæœ¬èº«æä¾›entityçš„curdé’©å­ã€‚é‡å†™EmptyInterceptoræ–¹æ³•ï¼Œå¯ä»¥å®žçŽ°è®¡æ•°ã€‚ä½†æ˜¯onPrepareStatementæ–¹æ³•åªæ˜¯è£…é…sqlå‰çš„äº‹ä»¶ï¼Œè€Œä¸”ä¸æ˜¯å®Œæ•´çš„sqlã€‚ âœ”ï¸ å¯ä»¥æ˜¾ç¤ºsql âŒ ä¸èƒ½å’Œå‚æ•°ä¸€è¡Œæ˜¾ç¤º âŒ ä¸èƒ½æ˜¾ç¤ºlimitå‚æ•° âœ”ï¸ èƒ½è®¡æ•° âŒ ä¸èƒ½è®°å½•è€—æ—¶ spring.jpa.properties.hibernate.ejb.interceptor=com.vison.itdoc.config.HibernateInterceptor public class HibernateInterceptor extends EmptyInterceptor &#123; @Override public boolean onLoad(Object entity, Serializable id, Object[] state, String[] propertyNames, Type[] types) &#123; // Log.info(\"onload...\", entity) return true; &#125; @Override public String onPrepareStatement(String string) &#123; // count++ return INSTANCE.onPrepareStatement(string); &#125; @Override public void afterTransactionCompletion(Transaction t) &#123; INSTANCE.afterTransactionCompletion(t); Log.info(\"after trans complete\", t); &#125; &#125; log4jdbclog4jdbcèƒ½å¾ˆå¥½çš„è§£å†³sqlå®Œæ•´æ˜¾ç¤ºå’Œè®°å½•è€—æ—¶çš„é—®é¢˜ 2021-02-23 19:59:13.709 INFO 97586 --- [nio-8081-exec-1] jdbc.sqltiming : select posts0_.id as id1_2_, posts0_.create_time as create_t2_2_, posts0_.modify_time as modify_t3_2_, posts0_.content as content4_2_, posts0_.title as title5_2_ from posts posts0_ where 1&#x3D;1 order by posts0_.id asc limit 10 ; &#123;executed in 1 msec&#125; è¿˜èƒ½å¤Ÿå®šä¹‰è¶…è¿‡1å®šæ—¶é—´çš„æ‰§è¡Œsqlè®°å½•ä¸ºerrorç±»åž‹ã€‚ &lt;dependency> &lt;groupId>com.googlecode.log4jdbc&lt;/groupId> &lt;artifactId>log4jdbc&lt;/artifactId> &lt;version>1.2&lt;/version> &lt;scope>runtime&lt;/scope> &lt;/dependency> spring.datasource.driver-class-name: net.sf.log4jdbc.DriverSpy #ä½¿ç”¨log4jdbcåŽmysqlçš„url spring.datasource.url=jdbc:log4jdbc:mysql://localhost:3306/xxxx?useUnicode=true&amp;characterEncoding=UTF-8 #ä½¿ç”¨log4jdbcåŽoracleçš„url #spring.datasource.url: jdbc:log4jdbc:oracle:thin:@127.0.0.1:1521:orcl æ³¨æ„éœ€è¦æ·»åŠ spring.datasource.driver-class-name å’Œæ›´æ”¹ spring.datasource.url å°†jdbcæ”¹ä¸º jdbc:log4jdbc log4jdbc.propertieså¯ä»¥å®šä¹‰æ›´å¤šé…ç½® #é…ç½®ä¸ºéœ€è¦è®°å½•çš„åŒ…æˆ–ç±»åŒ¹é…è·¯å¾„ #log4jdbc.debug.stack.prefix=com.drp #log4jdbcåŠ è½½çš„drivers (é©±åŠ¨å) #log4jdbc.drivers=oracle.jdbc.OracleDriver log4jdbc.auto.load.popular.drivers=true #åœ¨æ—¥å¿—ä¸­æ˜¾ç¤ºwarnè­¦å‘Š log4jdbc.statement.warn=true #æ¯«ç§’å€¼.æ‰§è¡Œæ—¶é—´è¶…è¿‡è¯¥å€¼çš„SQLè¯­å¥å°†è¢«è®°å½•ä¸ºwarnçº§åˆ«. log4jdbc.sqltiming.warn.threshold=2000 #æ¯«ç§’å€¼.æ‰§è¡Œæ—¶é—´è¶…è¿‡è¯¥å€¼çš„SQLè¯­å¥å°†è¢«è®°å½•ä¸ºerrorçº§åˆ«. log4jdbc.sqltiming.error.threshold=3000 #æ˜¯æŠŠbooleanè®°å½•ä¸º 'true'/'false' è¿˜æ˜¯ 1/0. é»˜è®¤è®¾ç½®ä¸ºfalse,ä¸å¯ç”¨,ä¸ºäº†ç§»æ¤æ€§. #log4jdbc.dump.booleanastruefalse=true #è¾“å‡ºçš„sql,ä¸€è¡Œæœ€å¤§çš„å­—ç¬¦æ•°ï¼Œé»˜è®¤90. ä»¥åŽæ–°ç‰ˆå¯èƒ½ä¸º0 #log4jdbc.dump.sql.maxlinelength=90 #å¦‚æžœåœ¨è°ƒè¯•æ¨¡å¼ä¸‹è½¬å‚¨ï¼Œåˆ™è½¬å‚¨æ•´ä¸ªå †æ ˆè·Ÿè¸ª é»˜è®¤false log4jdbc.dump.fulldebugstacktrace=false #æ˜¯å¦è®°å½•æŸäº›ç±»åž‹çš„è¯­å¥ï¼Œé»˜è®¤true log4jdbc.dump.sql.select=true log4jdbc.dump.sql.insert=true log4jdbc.dump.sql.delete=true log4jdbc.dump.sql.update=true log4jdbc.dump.sql.create=true #è¾“å‡ºsqlæœ«å°¾å¤„åŠ å…¥åˆ†å·ï¼Œé»˜è®¤false log4jdbc.dump.sql.addsemicolon=true #å°†æ­¤è®¾ç½®ä¸ºfalseä»¥ä¸ä¿®å‰ªå·²è®°å½•çš„SQL log4jdbc.trim.sql=true #å°†æ­¤è®¾ç½®ä¸ºfalseä¸åˆ é™¤é¢å¤–çš„ç©ºè¡Œ log4jdbc.trim.sql.extrablanklines=true #log4jdbc.suppress.generated.keys.exception=false âœ”ï¸ å¯ä»¥æ˜¾ç¤ºsql âœ”ï¸ ä¸èƒ½å’Œå‚æ•°ä¸€èµ·æ˜¾ç¤º âœ”ï¸ ä¸èƒ½æ˜¾ç¤ºlimitå‚æ•° âŒ èƒ½è®¡æ•° âœ”ï¸ èƒ½è®°å½•å•ä¸ªsqlè€—æ—¶ âŒ ä¸èƒ½ç»Ÿè®¡æ€»è€—æ—¶ ä¸è¶³çš„æ˜¯ï¼Œå•çº¯log4jdbcå¹¶ä¸èƒ½æ»¡è¶³æ‰€æœ‰ã€‚ç†è®ºä¸Šlog4jdbc+org.hibernate.EmptyInterceptorå¯ä»¥æ»¡è¶³éœ€æ±‚äº† P6Spyæµ‹è¯•å®Œæ¯•ï¼Œå‘çŽ°P6Spyç›®å‰æœ€èƒ½æ»¡è¶³éœ€æ±‚ï¼š âœ”ï¸ å¯ä»¥æ˜¾ç¤ºsql âœ”ï¸ ä¸èƒ½å’Œå‚æ•°ä¸€èµ·æ˜¾ç¤º âœ”ï¸ ä¸èƒ½æ˜¾ç¤ºlimitå‚æ•° âœ”ï¸ èƒ½è®¡æ•° âœ”ï¸ ä¸èƒ½è®°å½•è€—æ—¶ âœ”ï¸ æ”¯æŒcurdäº‹ä»¶å‰åŽé’©å­ï¼Œé’©å­å‚æ•°è¿”å›žsqlå’Œæ‰§è¡Œè€—æ—¶åŠå¼‚å¸¸ä¿¡æ¯ðŸš€ &lt;dependency> &lt;groupId>p6spy&lt;/groupId> &lt;artifactId>p6spy&lt;/artifactId> &lt;version>3.9.1&lt;/version> &lt;/dependency> åŒlog4jdbcéœ€è¦æ”¹driverå’Œurl spring.datasource.driver-class-name=com.p6spy.engine.spy.P6SpyDriver spring.datasource.url=jdbc:p6spy:mysql://localhost:3306/test?useLegacyDatetimeCode=false&amp;serverTimezone=UTC psy.propertieså¯ä»¥å®šä¹‰æ›´å¤šé…ç½® #modulelist=com.p6spy.engine.spy.P6SpyFactory,com.p6spy.engine.logging.P6LogFactory,com.p6spy.engine.outage.P6OutageFactory modulelist=com.vison.itdoc.config.CustomeP6Factory,com.p6spy.engine.logging.P6LogFactory,com.p6spy.engine.outage.P6OutageFactory #moduelistå¾ˆå…³é”®ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨äº†è‡ªå®šä¹‰çš„Factoryï¼Œå› ä¸ºæˆ‘éœ€è¦è‡ªå®šä¹‰event appender=com.p6spy.engine.spy.appender.Slf4JLogger logMessageFormat=com.p6spy.engine.spy.appender.CustomLineFormat customLogMessageFormat=%(executionTime) ms|%(category)|%(sql) excludecategories=result,resultset,info,debug æ­£å¸¸ä½¿ç”¨é»˜è®¤é…ç½®å°±å¯ä»¥æ˜¾ç¤ºå‡ºsqlå’Œè€—æ—¶ä¿¡æ¯ 4 ms|statement|select admin0_.id as id1_0_, admin0_.create_time as create_t2_0_, admin0_.modify_time as modify_t3_0_, admin0_.email as email4_0_, admin0_.password as password5_0_, admin0_.status as status6_0_, admin0_.username as username7_0_ from admin admin0_ where admin0_.username&#x3D;&#39;root&#39; å¯ä»¥çœ‹åˆ°ï¼Œè€—æ—¶ä¿¡æ¯å’Œå®žé™…å‚æ•° è‡ªå®šä¹‰äº‹ä»¶modulelist=com.p6spy.engine.spy.P6SpyFactoryæ”¹æˆè‡ªå®šä¹‰Factory è‡ªå®šä¹‰Factory public class CustomeP6Factory implements com.p6spy.engine.spy.P6Factory &#123; @Override public P6LoadableOptions getOptions(P6OptionsRepository optionsRepository) &#123; return new P6SpyOptions(optionsRepository); &#125; @Override public JdbcEventListener getJdbcEventListener() &#123; return new P6spyListener(); //ä½¿ç”¨è‡ªå®šä¹‰Listener &#125; &#125; è‡ªå®šä¹‰äº‹ä»¶ public class P6spyListener extends JdbcEventListener &#123; @Override public void onAfterExecuteQuery(PreparedStatementInformation statementInformation, long timeElapsedNanos, SQLException e) &#123; App.sqlCount.incrementAndGet(); Log.info(\"execute query...\", statementInformation.getSqlWithValues()); &#125; @Override public void onAfterExecuteUpdate(PreparedStatementInformation statementInformation, long timeElapsedNanos, int rowCount, SQLException e) &#123; App.sqlCount.incrementAndGet(); Log.info(\"execute update..\", statementInformation.getSqlWithValues()); &#125; @Override public void onAfterExecute(StatementInformation statementInformation, long timeElapsedNanos, String sql, SQLException e) &#123; Log.info(\"execute..\", statementInformation.getSqlWithValues()); &#125; &#125; å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘åœ¨è‡ªå®šä¹‰äº‹ä»¶ä¸­è¿›è¡Œäº†sqlè®¡æ•°.äºŽæ˜¯æˆ‘å¯ä»¥åœ¨è¯·æ±‚ç»“æŸæ—¶æ‰“å°æ¯æ¬¡è¯·æ±‚çš„æ€»sqlæ‰§è¡Œæ¬¡æ•°ã€‚ public class RequestInitInterceptor implements HandlerInterceptor &#123; public RequestInitInterceptor() &#123; &#125; @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123; App._uniq_req_no = UUID.randomUUID().toString(); App.sqlCount = new AtomicInteger(0); Log.setMsgTraceNo(App._uniq_req_no); Log.info(\"request start...\", handler); return true; &#125; @Override public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception &#123; Log.info(String.format(\"finish request sqlæ‰§è¡Œæ¬¡æ•°:%s\", App.sqlCount)); &#125; &#125; ç”±äºŽäº‹ä»¶å‚æ•°è¿˜ç»™å‡ºäº†timeElapsedNanos,æœ€ç»ˆæˆ‘ä»¬è¿˜èƒ½ç»Ÿè®¡å‡ºæ‰€æœ‰sqlæ‰§è¡Œçš„è€—æ—¶ã€‚è¿™æ ·ä¸€æ¥æˆ‘ä»¬å°±èƒ½çœ‹å‡ºä¸€æ¬¡è¯·æ±‚å†…ï¼Œæœ€è€—æ—¶çš„æ“ä½œå…·ä½“æ˜¯ä»€ä¹ˆã€‚è¾¾åˆ°ç±»ä¼¼ä»¥ä¸‹æ•ˆæžœï¼š çº¿ç¨‹å®‰å…¨é—®é¢˜ä»¥ä¸Šåšæ³•å…¶å®žè¿˜æœ‰ä¸ªé—®é¢˜,å¹¶æ²¡æœ‰è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚ç”¨abæµ‹è¯•åŽä¼šå‘çŽ°,sqlç»Ÿè®¡ä»ç„¶æœ‰é—®é¢˜ã€‚æ­¤æ—¶æˆ‘ä»¬éœ€è¦ç”¨åˆ°Threadlocalåœ¨å®šä¹‰çš„å…¨å±€é™æ€å±žæ€§å½“ä¸­å®žé™…ä¸Šå·²ç»æœ‰çŠ¶æ€äº†ï¼Œè€Œå¤šçº¿ç¨‹å½“ä¸­çš„å…±äº«çŠ¶æ€å¿…ç„¶ä¼šå‘ç”Ÿæ„æƒ³ä¸åˆ°çš„é—®é¢˜ã€‚æ‰€ä»¥è¿™é‡Œè¦ä½¿ç”¨å¹¶å‘ç¼–ç¨‹çš„ç›¸å…³å¤„ç†åŠžæ³•ã€‚ //ä½¿ç”¨ThreadLocal å®šä¹‰ç»Ÿè®¡å±žæ€§ public class App &#123; public static ThreadLocal&lt;Integer> count = ThreadLocal.withInitial(() -> 0);; &#125; å…¶æ¬¡,å½“Threadlocalä¸Žçº¿ç¨‹æ± ä¸€èµ·ä½¿ç”¨çš„æ—¶å€™è¿˜éœ€è¦é¢å¤–çš„æ³¨æ„ã€‚ç®€å•çš„æè¿°ä¸‹ä¼šå‘ç”Ÿçš„é—®é¢˜ï¼š åº”ç”¨ç¨‹åºä»Žçº¿ç¨‹æ± å–å‡º1ä¸ªçº¿ç¨‹ ç„¶åŽå­˜å‚¨äº†ä¸€äº›çº¿ç¨‹å†…çš„å˜é‡åˆ°è¯¥çº¿ç¨‹ ä¸€æ—¦è¯¥çº¿ç¨‹å¤„ç†å®Œæ¯•ï¼Œåº”ç”¨ç¨‹åºä¾¿ä¼šå°†è¿™ä¸ªçº¿ç¨‹æ”¾å›žåˆ°çº¿ç¨‹æ±  å½“è¿™ä¸ªçº¿ç¨‹åˆè¢«å†æ¬¡æ‹¿å‡ºæ¥å¤„ç†å¦å¤–ä¸€ä¸ªè¯·æ±‚ å› ä¸ºåº”ç”¨ç¨‹åºä¸Šæ¬¡æ²¡æœ‰è¿›è¡Œä¸“é—¨çš„æ¸…ç†åŠ¨ä½œï¼Œæ‰€ä»¥åœ¨å¤„ç†æ–°çš„è¯·æ±‚æ—¶ä½¿ç”¨çš„å¯èƒ½å°±æ˜¯ç›¸åŒçš„ThreadLocalæ•°æ® å› æ­¤æˆ‘ä»¬éœ€è¦è¿›è¡Œä¸€äº›å¿…è¦çš„æ¸…ç†åŠ¨ä½œ //æ‹¦æˆªå™¨å½“ä¸­ åœ¨ç»Ÿè®¡å®Œæ¯•æ—¶ç§»é™¤å½“å‰çº¿ç¨‹çš„Threadlocalå˜é‡ public class RequestInitInterceptor implements HandlerInterceptor &#123; @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123; return true; &#125; @Override public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception &#123; log.info(String.format(\"finish request... æ‰§è¡Œsql %d æ¬¡\", App.count.get())); App.count.remove(); &#125; &#125; è¿™æ ·æœ€ç»ˆï¼Œæˆ‘ä»¬å¯ä»¥å®‰å…¨åœ°ç»Ÿè®¡ä¸€ä¸ªè¯·æ±‚å½“ä¸­çš„sqlæ‰§è¡Œæ€»æ¬¡æ•°äº† å‚è€ƒ Counting Queries per Request with Hibernate and Spring register an event handler Threadlocal å¤„ç†çº¿ç¨‹å®‰å…¨é—®é¢˜","categories":[],"tags":[{"name":"java","slug":"java","permalink":"http://visonforcoding.xyz/tags/java/"}]},{"title":"PHP-FPMå“åº”ç”¨æˆ·è¯·æ±‚è¿‡ç¨‹","slug":"php/PHP-FPMå“åº”ç”¨æˆ·è¯·æ±‚è¿‡ç¨‹","date":"2021-12-03T09:54:37.000Z","updated":"2021-12-03T09:58:40.203Z","comments":true,"path":"2021/12/03/php/PHP-FPMå“åº”ç”¨æˆ·è¯·æ±‚è¿‡ç¨‹/","link":"","permalink":"http://visonforcoding.xyz/2021/12/03/php/PHP-FPM%E5%93%8D%E5%BA%94%E7%94%A8%E6%88%B7%E8%AF%B7%E6%B1%82%E8%BF%87%E7%A8%8B/","excerpt":"æˆ‘ä»¬å‘å¸ƒäº†éžå¸¸å¤šçš„é¡¹ç›®ï¼Œè®©å®ƒåœ¨æœºå™¨ä¸Šè¿è¡Œã€‚ä½†æ˜¯ä½ çŸ¥é“PHP-FPMç©¶ç«Ÿæ˜¯å¦‚ä½•è®©ä½ çš„æºä»£ç è¿è¡Œå¹¶å¤„ç†å¤§é‡çš„ç”¨æˆ·è¯·æ±‚ä¹ˆã€‚ å“åº”è¿‡ç¨‹","text":"æˆ‘ä»¬å‘å¸ƒäº†éžå¸¸å¤šçš„é¡¹ç›®ï¼Œè®©å®ƒåœ¨æœºå™¨ä¸Šè¿è¡Œã€‚ä½†æ˜¯ä½ çŸ¥é“PHP-FPMç©¶ç«Ÿæ˜¯å¦‚ä½•è®©ä½ çš„æºä»£ç è¿è¡Œå¹¶å¤„ç†å¤§é‡çš„ç”¨æˆ·è¯·æ±‚ä¹ˆã€‚ å“åº”è¿‡ç¨‹ Nginxå’ŒPHP-FPMé€šè¿‡ Fastcgi åè®® è¿›è¡Œäº¤æµ Web browser www.example.com | | Transport over HTTP protocol | | http server (server nginx &#x2F; APACHE) | | Configuration analysis Route to www.example.com&#x2F;index.php | | Fast CGI module loaded with nginx | | Fast CGI monitors 127.0.0.1:9000 addresses Through the fast CGI protocol, the request is forwarded to PHP FPM for processing | | Request reached 127.0.0.1:9000 | | PHP FPM monitoring 127.0.0.1:9000 This can be done through PHP- fpm.conf Make changes å¹¶è¡Œæ¨¡å¼PHPå…¶å®žæœ‰2ç§æ¨¡å¼æ¥å¤„ç†å¹¶å‘è¯·æ±‚ï¼š åŸºäºŽè¿›ç¨‹ åŸºäºŽçº¿ç¨‹ è¿›ç¨‹æ¨¡å¼æµç¨‹ æ¨¡å—åˆå§‹åŒ–: MINIT() è¿™ä¸ªçŽ¯èŠ‚ä¼šåˆå§‹åŒ–ä¸€äº›å¯¹è±¡å’Œä¸€äº›æ¯ä¸ªè¯·æ±‚ä¼šç”¨åˆ°çš„ä¿¡æ¯ï¼Œè¿™ä¸ªæ—¶å€™å¹¶æ²¡æœ‰å¼€å§‹æŽ¥æ”¶è¯·æ±‚ã€‚è¿™æ®µæ—¶é—´å¯ä»¥è®¿é—®å…¨å±€å˜é‡ã€‚ è¯·æ±‚åˆå§‹åŒ–: RINIT() PHPåœ¨è¿™ä¸ªé˜¶æ®µå¼€å§‹å¤„ç†requestï¼ŒPHPæ˜¯ä¸€ç§æ— å…±äº«æž¶æž„ï¼Œæä¾›äº†çµæ´»çš„å†…å­˜ç®¡ç†æ–¹å¼ã€‚share-nothing architectureæ„å‘³ç€ä¸ç”¨æ‹…å¿ƒå¹¶å‘å¼•å‘çš„é”™ä¹±é—®é¢˜ã€‚ åœ¨æ­¤ä¸­ï¼Œå¦‚æžœéœ€è¦åˆ†é…åŠ¨æ€å†…å­˜ï¼Œå°†ä½¿ç”¨Zendå†…å­˜ç®¡ç†å™¨ã€‚Zend å†…å­˜ç®¡ç†å™¨ä¼šè·Ÿè¸ªä½ é€šè¿‡å®ƒåˆ†é…çš„å†…å­˜ï¼Œå½“è¯·æ±‚å…³é—­æ—¶ï¼Œå¦‚æžœæ‚¨å¿˜è®°è¿™æ ·åšï¼Œå®ƒå°†å°è¯•é‡Šæ”¾å—è¯·æ±‚çº¦æŸçš„å†…å­˜ã€‚ è¯·æ±‚ç»ˆæ­¢ï¼šPRSHUTDOWN() PHPå¤„ç†è¯·æ±‚ç»“æŸï¼Œæ­¤é˜¶æ®µæ¸…ç†è¯·æ±‚å†…å­˜ã€‚æœªæ¥çš„è¯·æ±‚å½“ä¸­ä¸ä¼šæœ‰å½“å‰è¯·æ±‚çš„æ•°æ®ã€‚ æ­¤é˜¶æ®µï¼ŒRSHUTDOWN()çš„è°ƒç”¨æ—¶æœºï¼š æ¥è‡ªregister_shutdown_functionæ³¨å†Œçš„æ–¹æ³•ï¼Œç”¨æˆ·æ€çš„shutdownè°ƒç”¨æ‰§è¡Œå®Œ æ‰€æœ‰çš„å¯¹è±¡æžæž„å‡½æ•°æ‰§è¡Œå®Œ PHPè¾“å‡ºç¼“å†²flushå®Œæ¯• max_execution_timeè§¦è¾¾ è¯·æ±‚ç»ˆæ­¢åŽ: PRSHUTDOWN() æ­¤é˜¶æ®µå¾ˆå°‘è¢«ä½¿ç”¨ã€‚ å…¨å±€åˆå§‹åŒ–: GINIT() æ­¤é’©å­åœ¨çº¿ç¨‹æ¨¡åž‹ä¸‹ä¼šä¸ºæ¯ä¸ªè¯·æ±‚éƒ½è§¦å‘ä¸€æ¬¡ï¼Œä½†åœ¨å¤šè¿›ç¨‹æ¨¡åž‹ä¸‹åªè§¦å‘ä¸€æ¬¡ã€‚ å…¨å±€å˜é‡ä¸ä¼šè¢«æ¸…é™¤åœ¨æ¯ä¸ªè¯·æ±‚ä¹‹åŽï¼Œéœ€è¦æ¯æ¬¡è¿›è¡ŒRINITæ“ä½œã€‚ å…¨å±€ç»ˆæ­¢ï¼šGSHUTDOWN() ä¸ŽGINITä¸€æ ·ï¼Œå¤šçº¿ç¨‹æ¨¡å¼ä¸‹æ¯æ¬¡è¯·æ±‚ä¹‹åŽéƒ½ä¼šè§¦å‘ï¼Œå¤šè¿›ç¨‹æ¨¡å¼åªä¼šæ‰§è¡Œä¸€æ¬¡ã€‚ æ‰€ä»¥æ€»ä½“ä¸Šçš„æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š å‚è€ƒ https://www.phpinternalsbook.com/php7/extensions_design/php_lifecycle.html","categories":[],"tags":[{"name":"PHP","slug":"PHP","permalink":"http://visonforcoding.xyz/tags/PHP/"}]},{"title":"Servlet Filiter å’Œ Spring Intercetors,è®°å½•è¯·æ±‚æ—¥å¿—","slug":"java/Intercetors-è®°å½•è¯·æ±‚æ—¥å¿—","date":"2021-12-02T02:46:17.000Z","updated":"2021-12-02T02:49:44.793Z","comments":true,"path":"2021/12/02/java/Intercetors-è®°å½•è¯·æ±‚æ—¥å¿—/","link":"","permalink":"http://visonforcoding.xyz/2021/12/02/java/Intercetors-%E8%AE%B0%E5%BD%95%E8%AF%B7%E6%B1%82%E6%97%A5%E5%BF%97/","excerpt":"åœ¨å‰é¢çš„æ–‡ç« æˆ‘ä»¬æœ‰çœ‹åˆ°Servlet Filiterçš„ä½œç”¨ã€‚ä¸Žä¹‹ç±»ä¼¼çš„Springä¸­æˆ‘ä»¬çŸ¥é“æœ‰æ‹¦æˆªå™¨Intercetorsã€‚ çŽ°åœ¨æœ‰1ä¸ªéœ€æ±‚ï¼Œè®°å½•requestçš„æ‰€æœ‰è¯·æ±‚ä¿¡æ¯ï¼ŒURLã€è¯·æ±‚æ–¹æ³•ã€è¯·æ±‚ä½“ã€‚æˆ‘ä»¬è‡ªç„¶è€Œç„¶ä¼šæƒ³åˆ°ä½¿ç”¨Filiteræˆ–Intercetors Filiterå’ŒIntercetorsçš„åŒºåˆ«åœ¨äºŽæ‰€æ‰§è¡Œçš„æ—¶é—´ç‚¹ä¸åŒï¼Œä½†éƒ½åœ¨åˆ°è¾¾controllerä¹‹å‰ã€‚çœ‹èµ·æ¥äºŒè€…éƒ½å¯ä»¥å®Œæˆè¿™ä¸ªéœ€æ±‚ã€‚","text":"åœ¨å‰é¢çš„æ–‡ç« æˆ‘ä»¬æœ‰çœ‹åˆ°Servlet Filiterçš„ä½œç”¨ã€‚ä¸Žä¹‹ç±»ä¼¼çš„Springä¸­æˆ‘ä»¬çŸ¥é“æœ‰æ‹¦æˆªå™¨Intercetorsã€‚ çŽ°åœ¨æœ‰1ä¸ªéœ€æ±‚ï¼Œè®°å½•requestçš„æ‰€æœ‰è¯·æ±‚ä¿¡æ¯ï¼ŒURLã€è¯·æ±‚æ–¹æ³•ã€è¯·æ±‚ä½“ã€‚æˆ‘ä»¬è‡ªç„¶è€Œç„¶ä¼šæƒ³åˆ°ä½¿ç”¨Filiteræˆ–Intercetors Filiterå’ŒIntercetorsçš„åŒºåˆ«åœ¨äºŽæ‰€æ‰§è¡Œçš„æ—¶é—´ç‚¹ä¸åŒï¼Œä½†éƒ½åœ¨åˆ°è¾¾controllerä¹‹å‰ã€‚çœ‹èµ·æ¥äºŒè€…éƒ½å¯ä»¥å®Œæˆè¿™ä¸ªéœ€æ±‚ã€‚ æˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹Filiterã€‚Springå½“ä¸­æœ¬èº«æ”¯æŒservletçš„å‡ ä¸ªæ³¨è§£ã€‚ When using an embedded container, automatic registration of classes annotated with @WebServlet, @WebFilter, and @WebListener can be enabled by using @ServletComponentScan. ä½†æ˜¯ä»–ä¹Ÿè¯´äº†ï¼Œå¦‚æžœè¦ä¿è¯é¡ºåºï¼Œéœ€è¦é€šè¿‡å®šä¹‰FilterRegistrationBeançš„æ–¹å¼ã€‚ you must define a FilterRegistrationBean for the Filter and set the registration beanâ€™s order using the setOrder(int) method. ä¸ç®¡æ˜¯Filiterè¿˜æ˜¯Intercetorséƒ½æ˜¯éœ€è¦æ‹¿åˆ°request,ä»ŽrequestèŽ·å–è¦è®°å½•çš„ä¿¡æ¯ã€‚å½“è¦è®°å½•è¯·æ±‚ä½“çš„æ—¶å€™ï¼Œåœ¨Java IOå½“ä¸­æœ‰ä¸ªæœ€å¤§çš„é—®é¢˜æ˜¯å¦‚æžœä¸€æ—¦request.getInputStream() åŽé¢å°±ä¼šè¯»å–ä¸åˆ°è¯·æ±‚ä½“ï¼Œå¹¶æŠ›å‡ºHttpMessageNotReadableException: Required request body is missing å¼‚å¸¸ã€‚ Springæœ¬èº«æä¾›è®°å½•è¯·æ±‚ä½“çš„Filiter AbstractRequestLoggingFilter,æˆ‘ä»¬å¯ä»¥ç»§æ‰¿å¹¶è‡ªå®šä¹‰ã€‚ public class CustomizedRequestLoggingFilter extends AbstractRequestLoggingFilter &#123; @Override protected void beforeRequest(HttpServletRequest request, String message) &#123; &#125; @Override protected void afterRequest(HttpServletRequest request, String message) &#123; log.info(message); &#125; &#125; å¯ç”¨è¯¥bean @Configuration @Slf4j public class FilterConfigure &#123; @Bean public FilterRegistrationBean&lt;LogFilter> logFilter() &#123; // åˆ©ç”¨ slf4j.MDC è®°å½• å”¯ä¸€è¯·æ±‚ç  FilterRegistrationBean&lt;LogFilter> bean = new FilterRegistrationBean&lt;LogFilter>(); bean.setFilter(new LogFilter()); bean.addUrlPatterns(\"/*\");//è¿‡æ»¤æ‰€æœ‰è·¯å¾„ bean.setOrder(1); return bean; &#125; @Bean public CustomizedRequestLoggingFilter logInitFilter() &#123; //åŽŸç”Ÿbeanè®°å½•è¯·æ±‚ä¿¡æ¯ è¯·æ±‚ä½“ log.info(\"logInitFilter...\"); CustomizedRequestLoggingFilter filter = new CustomizedRequestLoggingFilter(); filter.setIncludeClientInfo(true); filter.setIncludeQueryString(true); filter.setIncludePayload(true); filter.setMaxPayloadLength(2048); filter.setIncludeHeaders(false); filter.setAfterMessagePrefix(\"REQUEST DATA : \"); return filter; &#125; &#125; ä½†æ˜¯åŽŸç”Ÿçš„AbstractRequestLoggingFilteræä¾›çš„Messageæ ¼å¼å·²ç»å›ºå®šï¼Œå¹¶ä¸èƒ½æ ¹æ®è‡ªå·±çš„å–œå¥½æ¥ã€‚ è€Œä¸”æ¢è¡Œç¬¦æ²¡è¢«è½¬ä¹‰ï¼Œè™½ç„¶ä¾¿äºŽè°ƒè¯•è§‚å¯Ÿä½†å¹¶ä¸åˆ©äºŽELKè¿™æ ·çš„æ—¥å¿—ä½“ç³»è®°å½•æ—¥å¿—ã€‚ è¦è§£å†³è¿™ä¸ªé—®é¢˜å°±éœ€è¦è‡ªå·±è¯»å–requestå¹¶è®°å½•ï¼Œå°±å¿…é¡»è§£å†³ä¸Šæ–‡æåˆ°çš„request.getInputStream() streamè¯»å–é—®é¢˜ã€‚ è§£å†³åŠžæ³•ç½‘ä¸Šä¹Ÿæœ‰ï¼Œå°±æ˜¯é€šè¿‡æ‹·è´ä¸€ä»½streamï¼Œå°†æ‹·è´çš„streamç»§ç»­æ‰”å›žFilterChainã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ @Bean public FilterRegistrationBean&lt;LogClientFilter> logClientFilter() &#123; //è‡ªå®šä¹‰çš„ request log filter FilterRegistrationBean&lt;LogClientFilter> bean = new FilterRegistrationBean&lt;LogClientFilter>(); bean.setFilter(new LogClientFilter()); bean.addUrlPatterns(\"/*\"); bean.setOrder(3); return bean; &#125; å…³é”®çš„MultiReadå¯¹è±¡ public class MultiReadHttpServletRequest extends HttpServletRequestWrapper &#123; private ByteArrayOutputStream cachedBytes; /** * Construct a new multi-read wrapper. * * @param request to wrap around */ public MultiReadHttpServletRequest(HttpServletRequest request) &#123; super(request); &#125; @Override public ServletInputStream getInputStream() throws IOException &#123; if (cachedBytes == null) cacheInputStream(); return new CachedServletInputStream(cachedBytes.toByteArray()); &#125; @Override public BufferedReader getReader() throws IOException &#123; return new BufferedReader(new InputStreamReader(getInputStream())); &#125; private void cacheInputStream() throws IOException &#123; /* Cache the inputstream in order to read it multiple times. For * convenience, I use apache.commons IOUtils */ cachedBytes = new ByteArrayOutputStream(); IOUtils.copy(super.getInputStream(), cachedBytes); &#125; /* An inputstream which reads the cached request body */ private static class CachedServletInputStream extends ServletInputStream &#123; private final ByteArrayInputStream buffer; public CachedServletInputStream(byte[] contents) &#123; this.buffer = new ByteArrayInputStream(contents); &#125; @Override public int read() throws IOException &#123; return buffer.read(); &#125; @Override public boolean isFinished() &#123; return buffer.available() == 0; &#125; @Override public boolean isReady() &#123; return true; &#125; @Override public void setReadListener(ReadListener listener) &#123; throw new RuntimeException(\"Not implemented\"); &#125; &#125; &#125; æ—¥å¿—è®°å½•Filiter public class LogClientFilter implements Filter &#123; public void init(FilterConfig config) throws ServletException &#123; log.info(\"log client...\"); &#125; public void destroy() &#123; &#125; @Override public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws ServletException, IOException &#123; ObjectMapper mapper = new ObjectMapper(); ObjectNode rootNode = mapper.createObjectNode(); HttpServletRequest httpServletRequest = (HttpServletRequest) request; MultiReadHttpServletRequest wrappedRequest = new MultiReadHttpServletRequest(httpServletRequest); request.getInputStream(); rootNode.put(\"uri\", httpServletRequest.getRequestURI()); rootNode.put(\"clientIp\", httpServletRequest.getRemoteAddr()); String method = httpServletRequest.getMethod(); rootNode.put(\"method\", method); String content = IOUtils.toString(wrappedRequest.getInputStream()); if (method.equals(\"GET\") || method.equals(\"DELETE\")) &#123; rootNode.put(\"request\", httpServletRequest.getQueryString()); &#125; else &#123; rootNode.put(\"request\",content); &#125; log.info(rootNode.toString()); chain.doFilter(request, response); &#125; &#125; å‚è€ƒ https://www.jvt.me/posts/2020/05/25/read-servlet-request-body-multiple/ å¤šæ¬¡è¯»å–servletè¯·æ±‚ä½“ https://www.javadevjournal.com/spring/log-incoming-requests-spring/ è®°å½•springçš„è¯·æ±‚ https://levelup.gitconnected.com/how-to-log-the-request-body-in-a-spring-boot-application-10083b70c66 https://stackoverflow.com/questions/54035778/commonsrequestloggingfilter-not-working-in-spring-boot-application/54545890#","categories":[],"tags":[{"name":"java","slug":"java","permalink":"http://visonforcoding.xyz/tags/java/"}]},{"title":"servlet | servletå­¦ä¹ ç¬”è®°","slug":"java/servletå­¦ä¹ ç¬”è®°","date":"2021-11-28T04:10:18.000Z","updated":"2021-12-01T01:34:54.932Z","comments":true,"path":"2021/11/28/java/servletå­¦ä¹ ç¬”è®°/","link":"","permalink":"http://visonforcoding.xyz/2021/11/28/java/servlet%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/","excerpt":"å®šä¹‰ ç®€å•è€Œè¨€ï¼ŒServletæ˜¯ä¸€ä¸ªAPIï¼Œæœ¬è´¨ä¸Šçš„å®žçŽ°æ˜¯ç”±æ‰¿è½½çš„Servletå®¹å™¨åŽ»å¤„ç†ã€‚é€šè¿‡Javaå¤šçº¿ç¨‹å¤„ç†å¹¶å“åº”å®¢æˆ·ç«¯çš„Http Requestã€‚","text":"å®šä¹‰ ç®€å•è€Œè¨€ï¼ŒServletæ˜¯ä¸€ä¸ªAPIï¼Œæœ¬è´¨ä¸Šçš„å®žçŽ°æ˜¯ç”±æ‰¿è½½çš„Servletå®¹å™¨åŽ»å¤„ç†ã€‚é€šè¿‡Javaå¤šçº¿ç¨‹å¤„ç†å¹¶å“åº”å®¢æˆ·ç«¯çš„Http Requestã€‚ åŽ†å² æˆªæ­¢ç›®å‰ï¼Œæœ€æ–°ç‰ˆæœ¬è§„èŒƒä¸º6.0ã€‚ è¿‡æ»¤å™¨ Filteråœ¨HTTPè¯·æ±‚åˆ°è¾¾Servletä¹‹å‰ï¼Œå¯ä»¥è¢«ä¸€ä¸ªæˆ–å¤šä¸ªFilteré¢„å¤„ç†ï¼Œç±»ä¼¼æ‰“å°æ—¥å¿—ã€ç™»å½•æ£€æŸ¥ç­‰é€»è¾‘ï¼Œå®Œå…¨å¯ä»¥æ”¾åˆ°Filterä¸­ã€‚ Filterä¸å…‰èƒ½æ‹¦æˆªè¯·æ±‚ï¼Œå¯¹è¯·æ±‚è¿›è¡Œé¢„å¤„ç†ï¼Œè¿˜èƒ½å¤Ÿä¿®æ”¹è¿”å›žã€‚ äº‹ä»¶ç›‘å¬å™¨ ListenerServlet ä¾¦å¬å™¨ç”¨äºŽä¾¦å¬ Web å®¹å™¨ä¸­çš„äº‹ä»¶ï¼Œä¾‹å¦‚ï¼Œå½“æ‚¨åˆ›å»ºä¼šè¯æ—¶ï¼Œæˆ–åœ¨ä¼šè¯ä¸­æ”¾ç½®å±žæ€§æ—¶ï¼Œæˆ–è€…å¦‚æžœæ‚¨åœ¨å¦ä¸€ä¸ªå®¹å™¨ä¸­è¢«åŠ¨åŒ–å¹¶æ¿€æ´»æ—¶ï¼Œè¦è®¢é˜…è¿™äº›äº‹ä»¶ï¼Œ äº‹ä»¶ç±»åž‹ javax.servlet.AsyncEvent â€“ åœ¨ ServletRequest ä¸Šå¯åŠ¨çš„å¼‚æ­¥æ“ä½œï¼ˆé€šè¿‡è°ƒç”¨ ServletRequest#startAsync æˆ–ServletRequest#startAsyncï¼ˆServletRequestï¼Œ ServletResponseï¼‰ï¼‰å®Œæˆã€è¶…æ—¶æˆ–äº§ç”Ÿé”™è¯¯æ—¶è§¦å‘çš„äº‹ä»¶ã€‚ javax.servlet.http.HttpSessionBindingEvent â€“ å½“ä¼šè¯ç»‘å®šæˆ–å–æ¶ˆç»‘å®š HttpSessionListener æ—¶ï¼Œè¿™ç§ç±»åž‹çš„äº‹ä»¶è¦ä¹ˆå‘é€åˆ°å®žçŽ° HttpSessionBindingListener çš„å¯¹è±¡ï¼Œè¦ä¹ˆå‘é€åˆ°åœ¨ Web ä¸­é…ç½®çš„ HttpSessionAttributeListenerå½“ä»»ä½•å±žæ€§åœ¨ä¼šè¯ä¸­è¢«ç»‘å®šã€å–æ¶ˆç»‘å®šæˆ–æ›¿æ¢æ—¶ã€‚ä¼šè¯é€šè¿‡è°ƒç”¨ HttpSession.setAttribute ç»‘å®šå¯¹è±¡ï¼Œå¹¶é€šè¿‡è°ƒç”¨ HttpSession.removeAttribute è§£é™¤ç»‘å®šå¯¹è±¡ã€‚å½“å¯¹è±¡ä»Žä¼šè¯ä¸­åˆ é™¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ­¤äº‹ä»¶ç”¨äºŽæ¸…ç†æ´»åŠ¨ã€‚ javax.servlet.http.HttpSessionEvent â€“ è¿™æ˜¯ä¸€ä¸ªç±»ï¼Œè¡¨ç¤º Web åº”ç”¨ç¨‹åºä¸­ä¼šè¯æ›´æ”¹çš„äº‹ä»¶é€šçŸ¥ã€‚ javax.servlet.ServletContextAttributeEvent â€“ äº‹ä»¶ç±»ï¼Œç”¨äºŽé€šçŸ¥æœ‰å…³ Web åº”ç”¨ç¨‹åº ServletContext å±žæ€§çš„æ›´æ”¹ã€‚ javax.servlet.ServletContextEventâ€“ è¿™æ˜¯æœ‰å…³ Web åº”ç”¨ç¨‹åº servlet ä¸Šä¸‹æ–‡æ›´æ”¹çš„é€šçŸ¥çš„äº‹ä»¶ç±»ã€‚ javax.servlet.ServletRequestEvent â€“ æ­¤ç±»äº‹ä»¶è¡¨ç¤º ServletRequest çš„ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ã€‚è¯¥äº‹ä»¶çš„æºæ˜¯æ­¤ Web åº”ç”¨ç¨‹åºçš„ ServletContextã€‚ javax.servlet.ServletRequestAttributeEventâ€“ è¿™æ˜¯ä¸€ä¸ªäº‹ä»¶ç±»ï¼Œç”¨äºŽé€šçŸ¥åº”ç”¨ç¨‹åºä¸­ servlet è¯·æ±‚çš„å±žæ€§çš„æ›´æ”¹ã€‚ æ³¨è§£åœ¨2005å¹´çš„servlet 2.5ä¸­å¼•å…¥äº†æ³¨è§£èƒ½åŠ›ï¼Œå¯ä»¥ä¸å†é…ç½®å¤ªå¤šxmlã€‚ @WebServlet å£°æ˜Žjavaç±»ä¸ºservlet @WebInitParam ä½œä¸ºWebServletå‚æ•°æ³¨è§£ã€‚åˆå§‹åŒ–serverlå‚æ•°ã€‚ @WebServlet( name = \"BankAccountServlet\", description = \"Represents a Bank Account and it's transactions\", urlPatterns = &#123;\"/account\", \"/bankAccount\" &#125;, initParams = &#123; @WebInitParam(name = \"type\", value = \"savings\")&#125;) public class AccountServlet extends javax.servlet.http.HttpServlet &#123; String accountType = null; public void init(ServletConfig config) throws ServletException &#123; accountType = config.getInitParameter(\"type\"); &#125; public void doPost(HttpServletRequest request, HttpServletResponse response) throws IOException &#123; // ... &#125; &#125; @WebFilter å£°æ˜Žè¿‡æ»¤å™¨ï¼Œå¦‚æžœè¦å¯¹è¯·æ±‚è¿›è¡Œæ‹¦æˆªã€ä¿®æ”¹è€Œä¸å½±å“é€»è¾‘ä»£ç ã€‚ @WebFilter( urlPatterns = \"/account/*\", filterName = \"LoggingFilter\", description = \"Filter all account transaction URLs\") public class LogInFilter implements javax.servlet.Filter &#123; public void init(FilterConfig filterConfig) throws ServletException &#123; &#125; public void doFilter( ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException &#123; HttpServletRequest req = (HttpServletRequest) request; HttpServletResponse res = (HttpServletResponse) response; res.sendRedirect(req.getContextPath() + \"/login.jsp\"); chain.doFilter(request, response); &#125; public void destroy() &#123; &#125; &#125; @WebListener å£°æ˜Žäº‹ä»¶ç›‘å¬å™¨ã€‚ @WebListener public class BankAppServletContextListener implements ServletContextListener &#123; public void contextInitialized(ServletContextEvent sce) &#123; sce.getServletContext().setAttribute(\"ATTR_DEFAULT_LANGUAGE\", \"english\"); &#125; public void contextDestroyed(ServletContextEvent sce) &#123; // ... &#125; &#125; @ServletSecurityã€@HttpConstraintã€@HttpMethodConstraint ç±»ä¼¼nginxè®¤è¯åŠŸèƒ½ @MultipartConfig å¤„ç†æ–‡ä»¶ä¸Šä¼ é…ç½® @WebServlet(urlPatterns = &#123; \"/uploadCustDocs\" &#125;) @MultipartConfig( fileSizeThreshold = 1024 * 1024 * 20, maxFileSize = 1024 * 1024 * 20, maxRequestSize = 1024 * 1024 * 25, location = \"./custDocs\") public class UploadCustomerDocumentsServlet extends HttpServlet &#123; protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123; for (Part part : request.getParts()) &#123; part.write(\"myFile\"); &#125; &#125; &#125; Api â€ŽJava servlet API ç”±ä¸¤ä¸ªåŒ…ç»„æˆã€‚ä¸€ä¸ªæ˜¯javax.servletï¼Œå¦ä¸€ä¸ªæ˜¯javax.servlet.httpã€‚javax.servlet åŒ…åŒ…å«å¯ç”¨äºŽç¼–å†™ç‹¬ç«‹äºŽåè®®çš„ servlet çš„æ‰€æœ‰ç±»å’ŒæŽ¥å£ï¼Œjavax.servlet.http åŒ…å«ç¼–å†™ HTTP ç‰¹å®š servlet æ‰€éœ€çš„æ‰€æœ‰ç±»å’ŒæŽ¥å£ã€‚è®©æˆ‘ä»¬è¯¦ç»†æŽ¢è®¨ä¸€ä¸‹ Java Servlet APIã€‚â€Ž å‚è€ƒé˜…è¯» https://o7planning.org/10395/java-servlet-filter https://www.codejava.net/java-ee/servlet/how-to-modify-http-response-using-java-filter å¦‚ä½•ä½¿ç”¨filterä¿®æ”¹response https://en.wikipedia.org/wiki/Jakarta_Servlet ç»´åŸºservlet Java-web-æ³¨è§£ www.baeldung.com Java-servlets","categories":[],"tags":[{"name":"java","slug":"java","permalink":"http://visonforcoding.xyz/tags/java/"}]},{"title":"HTTPæœ¬è´¨","slug":"java/æ˜¥å¤©ä¹‹å‰-http","date":"2021-10-30T02:59:33.278Z","updated":"2021-10-30T02:59:33.278Z","comments":true,"path":"2021/10/30/java/æ˜¥å¤©ä¹‹å‰-http/","link":"","permalink":"http://visonforcoding.xyz/2021/10/30/java/%E6%98%A5%E5%A4%A9%E4%B9%8B%E5%89%8D-http/","excerpt":"è¯•å›¾è·³è¿‡spring,è€Œå­¦ä¹ spring bootæ˜¯ä¸å¯èƒ½çš„ã€‚å­¦ä¹ java webå¼€å‘ï¼Œä»ŽåŸºç¡€å¼€å§‹å­¦ä¹ ã€‚å°±åº”å½“äº†è§£httpã€servletã€tomcat","text":"è¯•å›¾è·³è¿‡spring,è€Œå­¦ä¹ spring bootæ˜¯ä¸å¯èƒ½çš„ã€‚å­¦ä¹ java webå¼€å‘ï¼Œä»ŽåŸºç¡€å¼€å§‹å­¦ä¹ ã€‚å°±åº”å½“äº†è§£httpã€servletã€tomcat èµ·æº å®ƒè§£å†³ä»€ä¹ˆé—®é¢˜ å®žçŽ°åŽŸç† èµ·æº1980å¹´6æœˆè‡³12æœˆé—´ï¼Œä¼¯çº³æ–¯-æŽåœ¨çš„CERNï¼ˆæ¬§æ´²æ ¸å­ç ”ç©¶ç»„ç»‡ï¼‰æ‹…ä»»å·¥ä½œã€‚å®žéªŒå®¤çš„ç ”ç©¶äººå‘˜éœ€è¦å¤§é‡çš„ä¿¡æ¯æŸ¥é˜…æˆ–æ²Ÿé€šã€‚åœ¨é‚£æ®µæ—¶é—´é‡Œï¼Œä»–æå‡ºäº†ä¸ªæž„æƒ³ï¼šåˆ›å»ºä¸€ä¸ªä»¥è¶…æ–‡æœ¬ç³»ç»Ÿä¸ºåŸºç¡€çš„é¡¹ç›®ï¼Œæ–¹ä¾¿ç ”ç©¶äººå‘˜åˆ†äº«åŠæ›´æ–°è®¯æ¯ã€‚ 1989å¹´3æœˆï¼Œä»–å†™ä¸‹äº†ä»–çš„åˆæ­¥æž„æƒ³ï¼Œå¹¶åœ¨1990å¹´é‡æ–°é…ç½®ã€‚ç„¶åŽè¢«ä»–çš„ç»ç†éº¦å…‹Â·æ£®å¾·å°”ï¼ˆMike Sendallï¼‰æ‰€æŽ¥å—ã€‚ä»–ä½¿ç”¨ä¸ŽENQUIREç³»ç»Ÿç›¸ä¼¼çš„æ¦‚å¿µæ¥åˆ›å»ºä¸‡ç»´ç½‘ï¼Œä¸ºæ­¤ä»–è®¾è®¡å¹¶æž„å»ºäº†ç¬¬ä¸€ä¸ªç½‘é¡µæµè§ˆå™¨ã€‚ ä¸–ç•Œä¸Šç¬¬ä¸€ä¸ªç½‘ç«™åœ¨CERNæ­å»ºï¼Œè€ŒCERNåˆ™ä½äºŽæ³•å›½è¾¹å¢ƒã€‚ç½‘ç«™åœ¨1991å¹´8æœˆ6æ—¥ä¸Šçº¿ã€‚ ä¸Šçº¿ çš„ç¬¬ä¸€ä¸ªç½‘å€ï¼Œhttp://info.cern.ch/hypertext/WWW/TheProject.html å‘Šè¯‰äººä»¬ä¸‡ç»´ç½‘æ˜¯ä»€ä¹ˆï¼Œç”¨æˆ·å¦‚ä½•ä½¿ç”¨æµè§ˆå™¨ï¼Œå¦‚ä½•åˆ›å»ºç½‘é¡µæœåŠ¡å™¨ã€‚ ç›®çš„è®¾è®¡HTTPæœ€åˆçš„ç›®çš„æ˜¯ä¸ºäº†æä¾›ä¸€ç§å‘å¸ƒå’ŒæŽ¥æ”¶HTMLé¡µé¢çš„æ–¹æ³•ã€‚ å®žçŽ°ä¸€ä¸ªè¿žæŽ¥æ˜¯ç”±ä¼ è¾“å±‚æ¥æŽ§åˆ¶çš„ï¼Œè¿™ä»Žæ ¹æœ¬ä¸Šä¸å±žäºŽHTTPçš„èŒƒå›´ã€‚HTTPå¹¶ä¸éœ€è¦å…¶åº•å±‚çš„ä¼ è¾“å±‚åè®®æ˜¯é¢å‘è¿žæŽ¥çš„ï¼Œåªéœ€è¦å®ƒæ˜¯å¯é çš„ï¼Œæˆ–ä¸ä¸¢å¤±æ¶ˆæ¯çš„ï¼ˆè‡³å°‘è¿”å›žé”™è¯¯ï¼‰ã€‚åœ¨äº’è”ç½‘ä¸­ï¼Œæœ‰ä¸¤ä¸ªæœ€å¸¸ç”¨çš„ä¼ è¾“å±‚åè®®ï¼šTCPæ˜¯å¯é çš„ï¼Œè€ŒUDPä¸æ˜¯ã€‚å› æ­¤ï¼ŒHTTPä¾èµ–äºŽé¢å‘è¿žæŽ¥çš„TCPè¿›è¡Œæ¶ˆæ¯ä¼ é€’ï¼Œä½†è¿žæŽ¥å¹¶ä¸æ˜¯å¿…é¡»çš„ã€‚å› æ­¤é€šè¿‡socketç¼–ç¨‹å°±èƒ½å®žçŽ°httpåè®®ã€‚ public class Server &#123; private static int port = 8081; public static void main(String[] args) throws IOException &#123; ServerSocket ss = new ServerSocket(port); // ç›‘å¬æŒ‡å®šç«¯å£ System.out.println(\"server is running...\"); for (;;) &#123; Socket sock = ss.accept(); System.out.println(\"connected from \" + sock.getRemoteSocketAddress()); Thread t = new Handler(sock); t.start(); &#125; &#125; &#125; public class Handler extends Thread &#123; Socket sock; public Handler(Socket sock) &#123; this.sock = sock; &#125; public void run() &#123; try ( InputStream input = this.sock.getInputStream()) &#123; try ( OutputStream output = this.sock.getOutputStream()) &#123; handle(input, output); &#125; &#125; catch (Exception e) &#123; try &#123; this.sock.close(); &#125; catch (IOException ioe) &#123; &#125; System.out.println(\"client disconnected.\"); &#125; &#125; private void handle(InputStream input, OutputStream output) throws IOException &#123; System.out.println(\"Process new http request...\"); var reader = new BufferedReader(new InputStreamReader(input, StandardCharsets.UTF_8)); var writer = new BufferedWriter(new OutputStreamWriter(output, StandardCharsets.UTF_8)); // è¯»å–HTTPè¯·æ±‚: boolean requestOk = false; String first = reader.readLine(); if (first.startsWith(\"GET / HTTP/1.\")) &#123; requestOk = true; &#125; for (;;) &#123; String header = reader.readLine(); if (header.isEmpty()) &#123; // è¯»å–åˆ°ç©ºè¡Œæ—¶, HTTP Headerè¯»å–å®Œæ¯• break; &#125; System.out.println(header); &#125; System.out.println(requestOk ? \"Response OK\" : \"Response Error\"); if (!requestOk) &#123; // å‘é€é”™è¯¯å“åº”: writer.write(\"HTTP/1.0 404 Not Found\\r\\n\"); writer.write(\"Content-Length: 0\\r\\n\"); writer.write(\"\\r\\n\"); writer.flush(); &#125; else &#123; // å‘é€æˆåŠŸå“åº”: String data = \"&lt;html>&lt;body>&lt;h1>Hello, world!&lt;/h1>&lt;/body>&lt;/html>\"; int length = data.getBytes(StandardCharsets.UTF_8).length; writer.write(\"HTTP/1.0 200 OK\\r\\n\"); writer.write(\"Connection: close\\r\\n\"); writer.write(\"Content-Type: text/html\\r\\n\"); writer.write(\"Content-Length: \" + length + \"\\r\\n\"); writer.write(\"\\r\\n\"); // ç©ºè¡Œæ ‡è¯†Headerå’ŒBodyçš„åˆ†éš” writer.write(data); writer.flush(); &#125; // TODO: å¤„ç†HTTPè¯·æ±‚ &#125; &#125; å‚è€ƒ https://developer.mozilla.org/zh-CN/docs/Web/HTTP å»–é›ªå³°-webåŸºç¡€","categories":[],"tags":[{"name":"java","slug":"java","permalink":"http://visonforcoding.xyz/tags/java/"}]},{"title":"log4jä½¿ç”¨æŒ‡å—","slug":"java/log4jä½¿ç”¨æŒ‡å—","date":"2021-10-30T02:59:33.276Z","updated":"2021-10-30T02:59:33.277Z","comments":true,"path":"2021/10/30/java/log4jä½¿ç”¨æŒ‡å—/","link":"","permalink":"http://visonforcoding.xyz/2021/10/30/java/log4j%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/","excerpt":"å¯¹äºŽåˆšå¼€å§‹æŽ¥è§¦javaçš„äººæ¥è¯´ï¼Œç”¨ä»€ä¹ˆæ¥æ‰“æ—¥å¿—ä¼¼ä¹Žå¿«è¢«javaçš„è¿™ä¹ˆå¤šæ¦‚å¿µæžæ‡µäº†ã€‚log4jã€log4j2ã€slf4jã€logback?!!","text":"å¯¹äºŽåˆšå¼€å§‹æŽ¥è§¦javaçš„äººæ¥è¯´ï¼Œç”¨ä»€ä¹ˆæ¥æ‰“æ—¥å¿—ä¼¼ä¹Žå¿«è¢«javaçš„è¿™ä¹ˆå¤šæ¦‚å¿µæžæ‡µäº†ã€‚log4jã€log4j2ã€slf4jã€logback?!! ç›˜ç‚¹ç›˜ç‚¹ä¸‹æˆ‘ä»¬é‡åˆ°è¿‡å“ªäº›æ—¥å¿— java.util.logging org.apache.commons.logging.Log Log4jå’ŒLog4j2 SLF4J å’Œ Logback ç®€å•æ¦‚æ‹¬ Log4jå’ŒLog4j2æ˜¯commons.logging log4jApache Log4j æ˜¯ä¸€ä¸ªéžå¸¸å¤è€çš„æ—¥å¿—æ¡†æž¶ï¼Œå¹¶ä¸”æ˜¯å¤šå¹´æ¥æœ€å—æ¬¢è¿Žçš„æ—¥å¿—æ¡†æž¶ã€‚ å®ƒå¼•å…¥äº†çŽ°ä»£æ—¥å¿—æ¡†æž¶ä»åœ¨ä½¿ç”¨çš„åŸºæœ¬æ¦‚å¿µï¼Œå¦‚åˆ†å±‚æ—¥å¿—çº§åˆ«å’Œè®°å½•å™¨ã€‚ 2015 å¹´ 8 æœˆ 5 æ—¥ï¼Œè¯¥é¡¹ç›®ç®¡ç†å§”å‘˜ä¼šå®£å¸ƒ Log4j 1.x å·²è¾¾åˆ°ä½¿ç”¨å¯¿å‘½ã€‚ å»ºè®®ç”¨æˆ·ä½¿ç”¨ Log4j 1 å‡çº§åˆ° ApacheLog4j 2ã€‚ log4j2Apache Log4j 2æ˜¯å¯¹ Log4j çš„å‡çº§ï¼Œå®ƒæ¯”å…¶å‰èº« Log4j 1.x æä¾›äº†é‡å¤§æ”¹è¿›ï¼Œå¹¶æä¾›äº† Logback ä¸­å¯ç”¨çš„è®¸å¤šæ”¹è¿›ï¼ŒåŒæ—¶ä¿®å¤äº† Logback æž¶æž„ä¸­çš„ä¸€äº›å›ºæœ‰é—®é¢˜ã€‚ ä¸Ž Logback ä¸€æ ·ï¼ŒLog4j2 æä¾›å¯¹ SLF4J çš„æ”¯æŒï¼Œè‡ªåŠ¨é‡æ–°åŠ è½½æ—¥å¿—é…ç½®ï¼Œå¹¶æ”¯æŒé«˜çº§è¿‡æ»¤é€‰é¡¹ã€‚ é™¤äº†è¿™äº›åŠŸèƒ½å¤–ï¼Œå®ƒè¿˜å…è®¸åŸºäºŽ lambda è¡¨è¾¾å¼å¯¹æ—¥å¿—è¯­å¥è¿›è¡Œå»¶è¿Ÿè¯„ä¼°ï¼Œä¸ºä½Žå»¶è¿Ÿç³»ç»Ÿæä¾›å¼‚æ­¥è®°å½•å™¨ï¼Œå¹¶æä¾›æ— åžƒåœ¾æ¨¡å¼ä»¥é¿å…ç”±åžƒåœ¾æ”¶é›†å™¨æ“ä½œå¼•èµ·çš„ä»»ä½•å»¶è¿Ÿã€‚ æ‰€æœ‰è¿™äº›åŠŸèƒ½ä½¿ Log4j2 æˆä¸ºè¿™ä¸‰ä¸ªæ—¥å¿—æ¡†æž¶ä¸­æœ€å…ˆè¿›å’Œæœ€å¿«çš„ã€‚ Logbacklogback æ˜¯ç”± log4j åˆ›å§‹äººè®¾è®¡çš„åˆä¸€ä¸ªå¼€æºæ—¥å¿—ç»„ä»¶ï¼Œä½œä¸ºæµè¡Œçš„ log4j é¡¹ç›®çš„åŽç»­ç‰ˆæœ¬ï¼Œä»Žè€Œæ›¿ä»£ log4jã€‚ Logback çš„ä½“ç³»ç»“æž„è¶³å¤Ÿé€šç”¨ï¼Œä»¥ä¾¿åœ¨ä¸åŒæƒ…å†µä¸‹åº”ç”¨ã€‚ ç›®å‰ï¼Œlogback åˆ†ä¸ºä¸‰ä¸ªæ¨¡å—ï¼šlogback-coreï¼Œlogback-classicå’Œlogback-accessã€‚ logback-coreï¼šæ¨¡å—ä¸ºå…¶ä»–ä¸¤ä¸ªæ¨¡å—çš„åŸºç¡€ã€‚logback-classicï¼šæ¨¡å—å¯ä»¥è¢«çœ‹åšæ˜¯log4jçš„æ”¹è¿›ç‰ˆæœ¬ã€‚æ­¤å¤–ï¼Œlogback-classic æœ¬èº«å®žçŽ°äº† SLF4J APIï¼Œå› æ­¤å¯ä»¥åœ¨ logback å’Œå…¶ä»–æ—¥å¿—æ¡†æž¶ï¼ˆå¦‚ log4j æˆ– java.util.loggingï¼ˆJULï¼‰ï¼‰ä¹‹é—´æ¥å›žåˆ‡æ¢ã€‚logback-accessï¼šæ¨¡å—ä¸Ž Servlet å®¹å™¨ï¼ˆå¦‚ Tomcat å’Œ Jettyï¼‰é›†æˆï¼Œä»¥æä¾› HTTP è®¿é—®æ—¥å¿—åŠŸèƒ½ã€‚","categories":[],"tags":[{"name":"java","slug":"java","permalink":"http://visonforcoding.xyz/tags/java/"}]},{"title":"PHPStormä½¿ç”¨é…ç½®","slug":"PHPStormä½¿ç”¨é…ç½®","date":"2021-09-24T09:34:26.000Z","updated":"2021-12-10T02:28:23.802Z","comments":true,"path":"2021/09/24/PHPStormä½¿ç”¨é…ç½®/","link":"","permalink":"http://visonforcoding.xyz/2021/09/24/PHPStorm%E4%BD%BF%E7%94%A8%E9%85%8D%E7%BD%AE/","excerpt":"æœ€è¿‘åˆå¼€å§‹ä½¿ç”¨PHPStormäº†ï¼Œä¸ºä»€ä¹ˆæ˜¯â€åˆâ€ï¼Ÿå› ä¸ºæ–­æ–­ç»­ç»­ä½¿ç”¨è¿‡å‡ æ¬¡ï¼Œéƒ½ä¸­æ–­è¿‡ã€‚è¦ç ´è§£æ„Ÿè§‰è¿˜æ˜¯éº»çƒ¦ï¼Œä¸€ç›´ä½¿ç”¨netbeansä¹Ÿæ„Ÿè§‰æ²¡ä»€ä¹ˆé—®é¢˜ã€‚ ç”±äºŽæœ€è¿‘åœ¨è€ƒè™‘doctrine\\annotation,netbeansçš„æ”¯æŒèƒ½åŠ›è¿˜æ˜¯ä¸è¶³ï¼Œæ‰€ä»¥åˆå¼€å§‹ä½“éªŒphpstormã€‚å‡ ä¸ªåœ¨netbeansé‡Œå–œæ¬¢çš„åŠŸèƒ½ï¼Œåƒæ–¹ç™¾è®¡å¼€å§‹åœ¨phpstormæ‰¾å›žæ¥,ä»¥ä¸‹æ˜¯è®°å½•ã€‚","text":"æœ€è¿‘åˆå¼€å§‹ä½¿ç”¨PHPStormäº†ï¼Œä¸ºä»€ä¹ˆæ˜¯â€åˆâ€ï¼Ÿå› ä¸ºæ–­æ–­ç»­ç»­ä½¿ç”¨è¿‡å‡ æ¬¡ï¼Œéƒ½ä¸­æ–­è¿‡ã€‚è¦ç ´è§£æ„Ÿè§‰è¿˜æ˜¯éº»çƒ¦ï¼Œä¸€ç›´ä½¿ç”¨netbeansä¹Ÿæ„Ÿè§‰æ²¡ä»€ä¹ˆé—®é¢˜ã€‚ ç”±äºŽæœ€è¿‘åœ¨è€ƒè™‘doctrine\\annotation,netbeansçš„æ”¯æŒèƒ½åŠ›è¿˜æ˜¯ä¸è¶³ï¼Œæ‰€ä»¥åˆå¼€å§‹ä½“éªŒphpstormã€‚å‡ ä¸ªåœ¨netbeansé‡Œå–œæ¬¢çš„åŠŸèƒ½ï¼Œåƒæ–¹ç™¾è®¡å¼€å§‹åœ¨phpstormæ‰¾å›žæ¥,ä»¥ä¸‹æ˜¯è®°å½•ã€‚ é¡¹ç›®åæ˜¾ç¤ºgitåˆ†æ”¯ å¦‚å›¾ï¼Œç”±äºŽç»å¸¸åˆ‡æ¢åˆ†æ”¯ã€‚æœ‰æ—¶å€™å¯èƒ½ä¼šåœ¨é”™è¯¯çš„åˆ†æ”¯ä¸Šè¿›è¡Œå¼€å‘ï¼Œé¡¹ç›®ååŽé¢æ ‡ä¸Šåˆ†æ”¯åè¿™ä¸ªåŠŸèƒ½æˆ‘å¾ˆå–œæ¬¢ã€‚ å‘çŽ°phpstormä½¿ç”¨GitToolBoxå¯ä»¥è§£å†³ã€‚ å…³é—­æ˜¾ç¤ºé¡¹ç›®è·¯å¾„ä½†æ˜¯è¿˜æœ‰ä¸ªé—®é¢˜æ˜¯ï¼Œé¡¹ç›®åä¼šæ˜¾ç¤ºé¡¹ç›®åœ°å€ï¼Œè¿™ç‚¹å¾ˆçƒ¦ã€‚å¯ä»¥é€šè¿‡è‡ªå®šä¹‰phpstormå±žæ€§åŠžåˆ°ã€‚ æ‰“å¼€ Help/Edit Custom Propertiesâ€¦ æ–°å»º idea.properties file project.tree.structure.show.url=false ide.tree.horizontal.default.autoscrolling=false éšè—nbprojectnbprojectæ˜¯netbeansçš„é…ç½®æ–‡ä»¶å¤¹,åœ¨phpstormé¡¹ç›®ä¸­æ˜¾ç¤ºéžå¸¸éš¾å—ã€‚ Preferences-&gt;File Types -&gt; Files and Folders to Ignore.","categories":[],"tags":[{"name":"è½¯ä»¶","slug":"è½¯ä»¶","permalink":"http://visonforcoding.xyz/tags/%E8%BD%AF%E4%BB%B6/"}]},{"title":"å†™å¥½ä»£ç çš„ä¸ƒç§æ­¦å™¨ä¹‹ä¾èµ–æ³¨å…¥","slug":"å†™å¥½ä»£ç çš„ä¸ƒç§æ­¦å™¨ä¹‹ä¾èµ–æ³¨å…¥","date":"2021-09-09T03:05:04.000Z","updated":"2021-10-30T02:59:33.282Z","comments":true,"path":"2021/09/09/å†™å¥½ä»£ç çš„ä¸ƒç§æ­¦å™¨ä¹‹ä¾èµ–æ³¨å…¥/","link":"","permalink":"http://visonforcoding.xyz/2021/09/09/%E5%86%99%E5%A5%BD%E4%BB%A3%E7%A0%81%E7%9A%84%E4%B8%83%E7%A7%8D%E6%AD%A6%E5%99%A8%E4%B9%8B%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/","excerpt":"åœ¨ä¹‹å‰çš„æ–‡ç« ä¸­æœ‰è¯´åˆ°ï¼Œå†™å¥½ä»£ç çš„åŽŸåˆ™ã€‚å…¶ä¸­æåˆ°äº†SOLID é‚£ä¹ˆä»€ä¹ˆæ˜¯SOLID","text":"åœ¨ä¹‹å‰çš„æ–‡ç« ä¸­æœ‰è¯´åˆ°ï¼Œå†™å¥½ä»£ç çš„åŽŸåˆ™ã€‚å…¶ä¸­æåˆ°äº†SOLID é‚£ä¹ˆä»€ä¹ˆæ˜¯SOLID èƒŒæ™¯SOLID åŽŸåˆ™é¦–å…ˆç”±è‘—åçš„è®¡ç®—æœºç§‘å­¦å®¶ Robert CÂ·Martin ï¼ˆè‘—åçš„Bobå¤§å”ï¼‰ç”± 2000 å¹´åœ¨ä»–çš„è®ºæ–‡ä¸­æå‡ºã€‚ä½†æ˜¯ SOLID ç¼©ç•¥è¯æ˜¯ç¨æ™šç”± Michael Feathers å…ˆä½¿ç”¨çš„ã€‚ Bobå¤§å”ä¹Ÿæ˜¯ç•…é”€ä¹¦ã€Šä»£ç æ•´æ´ä¹‹é“ã€‹å’Œã€Šæž¶æž„æ•´æ´ä¹‹é“ã€‹çš„ä½œè€…ï¼Œä¹Ÿæ˜¯ â€œAgile Allianceâ€ çš„æˆå‘˜ã€‚ ä»–ä»¬è¾¾æˆçš„ç›®æ ‡æ˜¯ä¸€è‡´çš„ï¼š â€œåˆ›å»ºå¯å¤šäººåä½œçš„ã€æ˜“äºŽç†è§£çš„ã€æ˜“è¯»çš„ä»¥åŠå¯æµ‹è¯•çš„ä»£ç ã€‚â€ çŽ°åœ¨ä¾æ¬¡çœ‹ä¸€ä¸‹å„ä¸ªåŽŸåˆ™ï¼ŒSOLID æ˜¯ä»¥ä¸‹æ˜¯åŽŸåˆ™çš„ç¼©å†™ï¼š S å•ä¸€èŒè´£åŽŸåˆ™ O å¼€é—­åŽŸåˆ™ L é‡Œæ°æ›¿æ¢åŽŸåˆ™ I æŽ¥å£éš”ç¦»åŽŸåˆ™ D ä¾èµ–åè½¬åŽŸåˆ™ æœ¬æ–‡ä¸»è¦è®²D ä¾èµ–åè½¬åŽŸåˆ™ whatå’Œwhy ä»€ä¹ˆæ˜¯ä¾èµ–åè½¬ ä¸ºä»€ä¹ˆéœ€è¦ä¾èµ–åè½¬ ä¾èµ–æ³¨å…¥DIæ˜¯ä¾èµ–åè½¬çš„ä¸€ç§å®žçŽ°æ–¹å¼ï¼Œæˆ‘çœ‹äº†å¾ˆå¤šå®šä¹‰æè¿°æˆ‘è§‰å¾—éƒ½ä¸å¦‚æ¥ä¸€ä¸ªå®žä¾‹å¯¹æ¯”æ›´èƒ½è§£é‡Šæ¸…æ¥šã€‚ å…ˆæ¥çœ‹çœ‹ä¸ä½¿ç”¨DIçš„æ¡ˆä¾‹ Application needs Foo (e.g. a controller), so: Application creates Foo Application calls Foo Foo needs Bar (e.g. a service), so: Foo creates Bar Foo calls Bar Bar needs Bim (a service, a repository, â€¦), so: Bar creates Bim Bar does something å¯ä»¥çœ‹åˆ°çš„é—®é¢˜æ˜¯:ä¾èµ–è¢«åˆ†æ•£å±‚å±‚åˆ›å»º å†æ¥çœ‹çœ‹ä½¿ç”¨DIçš„æƒ…å†µ Application needs Foo so: Application gets Foo from the Container, so: Container creates Bim Container creates Bar and gives it Bim Container creates Foo and gives it Bar Application calls Foo Foo calls Bar Bar does something ä¾èµ–è¢«é›†ä¸­åˆ›å»ºå’Œæ³¨å…¥ è¿™æ ·çš„å¥½å¤„æ˜¯ä»€ä¹ˆï¼Ÿä¸¾ä¸ªä¾‹å­å§ å¦‚ä½•ä½ çš„ä¸€ä¸ªLibrary X ä½¿ç”¨äº† Logger Yï¼Œ ä½ æƒ³ä½¿ç”¨ä½ è‡ªå·±å®šä¹‰çš„logger Z? ä½¿ç”¨DIçš„è¯, å°±ä¸éœ€è¦æ”¹å˜ Library Xçš„ä»£ç äº†. ä»£ç å®žä¾‹å†æ¥çœ‹çœ‹å®žä¾‹ä»£ç ç‰ˆæœ¬ éžDIclass GoogleMaps &#123; public function getCoordinatesFromAddress($address) &#123; // calls Google Maps webservice &#125; &#125; class OpenStreetMap &#123; public function getCoordinatesFromAddress($address) &#123; // calls OpenStreetMap webservice &#125; &#125; class StoreService &#123; public function getStoreCoordinates($store) &#123; $geolocationService = new GoogleMaps(); // or $geolocationService = GoogleMaps::getInstance() if you use singletons return $geolocationService->getCoordinatesFromAddress($store->getAddress()); &#125; &#125; ä¸šåŠ¡åœºæ™¯å¾ˆç®€å•ï¼Œå°±æ˜¯èŽ·å–åº—é“ºçš„åæ ‡ï¼Œæƒ…å†µæ˜¯å¯ä»¥æœ‰2ä¸ªæˆ–å¤šä¸ªåœ°å›¾æœåŠ¡ã€‚ DIclass StoreService &#123; private $geolocationService; public function __construct(GeolocationService $geolocationService) &#123; $this->geolocationService = $geolocationService; &#125; public function getStoreCoordinates($store) &#123; return $this->geolocationService->getCoordinatesFromAddress($store->getAddress()); &#125; &#125; interface GeolocationService &#123; public function getCoordinatesFromAddress($address); &#125; class GoogleMaps implements GeolocationService &#123; ... class OpenStreetMap implements GeolocationService &#123; ... é€šè¿‡æž„é€ å‡½æ•°ä¼ å…¥åœ°å›¾æœåŠ¡å®žä¾‹ï¼Œä¸ç”¨å¯¹StoreServiceè¿›è¡Œæ›´æ”¹ã€‚StoreServiceä¸ç”¨å…³å¿ƒæ˜¯å“ªä¸ªåœ°å›¾æœåŠ¡ï¼Œä¸Žä¾èµ–è§£è€¦å¼€ã€‚ PHP-DIç”¨PHP-DIè¿›è¡Œå®žçŽ°ï¼Œä¸ç”¨é€šè¿‡æž„é€ å‡½æ•°çš„æ–¹å¼è¿›è¡Œä¼ é€’åœ°å›¾æœåŠ¡ã€‚ $storeService = $container->get('StoreService'); æ³¨å…¥æ”¹ä¸ºå®¹å™¨ç»Ÿä¸€æ³¨å…¥ã€‚ $container-&gt;set(&#39;GeolocationService&#39;, \\DI\\create(&#39;GoogleMaps&#39;)); å¼•å…¥äº†å®¹å™¨çš„æ¦‚å¿µçš„å¥½å¤„æ˜¯ï¼Œå¦‚æžœè®©å®¹å™¨åœ¨æ•´ä¸ªworkflowé‡Œï¼Œåˆ™å¯ä»¥è½»æ˜“çš„å…¨å±€æ›´æ”¹ä»»ä½•çš„ä¾èµ–ã€‚","categories":[],"tags":[]},{"title":"å…³äºŽOKRçš„æ€è€ƒ","slug":"å…³äºŽOKRçš„æ€è€ƒ","date":"2021-09-06T12:01:29.000Z","updated":"2021-10-30T02:59:33.282Z","comments":true,"path":"2021/09/06/å…³äºŽOKRçš„æ€è€ƒ/","link":"","permalink":"http://visonforcoding.xyz/2021/09/06/%E5%85%B3%E4%BA%8EOKR%E7%9A%84%E6%80%9D%E8%80%83/","excerpt":"èµ·å› æ˜¯ç”±äºŽæˆ‘çš„è€æ¿åœ¨æœˆåˆçš„æ—¶å€™åˆå¸ƒç½®ä»»åŠ¡è¦æ±‚å†™ä¸‹æœ¬æœˆçš„å…³é”®ç›®æ ‡Top3ã€‚ä¹Ÿå°±æ˜¯OKR Top3,å¹¶ä¸”è¦æ±‚ç”¨SMARTåŽŸåˆ™ã€‚ åœ¨æ­¤ä¹‹å‰é¢†å¯¼ä¸€ç›´å‘Šè¯‰æˆ‘ä»¬KPIå’ŒOKRæ˜¯åˆ†åˆ«ç”¨æ¥ç®¡ç†é”€å”®å›¢é˜Ÿå’ŒèŒèƒ½å›¢é˜Ÿçš„ã€‚å› ä¸ºé”€å”®å›¢é˜Ÿå¾ˆå®¹æ˜“ç”¨æ•°æ®æŒ‡æ ‡æ¥è¡¡é‡å·¥ä½œç»“æžœï¼Œä½†èŒèƒ½å›¢é˜Ÿçš„å·¥ä½œå¹¶ä¸å¥½ç”¨æ•°æ®æŒ‡æ ‡æ¥è¡¡é‡ã€‚ ä½†æ˜¯SMARTåŽŸåˆ™äº”æ¡åˆæœ‰Measurable(å¯è¡¡é‡çš„),äºŽæ˜¯æˆ‘æœ‰ç‚¹æƒŠè®¶ã€‚å¦‚æžœOKR+SMARTé‚£è·ŸKPIæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ","text":"èµ·å› æ˜¯ç”±äºŽæˆ‘çš„è€æ¿åœ¨æœˆåˆçš„æ—¶å€™åˆå¸ƒç½®ä»»åŠ¡è¦æ±‚å†™ä¸‹æœ¬æœˆçš„å…³é”®ç›®æ ‡Top3ã€‚ä¹Ÿå°±æ˜¯OKR Top3,å¹¶ä¸”è¦æ±‚ç”¨SMARTåŽŸåˆ™ã€‚ åœ¨æ­¤ä¹‹å‰é¢†å¯¼ä¸€ç›´å‘Šè¯‰æˆ‘ä»¬KPIå’ŒOKRæ˜¯åˆ†åˆ«ç”¨æ¥ç®¡ç†é”€å”®å›¢é˜Ÿå’ŒèŒèƒ½å›¢é˜Ÿçš„ã€‚å› ä¸ºé”€å”®å›¢é˜Ÿå¾ˆå®¹æ˜“ç”¨æ•°æ®æŒ‡æ ‡æ¥è¡¡é‡å·¥ä½œç»“æžœï¼Œä½†èŒèƒ½å›¢é˜Ÿçš„å·¥ä½œå¹¶ä¸å¥½ç”¨æ•°æ®æŒ‡æ ‡æ¥è¡¡é‡ã€‚ ä½†æ˜¯SMARTåŽŸåˆ™äº”æ¡åˆæœ‰Measurable(å¯è¡¡é‡çš„),äºŽæ˜¯æˆ‘æœ‰ç‚¹æƒŠè®¶ã€‚å¦‚æžœOKR+SMARTé‚£è·ŸKPIæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ äºŽæ˜¯æˆ‘è®¤ä¸ºOKR+SMART = KPI. ä½†ç©¶ç«Ÿæ˜¯ä¸æ˜¯è¿™æ ·å‘¢ï¼Ÿ OKRå’ŒKPIå…ˆæ¥çœ‹çœ‹KPIï¼Œå› ä¸ºæœ¬èº«OKRæ˜¯åŽæ¥æ‰æå‡ºæ¥çš„æ¦‚å¿µã€‚ç›¸è¾ƒäºŽOKRï¼ŒKPIæ›´å¹¿å’Œæ›´æ—©è¢«äººæ‰€çŸ¥ã€‚ KPI æ˜¯ Key Performance Indicator çš„ç¼©å†™ï¼Œä¸­æ–‡åç§°æ˜¯ã€Œå…³é”®ç»©æ•ˆæŒ‡æ ‡ã€ï¼Œå³ä¸€ç³»åˆ—è¡¡é‡å·¥ä½œæˆæ•ˆçš„é‡è¦æŒ‡æ ‡ã€‚ å…³é”®ç‚¹æœ‰äº†ï¼ŒæŒ‡æ ‡ KPI å¿…é¡»æ˜¯å®¢è§‚çš„ã€å¯è¡¡é‡çš„ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„ KPIï¼š åŒ»ç–—ä¿å¥è¡Œä¸šï¼šæ‚£è€…ç­‰å¾…æ—¶é—´ã€å¹³å‡æ²»ç–—è´¹ç”¨ é›¶å”®è¡Œä¸šï¼šåªæ•ˆã€æ¯åå‘˜å·¥é”€å”®é¢ äººåŠ›èµ„æºéƒ¨é—¨ï¼šç¦»èŒçŽ‡ã€å¹³å‡æ‹›è˜æ—¶é—´ é”€å”®éƒ¨é—¨ï¼šé”€å”®æ”¶å…¥ã€æ‹¨æ‰“ç”µè¯çš„æ¬¡æ•° å®¢æœéƒ¨é—¨ï¼š å®¢æˆ·æ»¡æ„åº¦NPS å†æ¥çœ‹ä¸‹OKR OKR æ˜¯ Objective and Key Results çš„ç¼©å†™ï¼Œä¸­æ–‡åç§°æ˜¯ã€Œç›®æ ‡ä¸Žå…³é”®ç»“æžœæ³•ã€ï¼Œæ˜¯ä¸€å¥—å¸®åŠ©ç»„ç»‡å®žçŽ°ç›®æ ‡ç®¡ç†ã€æŽ¨åŠ¨æ‰§è¡Œä¸Žåä½œçš„å·¥å…·å’Œæ–¹æ³•ï¼Œå…³é”®ç‚¹å·¥å…·å’Œæ–¹æ³•ã€‚ å½“ç„¶KPIä¹Ÿå¯ä»¥ç†è§£ä¸ºæ–¹æ³•ï¼Œä½†æ˜¯OKRçš„å·¥å…·æ€§å’Œæ–¹æ³•æŒ‡å¯¼æ„ä¹‰ä¼šæ›´å¼ºã€‚ OKRoKRå¼ºè°ƒåœ¨â€ç¬¬ä¸€æ€§åŽŸç†â€æ€è€ƒæ–¹å¼çš„åŸºç¡€ä¸Š,èšç„¦æˆ˜ç•¥é‡ç‚¹,æå²€é¼“èˆžäººå¿ƒçš„ç›®æ ‡,é€‰æ‹©ROæ›´ä¼˜çš„ç­–ç•¥,ä»Žè€Œæ¿€å‘ç»„ç»‡æ´»åŠ›,é™ä½Žå…±è¯†æˆæœ¬,ä¿ƒè¿›å›¢é˜Ÿå’Œä¸ªäººå›´ç»•ç»„ç»‡ç›®æ ‡é«˜æ•ˆåä½œ. ä¸€ä¸ªå…¬å¸éƒ½ä¼šæŒ‡å®šå…¬å¸ç»ˆç”Ÿå¥‹æ–—çš„ä½¿å‘½ï¼Œæ„¿æ™¯ã€‚ å…³äºŽä½¿å‘½å’Œæ„¿æ™¯ æˆ‘ä¹Ÿå¬åˆ°è¿‡æˆ‘é¢†å¯¼è·Ÿæˆ‘è®²çš„æ¯”è¾ƒæœ‰æ„æ€çš„è§£é‡Šç‰ˆæœ¬ã€‚ ä½¿å‘½ å¯èƒ½æ˜¯å½“ä¸‹å°±å¯ä»¥å®žçŽ°çš„ã€‚æ„¿æ™¯ å¯èƒ½ä¸èƒ½å®žçŽ°ï¼Œä½†æ˜¯å…¬å¸è¦ä¸ºä¹‹å¥‹æ–—çš„ç›®æ ‡ã€‚ ä¾‹å¦‚ apple æ„¿æ™¯ï¼šè®©æ¯äººæ‹¥æœ‰ä¸€å°è®¡ç®—æœºï¼›ä½¿å‘½ï¼šæŽ¨å¹¿å…¬å¹³çš„èµ„æ–™ä½¿ç”¨æƒ¯ä¾‹ï¼Œå»ºç«‹ç”¨æˆ·å¯¹äº’è”ç½‘ä¹‹ä¿¡ä»»å’Œä¿¡å¿ƒ è¨€å½’æ­£ä¼ ã€‚ä¸ºäº†å®Œæˆä½¿å‘½æˆ–è€…æŽ¥è¿‘æ„¿æ™¯ã€‚å…¬å¸é«˜å±‚å¿…ç„¶ä¼šåˆ¶å®šé•¿æœŸçš„æˆ˜ç•¥è®¡åˆ’ã€‚ é‚£ä¹ˆä¸ºäº†è¿™äº›æˆ˜ç•¥è®¡åˆ’ï¼Œæ¯ä¸ªå±‚çº§æ¯ä¸ªäººéƒ½å› ä¸ºæƒ³åˆ°æˆ‘å¯ä»¥å®Œæˆä»€ä¹ˆå’Œå¦‚ä½•è¾¾åˆ°ç›®æ ‡ã€‚ ä»¥åŠæ›´ç»†åŒ–çš„ä¸ºäº†è½åœ°è¿™äº›ç›®æ ‡å’Œå…³é”®ç»“æžœ éœ€è¦å»ºç«‹å“ªäº›é¡¹ç›®æˆ–é¡¹ç›®ä»»åŠ¡ ä»Žå®è§‚çš„ä¼ä¸šæˆ˜ç•¥åˆ°å¾®è§‚ä¸ªäººä»»åŠ¡ï¼ŒOKRèƒ½å¾ˆå¥½çš„æˆä¸ºä¼ä¸šç›®æ ‡ç®¡ç†ä½“ç³»å’Œä¸ªäººçš„å·¥ä½œæ–¹æ³•ã€‚ OKRæ˜¯æ›´ç¬¦åˆæ—¶ä»£éœ€è¦çš„ç®¡ç†æ–¹æ³• ä¼ä¸šç«¯:VUCAæ—¶ä»£,è®©ç»„ç»‡æŒç»­è¿›åŒ–æ˜¯åº”å¯¹ä¸ç¡®å®šæ€§çš„æ ¹æœ¬ äººæ‰ç«¯:ä¸ªä½“å´›èµ·,ç®¡ç†ä»Žå¼ºè°ƒç®¡æŽ§èµ°å†‹è‡ªé©±ä¸Žåä½œ æ™®é€‚æ€§:å›´ç»•ç›®æ ‡å¼€å±•å·¥ä½œæ˜¯å¾ˆè‡ªç„¶çš„äº‹ ä¾›ç»™ç«¯: OKR SaaSæŠŠé¢†å…ˆå®žè·µäº§å“åŒ–,è®©æ›´å¤šä¼ä¸šä»¥ä½Žæˆæœ¬å—ç›Š è®¤çŸ¥:OKRä¸æ˜¯ä¸‡èƒ½è¯,æ­£ç¡®è®¤è¯†OKRæ‰èƒ½ç”¨å¥½OKR æˆ˜ç•¥å±‚é¢:ä»Žé•¿è¿œè§„åˆ’è½¬å‘æ•æ·è¿­ä»£ è¿‡åŽ»ä¼ä¸šåšæˆ˜ç•¥é€šå¸¸è¦çœ‹3-5å¹´,å‰ææ˜¯å¸‚åœºå…è®¸ä½ ä¿æŒçº¿æ€§å¢žé•¿çš„åˆç†é¢„æœŸã€‚ä»Šå¤©,éžçº¿æ€§å¢žé•¿æˆä¸ºæ™®éæƒ…å†µ,ä¼ä¸šæ›´åŠ èšç„¦åœ¨çœ¼å‰çš„åŠå¹´æˆ–ä¸€å¹´,ä»¥æ›´å¿«çš„é€Ÿåº¦åº”å¯¹å¸‚åœºå’Œéœ€æ±‚å˜åŒ–ã€‚ ç»„ç»‡å±‚é¢:ä»Žç§‘å±‚åˆ¶ã€æ¡çº¿å¼è¿ä½œ,å‘åˆ†å¸ƒå¼å†³ç­–ã€ç½‘ç»œåŒ–åä½œçš„æ–¹å‘å‘å±• ç§‘å±‚åˆ¶æœ€å¤§çš„ç‰¹ç‚¹,æ˜¯æŒ‡ä»¤å¼çš„ä¸Šä¼ ä¸‹è¾¾,æ¯ä¸€å±‚éƒ½ä¾èµ–ä¸Šä¸€å±‚çš„å†³ç­–,è¾ƒä¸ºè¢«åŠ¨ä½Žæ•ˆ,ä¹Ÿéš¾ä»¥äº§ç”Ÿåˆ›æ–°ã€‚åˆ†å¸ƒå¼ã€ç½‘ç»œåŒ–çš„ç»„ç»‡é‡Œ,æ¯ä¸ªèŠ‚ç‚¹(å›¢é˜Ÿæˆ–ä¸ªäºº)éƒ½æ›´åŠ è‡ªä¸»çš„å†³ç­–å’Œè¡ŒåŠ¨,ä¸»åŠ¨å‘èµ·åä½œ,æ›´åŠæ—¶çš„å“åº”å˜åŒ–,æ¶ŒçŽ°æ›´å¤šåˆ›æ–°ã€‚ æ–‡åŒ–å±‚é¢:ä»Žå¼ºè°ƒç®¡æŽ§ã€ä¸€è‡´åˆ°æ›´åŠ å¤šå…ƒåŒ–ã€å…¼å®¹å¹¶è“„ å¼ºè°ƒç®¡æŽ§ä¹Ÿæ˜¯ç§‘å±‚åˆ¶ç»„ç»‡ç‰¹å¾çš„å»¶ç»­,ä»Šå¤©çš„ç»„ç»‡éœ€è¦æ›´å¤šæ ·åŒ–çš„æ€æƒ³å’Œå®žè·µ,äº§ç”Ÿæ–°çš„å˜åŒ–,åœ¨å…§å¤–éƒ¨å½¢æˆæ›´åŠ å¥åº·çš„ç”Ÿæ€,æ‰èƒ½äº§ç”Ÿæ›´å¤šå¯èƒ½æ€§ã€‚ OKRè®©æ¯ä¸€ä½å‘˜å·¥äº†è§£ç»„ç»‡çš„æ•´ä½“ç›®æ ‡,æ‰¾åˆ°è‡ªå·±å·¥ä½œä¸Žç»„ç»‡ç›®æ ‡çš„è”ç³»,èŽ·å¾—æ„ä¹‰ä¸Žæˆå°±æ„Ÿ OKRè®¤çŸ¥ç¬¬ä¸€,OKRå¹¶ä¸è§£å†³æˆ˜ç•¥è§„åˆ’çš„é—®é¢˜ â—‹KRèƒ½å¤Ÿå¸®åŠ©ä¼ä¸šæ›´å¥½åœ°æ€è€ƒå’Œè½åœ°æˆ˜ç•¥,ä½†ä¸æ˜¯ç”¨äº†OKRå°±æœ‰æ›´å¥½çš„æˆ˜ç•¥OKRæœ¬è´¨æ˜¯ä¸€ç§äººäººçš†å›´ç»•æˆ˜ç•¥åœ¨ä¸»åŠ¨æ€è€ƒå¹¶åº¦é‡ç»“æžœçš„æ–¹æ³•å’Œå·¥å…· ç¬¬äºŒ,OKRä¸èƒ½ä»£æ›¿é¢†å¯¼åŠ› ä»…ä»…è®¾å®šä¸€ä¸ªç›®æ ‡å¹¶ä¸èƒ½å¸¦æ¥æˆåŠŸ,é¢†å¯¼è€…ã€ç®¡ç†è€…å¸¦é¢†å›¢é˜Ÿå…±åŒåŠªåŠ›,æ‰èƒ½æ›´å¥½è¾¾æˆç›®æ ‡å„çº§ç®¡ç†è€…éƒ½å¿…é¡»ä¸»åŠ¨æ€è€ƒä¸šåŠ¡æœ¬è´¨å’Œæœ€ä½³è·¯å¾„é€šè¿‡OKRåˆ†æ´¾ä»»åŠ¡,æ˜¯å¯¹OKRçš„è¯¯ç”¨,æ›´æ˜¯ç®¡ç†ä¸Šçš„æ‡’æ”¿ ç¬¬ä¸‰,OKRä¸æ˜¯ç»©æ•ˆè€ƒæ ¸ ç›®æ ‡ç®¡ç†è®©å‘˜å·¥ä¸“æ³¨æ€è€ƒå¦‚ä½•å®žçŽ°ç›®æ ‡,ç»©æ•ˆè€ƒæ ¸ä¸“æ³¨äºŽå¯¹å‘˜å·¥æ‰€åšè´¡çŒ®ç»™äºˆå…¬å¹³å›žæŠ¥,å‰è€…æ˜¯ä»·å€¼åˆ›é€ ,åŽè€…æ˜¯ä»·å€¼åˆ†é…,äºŒè€…æœ‰æœ¬è´¨åŒºåˆ«é¢†å…ˆå®žè·µä¸»å¼ å°†ç›®æ ‡ç®¡ç†å’Œç»©æ•ˆè¯„ä»·è§£ç»‘ã€‚ä¾‹å¦‚è°·æ­Œã€å­—èŠ‚è·³åŠ¨,â—‹KRä½œä¸ºç›®æ ‡ç®¡ç†å·¥å…·,ç»©æ•ˆè€ƒæ ¸é€šè¿‡360Â°è¯„ä»·å®žçŽ°ã€‚å¦‚æžœç›´æŽ¥è€ƒæ ¸OKRè¾¾æˆçŽ‡,ç»„ç»‡åŠ¿å¿…åˆå°†é™·å…¥KP|å¼çš„è®¨ä»·è¿˜ä»·,ä¹Ÿæ›´å®¹æ˜“æ»‹ç”ŸçŸ­æœŸè¡Œä¸º OKRè½åœ° OKRçš„å®žæ–½æ­¥éª¤éµå¾ªç»å…¸çš„â€œPDCAâ€ç›®æ ‡ç®¡ç†æµç¨‹ã€‚ä»¥å¹´åº¦ä¸ºä¾‹,â—‹KRçš„è¿è¡Œä¸€èˆ¬éµå¾ª ç›®æ ‡åˆ¶å®š-è¿‡ç¨‹è·Ÿè¿›-æ€»ç»“å¤ç›˜-è€ƒæ ¸åº”ç”¨å››æ­¥å®žæ–½æµç¨‹,å¹¶å½¢æˆé—­çŽ¯ç®¡ç†ã€‚ åœ¨ä¸€ä¸ªå¹´åº¦å†…,ä¼šæœ‰å¤šä¸ªåŒæœˆæˆ–å­£åº¦OKRå‘¨æœŸ,æ­¤å‘¨æœŸå†…ä¸»è¦ä»¥ç›®æ ‡åˆ¶å®š-è¿‡ç¨‹è·Ÿè¿›-æ€»ç»“å¤ç›˜çŽ¯èŠ‚å½¢æˆçš„å°é—­çŽ¯è¿›è¡Œè¿ä½œã€‚ äº”å¤§æˆåŠŸå› ç´  é«˜å±‚ç®¡ç†è€…çš„ç§¯æžå‚ä¸Ž æŠŠOKRåº”ç”¨åˆ°æ—¥å¸¸ç®¡ç† åˆ›é€ è‰¯å¥½çš„å®žæ–½çŽ¯å¢ƒ ä¾¿æ·é«˜æ•ˆçš„OKRç³»ç»Ÿ ä¸“é—¨çš„OKRè¿è¥å›¢é˜Ÿ è¿™é‡Œæˆ‘è®¤ä¸º ç¬¬ä¸€ ç¬¬äºŒç‚¹å°¤ä¸ºé‡è¦ã€‚ æ€»ç»“ OKRä¸åŒäºŽKPIï¼ŒOKR+SMART ä¹Ÿä¸ç­‰äºŽKPI OKRæ˜¯æ›´é€‚åº”å½“ä»£çš„ç®¡ç†å·¥å…·ï¼Œé¢å¯¹æ–°æ—¶ä»£çš„â€äººâ€å’Œçž¬å³ä¸‡å˜çš„å¿«èŠ‚å¥ OKRæ›´æ³¨é‡ç›®æ ‡å¯¼å‘,æ²¡æœ‰ç²¾ç¡®è§„ç»“æžœï¼Œæ›´èƒ½æ¿€å‘å›¢é˜Ÿè‡ªä¸»æ€§ å¹¶ä¸æ„å‘³ç€å¯ä»¥æ‘ˆå¼ƒKPIï¼Œè€Œåº”é‡‡å–OKRä¸ºä¸»KPIä¸ºè¾…çš„æ–¹å¼ã€‚ å¯¹KPIçš„è®¤çŸ¥å°¤ä¸ºé‡è¦ï¼Œä¸Šåˆ°æœ€é«˜å±‚ä¸‹åˆ°åŸºå±‚éƒ½åº”è¯¥ç†è§£OKRçš„ä½œç”¨å’Œå¦‚ä½•è¿ç”¨OKRã€‚ æ‰€æœ‰ç®¡ç†æ–¹æ³•éƒ½åº”ä»¥äººä¸ºæœ¬ï¼Œç¦»ä¸å¼€åŸºç¡€çš„æ²Ÿé€šã€æ¼”è®²æŠ€å·§ã€‚è¦è®©æ–¹æ³•å‘æŒ¥åŠŸæ•ˆï¼Œè¿˜éœ€è¦æœ‰å¼ºå¤§çš„æ„Ÿå¬åŠ›ã€‚","categories":[],"tags":[{"name":"ç®¡ç†","slug":"ç®¡ç†","permalink":"http://visonforcoding.xyz/tags/%E7%AE%A1%E7%90%86/"}]},{"title":"ä»£ç æ•´æ´ä¹‹é“","slug":"ä»£ç æ•´æ´ä¹‹é“","date":"2021-07-30T01:42:27.000Z","updated":"2021-10-30T02:59:33.282Z","comments":true,"path":"2021/07/30/ä»£ç æ•´æ´ä¹‹é“/","link":"","permalink":"http://visonforcoding.xyz/2021/07/30/%E4%BB%A3%E7%A0%81%E6%95%B4%E6%B4%81%E4%B9%8B%E9%81%93/","excerpt":"è½¯ä»¶è´¨é‡ä¸ä½†ä¾èµ–äºŽæž¶æž„åŠé¡¹ç›®ç®¡ç†ï¼Œè¿˜ä¸Žä»£ç è´¨é‡ç´§å¯†ç›¸å…³ã€‚ ä»£ç è´¨é‡ä¸Žæ•´æ´åº¦æˆæ­£æ¯”ï¼Œå¹²å‡€çš„ä»£ç å³åœ¨è´¨é‡ä¸Šè¾ƒä¸ºå¯é ï¼Œä¹Ÿä¸ºåŽæœŸç»´æŠ¤ã€å‡çº§å¥ å®šè‰¯å¥½åŸºç¡€ã€‚ å¦ä¸€ç§æ¦‚å¿µå«åšæžé™ç¼–ç¨‹ åŽŸåˆ™ SOLID DRY KISS ç«¥å­å†›å†›è§„è®©è¥åœ°æ¯”ä½ æ¥æ—¶æ›´å¹²å‡€","text":"è½¯ä»¶è´¨é‡ä¸ä½†ä¾èµ–äºŽæž¶æž„åŠé¡¹ç›®ç®¡ç†ï¼Œè¿˜ä¸Žä»£ç è´¨é‡ç´§å¯†ç›¸å…³ã€‚ ä»£ç è´¨é‡ä¸Žæ•´æ´åº¦æˆæ­£æ¯”ï¼Œå¹²å‡€çš„ä»£ç å³åœ¨è´¨é‡ä¸Šè¾ƒä¸ºå¯é ï¼Œä¹Ÿä¸ºåŽæœŸç»´æŠ¤ã€å‡çº§å¥ å®šè‰¯å¥½åŸºç¡€ã€‚ å¦ä¸€ç§æ¦‚å¿µå«åšæžé™ç¼–ç¨‹ åŽŸåˆ™ SOLID DRY KISS ç«¥å­å†›å†›è§„è®©è¥åœ°æ¯”ä½ æ¥æ—¶æ›´å¹²å‡€ æœ‰æ„ä¹‰çš„å‘½å åå‰¯å…¶å®žï¼Œè¡¨è¾¾çœŸå®žæ„ä¹‰ ä¸è¯¯å¯¼ åšæœ‰æ„ä¹‰çš„åŒºåˆ†ï¼Œé¿å… aã€bã€c å¯è¯»ã€å¯æœç´¢ å‡½æ•° å•ä¸€èŒè´£ è¡Œæ•° 20-100 å‡½æ•°å‚æ•° 0å‚æ•°æœ€ä½³ï¼Œ3ä¸ªå‚æ•°å·²ç»å‹‰ä¸ºå…¶éš¾ æ ‡è¯†å‚æ•°ä¸‘é™‹ä¸å ªï¼Œå‘å‚æ•°ä¼ å…¥å¸ƒå°”å€¼éª‡äººå¬é—» å¦‚æžœå‡½æ•°éœ€è¦ä¸‰ä¸ªä»¥ä¸Šçš„å‚æ•°ï¼Œè¯´æ˜Žè¿™äº›å‚æ•°åº”è¯¥å°è£…ä¸ºç±»äº† Circle makeCircle(double x,double y,double radius); Circle makeCircle(Point center,double radius); class Foo &#123; public function bar($flag = true) &#123; &#125; æ— å‰¯ä½œç”¨å‡½æ•°æ‰¿è¯ºåªåšä¸€ä»¶äº‹ï¼Œå®žé™…ä¸Šè¿˜åšäº†å…¶ä»–çš„ã€‚ public class UserValidator &#123; private Cryptographer cryptographer; public boolean checkPassword(String userName, String password)&#123; User user = UserGateway.findByName(userName) ; if (user != User.NULL) &#123; String codedPhrase = user.getPhraseEncodedByPassword(); String phrase = cryptographer.decrypt (codedPhrase,password ); if(\"Valid Password\".equals(phrase))&#123; Session.initialize(); //å®žé™…ä¸Šè¿˜åšäº†session åˆå§‹åŒ–çš„æ“ä½œ return true; &#125; return false; &#125; è¦ä¹ˆæŠ½ç¦»Session.initialize(),è¦ä¹ˆé‡å‘½åä¸ºcheckPasswordAndInitializeSession ä¸è¦ç»™äººè¯¯å¯¼ã€‚ ä½¿ç”¨å¼‚å¸¸ä»£æ›¿é”™è¯¯ç ä½¿ç”¨é”™è¯¯ç å°±è¦å®šä¹‰é”™è¯¯ç æžšä¸¾ï¼Œæžšä¸¾ç±»è¢«å¤§é‡å¯¼å…¥è°ƒç”¨ã€‚ä¸€æ—¦å¢žåŠ æˆ–ä¿®æ”¹é”™è¯¯æžšä¸¾ï¼Œå°±è¦å¯¹æ‰€æœ‰å¼•å…¥çš„æ–‡ä»¶è¿›è¡Œç¼–è¯‘ã€‚ if (deletePage(page)==E_OK)&#123; if (registry.deleteReference(page.name)==E_OK)&#123; if (configKeys.deleteKey(page.name.makeKey())==E_OK)&#123; logger.log(\"page deleted\"); &#125; else &#123; logger.log(\"configKey not deleted\"); &#125; else &#123; logger. log(\"deleteReference from registry failed\"); &#125; else &#123; logger.log(\"delete failed\"); &#125; return E_ERROR; &#125; try &#123; deletePage(page); registry.deleteReference(page.name); configKeys.deleteKey(page.name.makeKey()); &#125; catch (Exception e) &#123; logger.log(e.getMessage()); &#125; æ³¨é‡Šæ³¨é‡Šå¹¶ä¸åƒè¾›å¾·å‹’çš„åå•ã€‚å®ƒä»¬å¹¶ä¸â€œçº¯ç„¶åœ°å¥½â€ã€‚å®žé™…ä¸Šï¼Œæ³¨é‡Šæœ€å¤šä¹Ÿå°±æ˜¯ä¸€ç§å¿…é¡»çš„æ¶ã€‚è‹¥ç¼–ç¨‹è¯­è¨€è¶³å¤Ÿæœ‰è¡¨è¾¾åŠ›ï¼Œæˆ–è€…æˆ‘ä»¬é•¿äºŽç”¨è¿™äº›è¯­è¨€æ¥è¡¨è¾¾æ„å›¾ï¼Œå°±ä¸é‚£ä¹ˆéœ€è¦æ³¨é‡Šâ€”â€”ä¹Ÿè®¸æ ¹æœ¬ä¸éœ€è¦ã€‚ æ³¨é‡ŠæŽ‰çš„ä»£ç 20ä¸–çºª60å¹´ä»£ï¼Œæ›¾ç»æœ‰é‚£ä¹ˆä¸€æ®µæ—¶é—´ï¼Œæ³¨é‡ŠæŽ‰çš„ä»£ç å¯èƒ½æœ‰ç”¨ã€‚ä½†æˆ‘ä»¬å·²ç»æ‹¥æœ‰ä¼˜è‰¯çš„æºä»£ç æŽ§åˆ¶ç³»ç»Ÿå¦‚æ­¤ä¹‹ä¹…ï¼Œè¿™äº›ç³»ç»Ÿå¯ä»¥ä¸ºæˆ‘ä»¬è®°ä½ä¸è¦çš„ä»£ç ã€‚æˆ‘ä»¬æ— éœ€å†ç”¨æ³¨é‡Šæ¥æ ‡è®°ï¼Œåˆ æŽ‰å³å¯ï¼Œå®ƒä»¬ä¸¢ä¸äº†ã€‚æˆ‘æ‹…ä¿ã€‚ æ ¼å¼æ–‡ä»¶é•¿åº¦ 200-500 è¡Œå­—ç¬¦æ•° ä¸Šé™120 å¯¹è±¡å’Œæ•°æ®ç»“æž„å¾·èŽ«ç‰¹å®šå¾‹è‘—åçš„å¾—å¢¨å¼è€³å¾‹ï¼ˆThe Law of Demeter)è®¤ä¸ºï¼Œæ¨¡å—ä¸åº”äº†è§£å®ƒæ‰€æ“ä½œå¯¹è±¡çš„å†…éƒ¨å½¢ã€‚å¦‚ä¸ŠèŠ‚æ‰€è§ï¼Œå¯¹è±¡éšè—æ•°æ®ï¼Œæ›éœ²æ“ä½œã€‚è¿™æ„å‘³ç€å¯¹è±¡ä¸åº”é€šè¿‡å­˜å–å™¨æ›éœ²å…¶å†…éƒ¨ç»“æž„å› ä¸ºè¿™æ ·æ›´åƒæ˜¯æ›éœ²è€Œéžéšè—å…¶å†…éƒ¨ç»“æž„ã€‚æ›´å‡†ç¡®åœ°è¯´ï¼Œå¾—å¢¨å¼è€³å¾‹è®¤ä¸ºï¼Œç±»Cçš„æ–¹æ³•fåªåº”è¯¥è°ƒç”¨ä»¥ä¸‹å¯¹è±¡çš„æ–¹æ³•ï¼š C ç”±fåˆ›å»ºçš„å¯¹è±¡ï¼› ä½œä¸ºå‚æ•°ä¼ é€’ç»™fçš„å¯¹è±¡ï¼› ç”±Cçš„å®žä½“å˜é‡æŒæœ‰çš„å¯¹è±¡ã€‚ null åˆ«ä¼ nullå€¼ åˆ«è¿”å›žnullå€¼ ç³»ç»Ÿâ€œå¤æ‚è¦äººå‘½ã€‚å®ƒæ¶ˆç£¨å¼€å‘è€…çš„ç”Ÿå‘½ï¼Œè®©äº§å“éš¾ä»¥è§„åˆ’ã€æž„å»ºå’Œæµ‹è¯•ã€‚â€â€”â€”Ray Ozzie,å¾®è½¯å…¬å¸é¦–å¸­æŠ€æœ¯å®˜ ä¾èµ–æ³¨å…¥åœ¨ä¾èµ–ç®¡ç†æƒ…æ™¯ä¸­ï¼Œå¯¹è±¡ä¸åº”è´Ÿè´£å®žä½“åŒ–å¯¹è‡ªèº«çš„ä¾èµ–ã€‚åä¹‹ï¼Œå®ƒåº”å½“å°†è¿™ä»½æƒè´£ç§»äº¤ç»™å…¶ä»–â€œæœ‰æƒåŠ›â€çš„æœºåˆ¶ï¼Œä»Žè€Œå®žçŽ°æŽ§åˆ¶çš„åè½¬ã€‚å› ä¸ºåˆå§‹è®¾ç½®æ˜¯ä¸€ç§å…¨å±€é—®é¢˜ï¼Œè¿™ç§æŽˆæƒæœºåˆ¶é€šå¸¸è¦ä¹ˆæ˜¯mainä¾‹ç¨‹ï¼Œè¦ä¹ˆæ˜¯æœ‰ç‰¹å®šç›®çš„çš„å®¹å™¨ã€‚ æ‰©å®¹ â€œä¸€å¼€å§‹å°±åšå¯¹ç³»ç»Ÿâ€çº¯å±žç¥žè¯ã€‚ ä»£ç†AOPæœ‰æ—¶ä¼šä¸Žå®žçŽ°å®ƒçš„æŠ€æœ¯ç›¸æ··æ·†ï¼Œä¾‹å¦‚æ–¹æ³•æ‹¦æˆªå’Œé€šè¿‡ä»£ç†åšçš„â€œå°åŒ…â€ã€‚AOPç³»ç»Ÿçš„çœŸæ­£ä»·å€¼åœ¨äºŽç”¨ç®€æ´å’Œæ¨¡å—åŒ–çš„æ–¹å¼æŒ‡å®šç³»ç»Ÿè¡Œä¸ºã€‚ å¹¶å‘ç¼–ç¨‹å¹¶å‘ç¼–ç¨‹å¾ˆéš¾ï¼Œéžå¸¸éš¾ã€‚å¦‚æžœä½ ä¸é‚£ä¹ˆç»†å¿ƒï¼Œå°±ä¼šæžå‡ºä¸å ªå…¥ç›®çš„ä¸œè¥¿æ¥ã€‚çœ‹çœ‹ä»¥ä¸‹å¸¸è§çš„è¿·æ€å’Œè¯¯è§£ï¼š å¹¶å‘æ€»èƒ½æ”¹è¿›æ€§èƒ½å¹¶å‘æœ‰æ—¶èƒ½æ”¹è¿›æ€§èƒ½ï¼Œä½†åªåœ¨å¤šä¸ªçº¿ç¨‹æˆ–å¤„ç†å™¨ä¹‹é—´èƒ½åˆ†äº«å¤§é‡ç­‰å¾…æ—¶é—´çš„æ—¶å€™ç®¡ç”¨ã€‚äº‹æƒ…æ²¡é‚£ä¹ˆç®€å•ã€‚ ç¼–å†™å¹¶å‘ç¨‹åºæ— éœ€ä¿®æ”¹è®¾è®¡äº‹å®žä¸Šï¼Œå¹¶å‘ç®—æ³•çš„è®¾è®¡æœ‰å¯èƒ½ä¸Žå•çº¿ç¨‹ç³»ç»Ÿçš„è®¾è®¡æžä¸ç›¸åŒã€‚ç›®çš„ä¸Žæ—¶æœºçš„è§£è—•å¾€å¾€å¯¹ç³»ç»Ÿç»“æž„äº§ç”Ÿå·¨å¤§å½±å“ã€‚ åœ¨é‡‡ç”¨Webæˆ–EJBå®¹å™¨çš„æ—¶å€™ï¼Œç†è§£å¹¶å‘é—®é¢˜å¹¶ä¸é‡è¦å®žé™…ä¸Šï¼Œä½ æœ€å¥½äº†è§£å®¹å™¨åœ¨åšä»€ä¹ˆï¼Œäº†è§£å¦‚ä½•å¯¹ä»˜æœ¬ç« åŽæ–‡å°†æåˆ°çš„å¹¶å‘æ›´æ–°ã€æ­»é”ç­‰é—®é¢˜ã€‚ ä¸‹é¢æ˜¯ä¸€äº›æœ‰å…³ç¼–å†™å¹¶å‘è½¯ä»¶çš„ä¸­è‚¯è¯´æ³•ï¼š å¹¶å‘ä¼šåœ¨æ€§èƒ½å’Œç¼–å†™é¢å¤–ä»£ç ä¸Šå¢žåŠ ä¸€äº›å¼€é”€ï¼› æ­£ç¡®çš„å¹¶å‘æ˜¯å¤æ‚çš„ï¼Œå³ä¾¿å¯¹äºŽç®€å•çš„é—®é¢˜ä¹Ÿæ˜¯å¦‚æ­¤ï¼›å¹¶å‘ç¼ºé™·å¹¶éžæ€»èƒ½é‡çŽ°ï¼Œæ‰€ä»¥å¸¸è¢«çœ‹åšå¶å‘äº‹ä»¶è€Œå¿½ç•¥ï¼Œæœªè¢«å½“åšçœŸçš„ç¼ºé™·çœ‹å¾…ï¼› å¹¶å‘å¸¸å¸¸éœ€è¦å¯¹è®¾è®¡ç­–ç•¥çš„æ ¹æœ¬æ€§ä¿®æ”¹ã€‚ å‘³é“å»ºè®®å‘½åå¸¸é‡ä»£æ›¿é­”æœ¯æ•°å‡†ç¡® ç”¨æµ®ç‚¹æ•°è¡¨ç¤ºè´§å¸å‡ è¿‘äºŽçŠ¯ç½ªã€‚ å› ä¸ºä½ ä¸æƒ³åšå¹¶å‘æ›´æ–°å°±é¿å…ä½¿ç”¨é”å’Œ/æˆ–äº‹åŠ¡ç®¡ç†å¾€å¥½å¤„è¯´ä¹Ÿæ˜¯ä¸€ç§æ‡’æƒ°è¡Œä¸ºã€‚åœ¨ä»£ç ä¸­åšå†³å®šæ—¶ï¼Œç¡®è®¤è‡ªå·±è¶³å¤Ÿå‡†ç¡®ã€‚ æ˜Žç¡®è‡ªå·±ä¸ºä½•è¦è¿™ä¹ˆåšï¼Œå¦‚æžœé‡åˆ°å¼‚å¸¸æƒ…å†µå¦‚ä½•å¤„ç†ã€‚ åˆ«æ‡’å¾—ç†ä¼šå†³å®šçš„å‡†ç¡®æ€§ã€‚å¦‚æžœä½ æ‰“ç®—è°ƒç”¨å¯èƒ½è¿”å›žnullçš„å‡½æ•°ï¼Œç¡®è®¤è‡ªå·±æ£€æŸ¥äº†nullå€¼ã€‚ å¦‚æžœæŸ¥è¯¢ä½ è®¤ä¸ºæ˜¯æ•°æ®åº“ä¸­å”¯ä¸€çš„è®°å½•ï¼Œç¡®ä¿ä»£ç æ£€æŸ¥ä¸å­˜åœ¨å…¶ä»–è®°å½•ã€‚ å¦‚æžœè¦å¤„ç†è´§å¸æ•°æ®ï¼Œä½¿ç”¨æ•´æ•°ï¼å¹¶æ°å½“åœ°å¤„ç†å››èˆäº”å…¥ã€‚ å¦‚æžœå¯èƒ½æœ‰å¹¶å‘æ›´æ–°ï¼Œç¡®è®¤ä½ å®žçŽ°äº†æŸç§é”å®šæœºåˆ¶ã€‚ ä»£ç ä¸­çš„å«ç³Šå’Œä¸å‡†ç¡®è¦ä¹ˆæ˜¯æ„è§ä¸åŒçš„ç»“æžœï¼Œè¦ä¹ˆæºäºŽæ‡’æƒ°ã€‚æ— è®ºåŽŸå› æ˜¯ä»€ä¹ˆï¼Œéƒ½è¦æ¶ˆé™¤ã€‚ è¿”å›žå¼‚å¸¸/** * * @param array $awbnos * @throws Exception|ConnectionTimeOutException * @return array Description */ public function fetchTrace(array $awbnos):array &#123; &#125; php åˆ©ç”¨ phpdoc å’Œ php7 ç‰¹æ€§èƒ½æ”¯æŒè®©è°ƒç”¨è€…æ³¨æ„å¼‚å¸¸å’Œè¿”å›žå€¼çš„æ­£ç¡®å¤„ç†ã€‚ public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception&#123; &#125; java å‡½æ•°å®šä¹‰è¯­æ³•å¤©ç”Ÿæ”¯æŒã€‚ é¿å…è¿‡å¤šåµŒå¥— åŸºæœ¬æ³• å•ä¸€èŒè´£ï¼Œè´¯å½»è½å®ž çŸ­ã€å°‘ï¼Œç±»1000è¡Œï¼Œæ–¹æ³•120è¡Œï¼Œå‚æ•°3ä¸ªï¼Œä¸¥æ ¼è¦æ±‚ã€‚ æ¶ˆç­mess,æœ‰1ä¸ªå°±ä¼šæœ‰æ— æ•°ä¸ª Later equals never ç¨åŽç­‰äºŽæ°¸ä¸ï¼Œåˆ«ç­‰çŽ°åœ¨å°±åŽ»åš æ‰“ç£¨ï¼Œåˆ†è§£å‡½æ•°ã€ä¿®æ”¹åç§°ã€æ¶ˆé™¤é‡å¤ã€‚ç¼©çŸ­å’Œé‡æ–°å®‰ç½®æ–¹æ³•ã€‚æœ‰æ‹†æ•£ç±»ã€‚åŒæ—¶ä¿æŒæµ‹è¯•é€šè¿‡ã€‚ä¿æŒé‡æž„ã€çƒ­çˆ±é‡æž„ã€æ³¨æ„å•å…ƒæµ‹è¯•å›žå½’æµ‹è¯• æŽ¨èé˜…è¯» ã€ŠClean Codeã€‹ http://kaelzhang81.github.io/2020/04/10/è¯‘-è®¾è®¡é«˜è´¨é‡è½¯ä»¶/","categories":[],"tags":[{"name":"æŠ€æœ¯å·¥ç¨‹","slug":"æŠ€æœ¯å·¥ç¨‹","permalink":"http://visonforcoding.xyz/tags/%E6%8A%80%E6%9C%AF%E5%B7%A5%E7%A8%8B/"}]},{"title":"åˆ©ç”¨PHPMDè®©ä½ çš„phpä»£ç æ›´å¹²å‡€æ›´æ˜“ç»´æŠ¤","slug":"php/åˆ©ç”¨PHPMDè®©ä½ çš„phpä»£ç æ›´å¹²å‡€æ›´æ˜“ç»´æŠ¤","date":"2021-07-27T06:01:44.000Z","updated":"2021-11-28T05:55:36.758Z","comments":true,"path":"2021/07/27/php/åˆ©ç”¨PHPMDè®©ä½ çš„phpä»£ç æ›´å¹²å‡€æ›´æ˜“ç»´æŠ¤/","link":"","permalink":"http://visonforcoding.xyz/2021/07/27/php/%E5%88%A9%E7%94%A8PHPMD%E8%AE%A9%E4%BD%A0%E7%9A%84php%E4%BB%A3%E7%A0%81%E6%9B%B4%E5%B9%B2%E5%87%80%E6%9B%B4%E6%98%93%E7%BB%B4%E6%8A%A4/","excerpt":"PHPMD - PHP Mess Detector ç­‰ä»·äºŽjavaå·¥å…·PMDï¼Œèƒ½å¤Ÿå¯¹php æºä»£ç è¿›è¡Œå¦‚ä¸‹é—®é¢˜æ£€æµ‹ï¼š å¯èƒ½çš„bug æ¬ ä½³çš„ä»£ç  è¿‡äºŽå¤æ‚çš„è¡¨è¾¾å¼ æœªä½¿ç”¨çš„æ–¹æ³•ã€å˜é‡ã€å‚æ•°ã€å±žæ€§ æœ€æ–°ç‰ˆæœ¬å‘å¸ƒäºŽ 2021/05/11","text":"PHPMD - PHP Mess Detector ç­‰ä»·äºŽjavaå·¥å…·PMDï¼Œèƒ½å¤Ÿå¯¹php æºä»£ç è¿›è¡Œå¦‚ä¸‹é—®é¢˜æ£€æµ‹ï¼š å¯èƒ½çš„bug æ¬ ä½³çš„ä»£ç  è¿‡äºŽå¤æ‚çš„è¡¨è¾¾å¼ æœªä½¿ç”¨çš„æ–¹æ³•ã€å˜é‡ã€å‚æ•°ã€å±žæ€§ æœ€æ–°ç‰ˆæœ¬å‘å¸ƒäºŽ 2021/05/11 https://phpmd.org/about.html åŸºæœ¬ä½¿ç”¨phpmd /path/to/source text codesize ç¬¬ä¸€ä¸ªå‚æ•° è¦æ£€æµ‹çš„ä»£ç åœ°å€ ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šè¾“å‡ºæ£€æµ‹ç»“æžœçš„æ ¼å¼ ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯æŒ‡å®šçš„è§„åˆ™é›† è§„åˆ™é›†åˆ Clean Code: ä¸€äº›åŒ…å«clean codeçš„è§„åˆ™é›†åˆï¼ŒåŒ…æ‹¬é¢å‘å¯¹è±¡è®¾è®¡çš„ SOLIDï¼ˆå•ä¸€åŠŸèƒ½ã€å¼€é—­åŽŸåˆ™ã€é‡Œæ°æ›¿æ¢ã€æŽ¥å£éš”ç¦»ä»¥åŠä¾èµ–åè½¬ï¼‰åŽŸåˆ™ã€‚ Code Size : æœ‰å…³ä»£ç å¤§å°çš„ç›¸å…³é—®é¢˜ï¼Œä¾‹å¦‚è¡Œæ•°ç­‰ Controversial : å…·æœ‰äº‰è®®çš„è§„åˆ™ï¼Œå¯ä»¥ä¸å‚è€ƒæ­¤è§„åˆ™ Design ï¼š è®¾è®¡è§„åˆ™ï¼ŒåŒ…å«ç±»ä¾èµ–æ•°é‡ç­‰ç­‰ Naming: å‘½åè§„åˆ™ Unused Code: æœªä½¿ç”¨ä»£ç è§„åˆ™ å…³äºŽclean code æœ‰ä¸€æœ¬ä¹¦åå°±å« &lt;&lt; Clean Code &gt;&gt;,ä¸ªäººè¯»ä¸‹æ¥æ„Ÿå—é¢‡æ·±ã€‚ è¿™é‡Œä¸»è¦ä»‹ç»ä¸€äº›æˆ‘è®¤ä¸ºéžå¸¸æœ‰å¿…è¦æ³¨æ„çš„è§„åˆ™ Clean CodeBooleanArgumentFlagå¸ƒå°”æ ‡å¿—å‚æ•°è¿åå•ä¸€è´£ä»»åŽŸåˆ™ï¼ˆSRPï¼‰,å¯ä»¥å°†æ­¤ç±»æ–¹æ³•ä¸€æ‹†ä¸ºäºŒã€‚ class Foo &#123; public function drink($thirsty &#x3D; true) &#123; if($thirsty)&#123; &#x2F;&#x2F; å–2æ¯ &#125;else&#123; &#x2F;&#x2F; å–ä¸€æ¯ &#125; &#125; &#125; class Foo &#123; public function drinkThirsty() &#123; // å–2æ¯ &#125; public function drinkUnThirsty() &#123; // å–2æ¯ &#125; &#125; ElseExpressionclass Foo &#123; public function bar($flag) &#123; if ($flag) &#123; // one branch &#125; else &#123; // another branch &#125; &#125; &#125; åƒè¿™æ ·çš„if elseçš„è¡¨è¾¾å¼å…¶å®žæ˜¯æ²¡å¿…è¦çš„ï¼Œå¯é€šè¿‡ä¸‰å…ƒè¡¨è¾¾å¼ã€æ‹†åˆ†æ–¹æ³•æˆ–è€…å¯èƒ½çš„æƒ…å†µä¸‹å…ˆreturnæ¥è§„é¿è¿™ç±»é—®é¢˜ï¼Œä»¥å°†ä»£ç ç®€å•æˆ–å¢žåŠ å¯è¯»æ€§ã€‚ class Foo &#123; public function bar($flag) &#123; if ($flag) &#123; // one branch return &#125; // another branch &#125; &#125; Code SizeCyclomaticComplexityåœˆå¤æ‚åº¦ï¼Œç”¨æ¥è¡¡é‡ä»£ç å¤æ‚åº¦çš„ä¸€ä¸ªè®¡ç®—è§„åˆ™ã€‚å¤æ‚åº¦è¶Šé«˜ä»£è¡¨ä»£ç å¯è¯»æ€§ã€å¯ç»´æŠ¤æ€§è¶Šå·®ï¼Œæ˜“é”™æ€§æ›´é«˜ã€é›†æˆæµ‹è¯•æ›´éš¾ã€‚ ç‚¹è¾¹è®¡ç®—æ³• ä¸Šè¿°è¡¨è¾¾å¼çš„åœˆå¤æ‚åº¦ä¸º e = 10 n = 8 Cyclomatic Complexity = 10 - 8 + 2 = 4 è®¡ç®—å…¬å¼ä¸ºï¼š V(G) = E - N + 2 å…¶ä¸­ï¼Œeè¡¨ç¤ºæŽ§åˆ¶æµå›¾ä¸­è¾¹çš„æ•°é‡ï¼Œnè¡¨ç¤ºæŽ§åˆ¶æµå›¾ä¸­èŠ‚ç‚¹çš„æ•°é‡ã€‚ æ›´å¤šå¯å‚è€ƒ http://kaelzhang81.github.io/2017/06/18/è¯¦è§£åœˆå¤æ‚åº¦/ ExcessiveMethodLengthæ–¹æ³•é•¿åº¦ï¼Œè¯¥è§„åˆ™æœ‰2ä¸ªå±žæ€§ minimum æœ€å°é™å®šå€¼ é»˜è®¤ 100 ignore-whitespace æ˜¯å¦å¿½ç•¥ç©ºç™½è¡Œ é»˜è®¤ false ExcessiveClassLengthç±»é•¿åº¦ minimum æœ€å°é™å®šå€¼ é»˜è®¤ 1000 ignore-whitespace æ˜¯å¦å¿½ç•¥ç©ºç™½è¡Œ é»˜è®¤ false ExcessiveParameterListå‚æ•°ä¸ªæ•°é™å®š minimum 10ï¼Œæ ¹æ®ã€Šclean codeã€‹ä¸€ä¹¦çš„è¯´æ³•ï¼Œè¿™ä¸ªå€¼åº”è¯¥é™å®šä¸º3 ExcessivePublicCountå…¬å…±æ–¹æ³•ã€å…¬å…±å±žæ€§ minimum 45 TooManyFieldsmaxfields 15 TooManyMethodsmaxmethods 25ignorepattern (^(set|get))i TooManyPublicMethodsmaxmethods 10 The method count reporting thresholdignorepattern (^(set|get))i è‡ªå®šä¹‰è§„åˆ™æœ‰çš„é»˜è®¤è§„åˆ™ä¹Ÿè®¸å¹¶ä¸èƒ½æ»¡è¶³è‡ªèº«éœ€æ±‚éœ€åšèˆå¼ƒæˆ–ä¿®æ”¹ã€‚ä¾‹å¦‚å‡½æ•°å‚æ•°æ•°ï¼Œåœ¨ã€Šclean codeã€‹ä¸€ä¹¦ä¸­å®šä¹‰çš„æ˜¯æœ€å¤šä¸º3ï¼Œè€Œphpmdé»˜è®¤æŒ‡å®šçš„æ˜¯10. 10ä¸ªç¡®å®žå·²ç»éžå¸¸éš¾çœ‹äº†ï¼Œæƒ³è±¡ä½ åŽ»è°ƒç”¨ä¸€ä¸ªæœ‰10ä¸ªå‚æ•°çš„å‡½æ•°ï¼Œä½ ä¸€å®šä¼šåæ§½æ‡µé€¼çš„ã€‚ å¥½åœ¨phpmdè¿™äº›éƒ½å¯ä»¥ä¿®æ”¹ï¼Œå¦‚ä¸‹ï¼š å¼•å…¥unusedcodeè§„åˆ™é›† å¼•å…¥codesize,å¹¶æš‚æ—¶æŽ’é™¤NPathComplexityå’ŒCyclomaticComplexityè¿™ä¸¤ä¸ªç†è§£èµ·æ¥æœ‰ä¸€å®šå›°éš¾çš„è§„åˆ™ã€‚è¯šç„¶CyclomaticComplexityåœ¨åº¦é‡å¤æ‚åº¦ååˆ†æœ‰æ•ˆï¼Œä½†è‹¥ä½ çš„æ‰€æœ‰å‡½æ•°å·²ç»æ»¡è¶³ExcessiveMethodLengthå·²ç»è¿›æ­¥å¾ˆå¤§äº†ï¼Œæ‰€ä»¥ä¸€æ­¥æ­¥æ¥ã€‚ ä¿®æ”¹ExcessiveParameterList,è®©é™å®šå€¼ä¸º3. ä¿®æ”¹ExcessiveMethodLengthå’ŒExcessiveClassLength,å¿½ç•¥ç©ºç™½è¡Œ æŽ’é™¤StaticAccessè§„åˆ™ &lt;?xml version=\"1.0\"?> &lt;ruleset name=\"My first PHPMD rule set\" xmlns=\"http://pmd.sf.net/ruleset/1.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://pmd.sf.net/ruleset/1.0.0 http://pmd.sf.net/ruleset_xml_schema.xsd\" xsi:noNamespaceSchemaLocation=\" http://pmd.sf.net/ruleset_xml_schema.xsd\"> &lt;description> My custom rule set that checks my code... &lt;/description> &lt;rule ref=\"rulesets/unusedcode.xml\" /> &lt;rule ref=\"rulesets/codesize.xml\"> &lt;exclude name=\"ExcessiveParameterList\" /> &lt;exclude name=\"NPathComplexity\"/> &lt;exclude name=\"CyclomaticComplexity\"/> &lt;/rule> &lt;rule ref=\"rulesets/codesize.xml/ExcessiveParameterList\"> &lt;properties> &lt;property name=\"minimum\"> &lt;value> 3 &lt;/value> &lt;/property> &lt;/properties> &lt;/rule> &lt;rule ref=\"rulesets/codesize.xml/ExcessiveClassLength\"> &lt;properties> &lt;property name=\"ignore-whitespace\"> &lt;value> true &lt;/value> &lt;/property> &lt;/properties> &lt;/rule> &lt;rule ref=\"rulesets/codesize.xml/ExcessiveMethodLength\"> &lt;properties> &lt;property name=\"ignore-whitespace\"> &lt;value> true &lt;/value> &lt;/property> &lt;/properties> &lt;/rule> &lt;rule ref=\"rulesets/cleancode.xml\"> &lt;exclude name=\"StaticAccess\" /> &lt;/rule> &lt;/ruleset>","categories":[],"tags":[{"name":"PHP","slug":"PHP","permalink":"http://visonforcoding.xyz/tags/PHP/"}]},{"title":"ç”¨phpunitè¿›è¡Œå•å…ƒæµ‹è¯•","slug":"php/ç”¨phpunitè¿›è¡Œå•å…ƒæµ‹è¯•","date":"2021-07-23T01:48:24.000Z","updated":"2021-10-30T02:59:33.281Z","comments":true,"path":"2021/07/23/php/ç”¨phpunitè¿›è¡Œå•å…ƒæµ‹è¯•/","link":"","permalink":"http://visonforcoding.xyz/2021/07/23/php/%E7%94%A8phpunit%E8%BF%9B%E8%A1%8C%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/","excerpt":"æœ€è¿‘è¯»äº†ä¸€æœ¬ä¹¦ã€Šclean codeã€‹ã€‚æ·±æœ‰æ„Ÿæ‚Ÿï¼Œæ„Ÿè§‰éžå¸¸æŽ¥åº•æ°”ï¼Œè®²åˆ°äº†æ—¥å¸¸ç¼–ç ä¸­çœŸæ­£é‡åˆ°çš„å›°æ‰°ã€‚å¤§è‡´æˆ‘æ€»ç»“ä¸‹å°±æ˜¯è¦åšå‡ ä»¶äº‹ï¼š é‡æž„ï¼Œå®šæœŸé‡æž„ï¼Œä¿æŒé‡æž„ clean code,ç¼–å†™æ•´æ´ã€æ˜“ç»´æŠ¤çš„ä»£ç  å•å…ƒæµ‹è¯• æœ¬ç¯‡æˆ‘ä»¬è®²ä¸‹å¦‚ä½•åˆ©ç”¨phpunitè¿›è¡Œå•å…ƒæµ‹è¯•","text":"æœ€è¿‘è¯»äº†ä¸€æœ¬ä¹¦ã€Šclean codeã€‹ã€‚æ·±æœ‰æ„Ÿæ‚Ÿï¼Œæ„Ÿè§‰éžå¸¸æŽ¥åº•æ°”ï¼Œè®²åˆ°äº†æ—¥å¸¸ç¼–ç ä¸­çœŸæ­£é‡åˆ°çš„å›°æ‰°ã€‚å¤§è‡´æˆ‘æ€»ç»“ä¸‹å°±æ˜¯è¦åšå‡ ä»¶äº‹ï¼š é‡æž„ï¼Œå®šæœŸé‡æž„ï¼Œä¿æŒé‡æž„ clean code,ç¼–å†™æ•´æ´ã€æ˜“ç»´æŠ¤çš„ä»£ç  å•å…ƒæµ‹è¯• æœ¬ç¯‡æˆ‘ä»¬è®²ä¸‹å¦‚ä½•åˆ©ç”¨phpunitè¿›è¡Œå•å…ƒæµ‹è¯• å®‰è£…è¿™é‡Œä¸»è¦è¯´æ˜Žä¸‹å®‰è£…çš„ç‰ˆæœ¬é—®é¢˜ï¼Œæœ€æ–°ç‰ˆphpunit-latestç›®å‰ä¾èµ–php7.4. ä½†æ˜¯æˆ‘ä»¬çº¿ä¸Šç‰ˆæœ¬ä»ç„¶æ˜¯php7.2,å› æ­¤æˆ‘ä»¬éœ€è¦å®‰è£…æ—§çš„ç‰ˆæœ¬. https://phpunit.de/announcements/phpunit-8.html ä»Žè¿™ä¸ªé“¾æŽ¥èƒ½æ‰¾åˆ°phpunit-8ã€‚ å®‰è£…çš„æ–¹å¼æœ‰2ç§ï¼ŒPHAR å’Œ composerï¼Œä¸¤ç§æ–¹å¼éƒ½å¯ä»¥å…¨å±€å®‰è£…ã€‚ https://phpunit.readthedocs.io/zh_CN/latest/installation.html#installation-requirements å®˜æ–¹çš„æ•™ç¨‹æ–‡æ¡£é‡Œä¸æŽ¨èè¿›è¡Œå…¨å±€å®‰è£…ã€‚ è¯·æ³¨æ„ï¼Œå¹¶ä¸æŽ¨èå…¨å±€å®‰è£… PHPUnitï¼Œæ¯”å¦‚è¯´æ”¾åœ¨ /usr/bin/phpunit æˆ– /usr/local/bin/phpunitã€‚ç›¸åï¼ŒPHPUnit åº”è¯¥ä½œä¸ºé¡¹ç›®æœ¬åœ°ä¾èµ–é¡¹è¿›è¡Œç®¡ç†ã€‚ ä½†æ˜¯æˆ‘è¿˜æ˜¯é€‰æ‹©å…¨å±€å®‰è£…ï¼Œå› ä¸ºä¸æƒ³å°†æœ¬åœ°å¤ªå¤šä¾èµ–ã€‚ ä½¿ç”¨IDEæç¤º&lt;?php declare(strict_types=1); use PHPUnit\\Framework\\TestCase; final class RedisCacheTest extends TestCase &#123; public function testSet(): void &#123; $res = \\Hll\\Cache\\Cache::set('foo', date('Y-m-d H:i:s'),10); $this->assertTrue($res); &#125; &#125; è¿™æ˜¯æˆ‘çš„ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹è„šæœ¬ï¼Œæµ‹è¯•è„šæœ¬ç±»éœ€è¦ç»§æ‰¿TestCase. ç”±äºŽæˆ‘çš„å®‰è£…æ–¹å¼å¹¶ä¸æ˜¯æœ¬åœ°é¡¹ç›®å®‰è£…ï¼Œæ‰€ä»¥åœ¨ideä¸ä¼šæç¤ºTestCaseçš„ç›¸å…³æ–¹æ³•ã€‚è¿™å¯¹äºŽæ¥è¯´æ˜¯ä¸èƒ½å®¹å¿çš„ï¼Œä¸è¿‡å¥½åœ¨IDEèƒ½é¢å¤–çš„é…ç½®å¼•å…¥é¡¹ç›®å¤–çš„æ–‡ä»¶è¿›è¡Œæç¤ºã€‚ å·¥ç¨‹ç›®å½•å†æ¥çœ‹çœ‹å·¥ç¨‹ç›®å½•ç»“æž„ åœ¨æˆ‘ç¼–å†™çš„ä¸€ä¸ªcacheç»„ä»¶åº“ä¸­ srcä½œä¸ºæºä»£ç ç›®å½• testsä½œä¸ºæµ‹è¯•ç”¨ä¾‹ç›®å½• bootstrap.phpæ˜¯phpunitçš„å¯åŠ¨åŠ è½½æ–‡ä»¶ï¼Œç”¨äºŽåšäº›å…¨å±€çš„åˆå§‹åŒ–åŠ¨ä½œï¼Œæ¯”å¦‚åŠ è½½autoload. æ‰§è¡Œæµ‹è¯•phpunit --bootstrap tests/bootstrap.php --verbose tests/case è¯¥å‘½ä»¤æ˜¯æ‰§è¡Œæµ‹è¯• tests/caseä¸‹çš„æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹æ–‡ä»¶ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥å…·ä½“åˆ°åªæ‰§è¡Œå•ä¸ªæ–‡ä»¶ã€‚ --bootstrap åŠ è½½å¯åŠ¨æ–‡ä»¶ --colors å½©è‰²è¾“å‡º --debug è¾“å‡ºè°ƒè¯•ä¿¡æ¯ï¼Œä¾‹å¦‚å½“ä¸€ä¸ªæµ‹è¯•å¼€å§‹æ‰§è¡Œæ—¶è¾“å‡ºå…¶åç§°ã€‚ --testtox ä»¥testtoxæ ¼å¼æ˜¾ç¤ºæµ‹è¯•ç»“æžœ --configurationã€-c ä»Ž XML æ–‡ä»¶ä¸­è¯»å–é…ç½®ä¿¡æ¯ã€‚ å¦‚æžœphpunit.xml æˆ– phpunit.xml.distï¼ˆæŒ‰æ­¤é¡ºåºï¼‰å­˜åœ¨äºŽå½“å‰å·¥ä½œç›®å½•å¹¶ä¸”æœªä½¿ç”¨ --configurationï¼Œå°†è‡ªåŠ¨ä»Žæ­¤æ–‡ä»¶ä¸­è¯»å–é…ç½®ã€‚","categories":[],"tags":[{"name":"php","slug":"php","permalink":"http://visonforcoding.xyz/tags/php/"}]},{"title":"å­¦ä¹ ç¼–å†™phpæ‹“å±•","slug":"php/å­¦ä¹ ç¼–å†™phpæ‹“å±•","date":"2021-07-07T07:10:27.000Z","updated":"2021-10-30T02:59:33.281Z","comments":true,"path":"2021/07/07/php/å­¦ä¹ ç¼–å†™phpæ‹“å±•/","link":"","permalink":"http://visonforcoding.xyz/2021/07/07/php/%E5%AD%A6%E4%B9%A0%E7%BC%96%E5%86%99php%E6%8B%93%E5%B1%95/","excerpt":"","text":"ç›®çš„ä¸ºä»€ä¹ˆè¦å­¦ä¹ ç¼–å†™phpæ‹“å±•ï¼Ÿ 1.ç›®å‰å¸‚é¢ä¸Šæœ‰æ•°æ®åº“æˆ–ä¸­é—´ä»¶æ— phpé©±åŠ¨2.æœ‰è‡ªå·±çš„å…¬å…±ç»„ä»¶æˆ–å‡½æ•°,è™½ç„¶å¯ä»¥ä½¿ç”¨composerï¼Œä¸ºäº†æå‡æ€§èƒ½æ›¿ä»£composeråŒ…3.ä¸ºäº†å­¦ä¹ phpå†…æ ¸åŽŸç†æˆ–å…¶ä»–æ‹“å±•çš„å†…éƒ¨å®žçŽ°åŽŸç† hello,world1.æºç ä¸‹è½½ wget https://www.php.net/distributions/php-7.2.19.tar.bz2 tar -xvf php-7.2.19.tar.bz2 2.å¢žåŠ å‡½æ•°å£°æ˜Ž vim php_vison.h # åœ¨å…¶ä¸­å¢žåŠ  PHP_FUNCTION(vison_print); vim vison.c # å°†å¦‚ä¸‹ä»£ç ä¸­çš„PHP_FEå’ŒPHP_FE_ENDä¸­åŠ å…¥ä¸‹é¢ä»£ç ï¼ˆè¿™çš„ä»£ç æ˜¯å°†å‡½æ•°æŒ‡é’ˆæ³¨å†Œåˆ°Zendå¼•æ“Žï¼‰ PHP_FE(vison_print, NULL) 3.å‡½æ•°å®šä¹‰ vim vison.c åœ¨æœ€åŽåŠ ä¸Šåˆ›å»ºæ‰§è¡Œæ–¹æ³•vison_print PHP_FUNCTION(vison_print) &#123; php_printf(\"Hello vison!\\n\"); RETURN_TRUE; &#125; 4.ç¼–è¯‘ phpize .&#x2F;configure &amp;&amp; make &amp;&amp; make install # ç„¶åŽå°†ç”Ÿæˆçš„vison.soæ”¾å…¥é…ç½® vim &#x2F;etc&#x2F;php.ini extension&#x3D;vison.so #ç„¶åŽè¾“å…¥php -mæŸ¥çœ‹é…ç½® 4.éªŒè¯ php -r \"vison_print();\"","categories":[],"tags":[{"name":"php","slug":"php","permalink":"http://visonforcoding.xyz/tags/php/"}]},{"title":"RabbitMQä»‹ç»å’Œåœºæ™¯ä½¿ç”¨","slug":"RabbitMQä»‹ç»å’Œåœºæ™¯ä½¿ç”¨","date":"2021-06-25T01:28:32.000Z","updated":"2021-11-28T05:58:42.232Z","comments":true,"path":"2021/06/25/RabbitMQä»‹ç»å’Œåœºæ™¯ä½¿ç”¨/","link":"","permalink":"http://visonforcoding.xyz/2021/06/25/RabbitMQ%E4%BB%8B%E7%BB%8D%E5%92%8C%E5%9C%BA%E6%99%AF%E4%BD%BF%E7%94%A8/","excerpt":"å®‰è£…version: '3.1' services: rabbitmq-manger: image: rabbitmq:3-management restart: always ports: - 5672:5672 - 8091:15672 ä½¿ç”¨dockerè¿›è¡Œå¿«é€Ÿå®‰è£… åŽ†å² 2007å¹´8æœˆï¼ŒRabbitå…¬å¸å‘è¡Œäº† RabbitMQ 1.1.0. 2009å¹´8æœˆï¼ŒVMwareå‡ºèµ„4.2äº¿ç¾Žå…ƒæ”¶è´­äº†SpringSource[9]ï¼Œå¹¶åœ¨ä¸€æ®µæ—¶é—´å†…ä½œä¸ºVMwareçš„ä¸€ä¸ªç‹¬ç«‹çš„éƒ¨é—¨ï¼›å…¬å¸åŽŸæœ‰çš„å•†ä¸šäº§å“ä»¥vFabricåº”ç”¨å¥—ä»¶åä¹‰å‘å”®ã€‚ä¹‹åŽSpringSourceåˆæŽ¥è¿žæ”¶è´­äº†RabbitMQ[10]ã€Redis[11]å’ŒGemstone[12]ã€‚é™¤Rediså¤–ï¼Œå®ƒä»¬çš„äº§å“ä¹Ÿæˆä¸ºäº†vFabricåº”ç”¨å¥—ä»¶çš„ä¸€éƒ¨åˆ†ã€‚ ä½ ä¼šå‘çŽ°ä¸€ä¸ªæœ‰è¶£è€Œè¯§å¼‚çš„äº‹å®žï¼ŒVMware å’Œ Spring ã€RabbitMQã€Redisè¿™äº›å¤§åé¼Žé¼Žçš„æŠ€æœ¯æ˜¯åŒå±žä¸€å®¶å…¬å¸ã€‚è€Œ è‘—åçš„ SpringèƒŒåŽçš„SpringSourceå…¬å¸ä¸»è¦ä»¥åŸ¹è®­å’Œå’¨è¯¢ç›ˆåˆ©ã€‚","text":"å®‰è£…version: '3.1' services: rabbitmq-manger: image: rabbitmq:3-management restart: always ports: - 5672:5672 - 8091:15672 ä½¿ç”¨dockerè¿›è¡Œå¿«é€Ÿå®‰è£… åŽ†å² 2007å¹´8æœˆï¼ŒRabbitå…¬å¸å‘è¡Œäº† RabbitMQ 1.1.0. 2009å¹´8æœˆï¼ŒVMwareå‡ºèµ„4.2äº¿ç¾Žå…ƒæ”¶è´­äº†SpringSource[9]ï¼Œå¹¶åœ¨ä¸€æ®µæ—¶é—´å†…ä½œä¸ºVMwareçš„ä¸€ä¸ªç‹¬ç«‹çš„éƒ¨é—¨ï¼›å…¬å¸åŽŸæœ‰çš„å•†ä¸šäº§å“ä»¥vFabricåº”ç”¨å¥—ä»¶åä¹‰å‘å”®ã€‚ä¹‹åŽSpringSourceåˆæŽ¥è¿žæ”¶è´­äº†RabbitMQ[10]ã€Redis[11]å’ŒGemstone[12]ã€‚é™¤Rediså¤–ï¼Œå®ƒä»¬çš„äº§å“ä¹Ÿæˆä¸ºäº†vFabricåº”ç”¨å¥—ä»¶çš„ä¸€éƒ¨åˆ†ã€‚ ä½ ä¼šå‘çŽ°ä¸€ä¸ªæœ‰è¶£è€Œè¯§å¼‚çš„äº‹å®žï¼ŒVMware å’Œ Spring ã€RabbitMQã€Redisè¿™äº›å¤§åé¼Žé¼Žçš„æŠ€æœ¯æ˜¯åŒå±žä¸€å®¶å…¬å¸ã€‚è€Œ è‘—åçš„ SpringèƒŒåŽçš„SpringSourceå…¬å¸ä¸»è¦ä»¥åŸ¹è®­å’Œå’¨è¯¢ç›ˆåˆ©ã€‚ æ¦‚å¿µ RabbitMQ is a message broker: it accepts and forwards messages. You can think about it as a post office: when you put the mail that you want posting in a post box, you can be sure that Mr. or Ms. Mailperson will eventually deliver the mail to your recipient. In this analogy, RabbitMQ is a post box, a post office and a postman. è¿™æ˜¯å®˜ç½‘æœ€å¼€å¤´çš„ä¸€æ®µä»‹ç»,è¿™é‡Œå°†RabbitMQç±»æ¯”ä¸ºé‚®å±€æ´¾ä¿¡åœºæ™¯ï¼ŒRabbitMQæ‰®æ¼”é‚®ç®±ã€é‚®å±€ã€é‚®å·®çš„è§’è‰²ã€‚è¿™é‡Œä¹Ÿçœ‹åˆ°äº† broker è¿™ä¸ªå•è¯ï¼ŒKafkaä¹Ÿæœ‰brokerè¿™ä¸ªæ¦‚å¿µï¼Œè¿™é‡Œæˆ‘ä»¬æš‚ä¸”å°†å®ƒç†è§£ä¸ºä»£ç†çš„æ„æ€ã€‚ ç”Ÿäº§è€… producerç®€å•ç†è§£å°±æ˜¯å‘é€æ¶ˆæ¯çš„ç¨‹åº æ¶ˆè´¹è€… consumer é˜Ÿåˆ— queue æ¶ˆæ¯å­˜å‚¨äºŽqueueå½“ä¸­ï¼Œå¤šä¸ªproducer å¯å¾€ä¸€ä¸ª queueå‘é€æ¶ˆæ¯ äº¤æ¢æœº Exchange äº¤æ¢æœºæ˜¯ç”¨æ¥å‘é€æ¶ˆæ¯çš„AMQPå®žä½“ã€‚äº¤æ¢æœºæ‹¿åˆ°ä¸€ä¸ªæ¶ˆæ¯ä¹‹åŽå°†å®ƒè·¯ç”±ç»™ä¸€ä¸ªæˆ–é›¶ä¸ªé˜Ÿåˆ—ã€‚å®ƒä½¿ç”¨å“ªç§è·¯ç”±ç®—æ³•æ˜¯ç”±äº¤æ¢æœºç±»åž‹å’Œè¢«ç§°ä½œç»‘å®šï¼ˆbindingsï¼‰çš„è§„åˆ™æ‰€å†³å®šçš„(è¿™ä¸ªåŽé¢ä¼šè®²åˆ°)ã€‚ Exchange Type direct ç›´è¿ž fanout æ‰‡å‡º topic ä¸»é¢˜ headers å¤´ é™¤äº¤æ¢æœºç±»åž‹å¤–ï¼Œåœ¨å£°æ˜Žäº¤æ¢æœºæ—¶è¿˜å¯ä»¥é™„å¸¦è®¸å¤šå…¶ä»–çš„å±žæ€§ï¼Œå…¶ä¸­æœ€é‡è¦çš„å‡ ä¸ªåˆ†åˆ«æ˜¯ï¼š Name Durability ï¼ˆæ¶ˆæ¯ä»£ç†é‡å¯åŽï¼Œäº¤æ¢æœºæ˜¯å¦è¿˜å­˜åœ¨ï¼‰ Auto-delete ï¼ˆå½“æ‰€æœ‰ä¸Žä¹‹ç»‘å®šçš„æ¶ˆæ¯é˜Ÿåˆ—éƒ½å®Œæˆäº†å¯¹æ­¤äº¤æ¢æœºçš„ä½¿ç”¨åŽï¼Œåˆ æŽ‰å®ƒï¼‰ Argumentsï¼ˆä¾èµ–ä»£ç†æœ¬èº«ï¼‰ public function exchange_declare( $exchange, $type, $passive = false, $durable = false, $auto_delete = true, $internal = false, $nowait = false, $arguments = array(), $ticket = null ) æŒä¹…ï¼ˆdurableï¼‰ã€æš‚å­˜ï¼ˆtransientï¼‰ã€‚æŒä¹…åŒ–çš„äº¤æ¢æœºä¼šåœ¨æ¶ˆæ¯ä»£ç†ï¼ˆbrokerï¼‰é‡å¯åŽä¾æ—§å­˜åœ¨ï¼Œè€Œæš‚å­˜çš„äº¤æ¢æœºåˆ™ä¸ä¼šï¼ˆå®ƒä»¬éœ€è¦åœ¨ä»£ç†å†æ¬¡ä¸Šçº¿åŽé‡æ–°è¢«å£°æ˜Žï¼‰ã€‚ç„¶è€Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„åº”ç”¨åœºæ™¯éƒ½éœ€è¦æŒä¹…åŒ–çš„äº¤æ¢æœºã€‚ é»˜è®¤äº¤æ¢æœº é‚£å°±æ˜¯æ¯ä¸ªæ–°å»ºé˜Ÿåˆ—ï¼ˆqueueï¼‰éƒ½ä¼šè‡ªåŠ¨ç»‘å®šåˆ°é»˜è®¤äº¤æ¢æœºä¸Šï¼Œç»‘å®šçš„è·¯ç”±é”®ï¼ˆrouting keyï¼‰åç§°ä¸Žé˜Ÿåˆ—åç§°ç›¸åŒã€‚ ç›´è¿žäº¤æ¢æœº Direct $channel->queue_bind('hello_queue', 'hello_exchange', 'hello_key'); å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼š å°†ä¸€ä¸ªé˜Ÿåˆ—ç»‘å®šåˆ°æŸä¸ªäº¤æ¢æœºä¸Šï¼ŒåŒæ—¶èµ‹äºˆè¯¥ç»‘å®šä¸€ä¸ªè·¯ç”±é”®ï¼ˆrouting keyï¼‰ å½“ä¸€ä¸ªæºå¸¦ç€è·¯ç”±é”®ä¸ºhello_keyçš„æ¶ˆæ¯è¢«å‘é€ç»™ç›´è¿žäº¤æ¢æœºhello_exchangeæ—¶ï¼Œäº¤æ¢æœºä¼šæŠŠå®ƒè·¯ç”±ç»™hello_queueçš„é˜Ÿåˆ—ã€‚ $channel->basic_publish($msg, 'hello_exchange', 'hello_key'); æ‰‡å½¢äº¤æ¢æœº fanout æ‰‡åž‹äº¤æ¢æœºï¼ˆfunout exchangeï¼‰å°†æ¶ˆæ¯è·¯ç”±ç»™ç»‘å®šåˆ°å®ƒèº«ä¸Šçš„æ‰€æœ‰é˜Ÿåˆ—ï¼Œè€Œä¸ç†ä¼šç»‘å®šçš„è·¯ç”±é”®ã€‚ å¦‚æžœNä¸ªé˜Ÿåˆ—ç»‘å®šåˆ°æŸä¸ªæ‰‡åž‹äº¤æ¢æœºä¸Šï¼Œå½“æœ‰æ¶ˆæ¯å‘é€ç»™æ­¤æ‰‡åž‹äº¤æ¢æœºæ—¶ï¼Œäº¤æ¢æœºä¼šå°†æ¶ˆæ¯çš„æ‹·è´åˆ†åˆ«å‘é€ç»™è¿™æ‰€æœ‰çš„Nä¸ªé˜Ÿåˆ—ã€‚ // RabbitFanoutProduce.php $faker = Factory::create('zh_CN'); $connection = new AMQPStreamConnection('192.168.106.179', 5672, 'guest', 'guest'); // åˆ›å»ºé€šé“ $channel = $connection->channel(); $channel->exchange_declare('test.fanout', AMQPExchangeType::FANOUT, false, false, false); $body = $faker->text(20); $msg = new AMQPMessage($body, ['delivery_mode' => AMQPMessage::DELIVERY_MODE_PERSISTENT]); $channel->basic_publish($msg, 'test.fanout'); RabbitFanoutProduce ç”Ÿäº§è€…å®šä¹‰äº†ä¸€ä¸ªtest.fanout äº¤æ¢æœºç±»åž‹æ˜¯AMQPExchangeType::FANOUT // lmsConsoumer.php $connection = new AMQPStreamConnection('192.168.106.179', 5672, 'guest', 'guest'); // åˆ›å»ºé€šé“ $channel = $connection->channel(); $channel->queue_declare('test.lms', false, false, false); $channel->queue_bind('test.lms', 'test.fanout'); $callback = function ($msg) &#123; echo ' [x] ', $msg->body, \"\\n\"; &#125;; $channel->basic_consume('test.lms', '', false, true, false, false, $callback); while ($channel->is_open()) &#123; $channel->wait(); &#125; lmsConsoumer è®¢é˜…äº†ä¸€ä¸ªtest.lmsçš„é˜Ÿåˆ—å¹¶ç»‘å®šåˆ°test.fanoutäº¤æ¢æœº // omsConsoumer.php $connection = new AMQPStreamConnection('192.168.106.179', 5672, 'guest', 'guest'); // åˆ›å»ºé€šé“ $channel = $connection->channel(); $channel->queue_declare('test.oms', false, false, false,false); $channel->queue_bind('test.oms', 'test.fanout'); $callback = function ($msg) &#123; echo ' [x] ', $msg->body, \"\\n\"; &#125;; $channel->basic_consume('test.oms', '', false, true, false, false, $callback); while ($channel->is_open()) &#123; $channel->wait(); &#125; omsConsoumer è®¢é˜…äº†ä¸€ä¸ªtest.omsçš„é˜Ÿåˆ—å¹¶ç»‘å®šåˆ°test.fanoutäº¤æ¢æœº ç¤ºä¾‹ä¸­æ¼”ç¤ºäº†ï¼Œä¸€ä¸ªç”Ÿäº§è€…ç”Ÿäº§æ¶ˆæ¯ç»™2ä¸ªç³»ç»Ÿè®¢é˜…æ¶ˆè´¹ã€‚ Fanout å…¸åž‹çš„ä¸€ä¸ªåº”ç”¨åœºæ™¯æ˜¯å¤šä¸ªåº”ç”¨ç³»ç»Ÿè®¢é˜…ä¸€ä¸ªæ¶ˆæ¯äº‹ä»¶ã€‚ egï¼š å®¢æœç³»ç»Ÿã€è¿è¥ç³»ç»Ÿã€è´¢åŠ¡ç³»ç»ŸåŒæ—¶è®¢é˜…è®¢å•ç³»ç»Ÿçš„è®¢å•çŠ¶æ€å˜æ›´äº‹ä»¶ã€‚ è¿™æ ·ä¸åŒç³»ç»Ÿéƒ½èƒ½å„è‡ªä½¿ç”¨å„è‡ªçš„é˜Ÿåˆ—å¤„ç†è®¢å•çš„å˜æ›´ä¸šåŠ¡é€»è¾‘ã€‚ ç»†åŒ–ä¸‹åœºæ™¯ä¸¾ä¸ªä¾‹å­ï¼š å½“è®¢å•å®Œç»“ order close: å®¢æœç³»ç»Ÿéœ€è¦ç»™å®¢æˆ·å‘é€ä¸€ä¸ªå®¢æˆ·æ»¡æ„åº¦è°ƒæŸ¥ è¿è¥ç³»ç»Ÿéœ€è¦å‘é€ä¸€å¼ æŒ‰è®¢å•æ¶ˆè´¹é‡‘é¢é…æ¯”çš„ä¼˜æƒ åˆ¸ è´¢åŠ¡ç³»ç»Ÿéœ€è¦è®¡ç®—è¿™ç¬”è®¢å•çš„å…¥è´¦ ä¸»é¢˜äº¤æ¢æœº topic ä¸»é¢˜äº¤æ¢æœºï¼ˆtopic exchangesï¼‰é€šè¿‡å¯¹æ¶ˆæ¯çš„è·¯ç”±é”®å’Œé˜Ÿåˆ—åˆ°äº¤æ¢æœºçš„ç»‘å®šæ¨¡å¼ä¹‹é—´çš„åŒ¹é…ï¼Œå°†æ¶ˆæ¯è·¯ç”±ç»™ä¸€ä¸ªæˆ–å¤šä¸ªé˜Ÿåˆ—ã€‚ topicæœ‰ç‚¹ç±»ä¼¼ directå’Œfanoutçš„ç»“åˆä½“ï¼Œå³å¯ä»¥å¹¿æ’­åˆå¯ä»¥æŒ‰ä¸€å®šè§„åˆ™æŒ‡å®š route. ä¸Šé¢ç¤ºä¾‹å›¾æ¡ˆä¾‹ï¼š è¿™æ˜¯ä¸€ä¸ªå…³äºŽåŠ¨ç‰©çš„æ¶ˆæ¯æ¶ˆè´¹ç¨‹åº æœ‰å…³orangeçš„åŠ¨ç‰©å°†è¿›å…¥Q1 ï¼Œä¾‹å¦‚ fast.orange.pig å¿«é€Ÿçš„æ©™è‰²çŒª æœ‰å…³ rabbit å’Œ lazy çš„åŠ¨ç‰©å°†è¿›å…¥ Q2 ï¼Œä¾‹å¦‚ lazy.green.rabbit æˆ– lazy.yellow.monkey å¦‚æžœåŒ¹é…å¤šä¸ªæ¨¡å¼åˆ™è¿›å…¥å¤šä¸ªç›¸åº”çš„é˜Ÿåˆ—ï¼Œä¾‹å¦‚ lazy.orange.monkey åˆ™ä¼šè¿›å…¥Q1å’ŒQ2 $faker = Factory::create('zh_CN'); $connection = new AMQPStreamConnection('192.168.106.179', 5672, 'guest', 'guest'); // åˆ›å»ºé€šé“ $channel = $connection->channel(); $channel->exchange_declare('test.topic', AMQPExchangeType::TOPIC, false, false, false); $channel->queue_declare('Q1'); $channel->queue_declare('Q2'); $channel->queue_bind('Q1', 'test.topic', '*.orange.*'); $channel->queue_bind('Q2', 'test.topic', '*.*.rabbit'); $channel->queue_bind('Q2', 'test.topic', 'lazy.#'); $body = $faker->name(); $msg = new AMQPMessage($body, ['delivery_mode' => AMQPMessage::DELIVERY_MODE_PERSISTENT]); $channel->basic_publish($msg, 'test.topic', 'fast.orange.pig'); $channel->basic_publish($msg, 'test.topic', 'lazy.green.rabbit'); $channel->basic_publish($msg, 'test.topic', 'lazy.orange.monkey'); å¯ä»¥çœ‹åˆ°3ä¸ªæ¶ˆæ¯ï¼Œå‘é€åˆ°äº†2ä¸ªé˜Ÿåˆ—ã€‚Q1å’ŒQ2å„æœ‰2ä¸ªï¼Œå› ä¸ºlazy.orange.monkeyè¿›å…¥äº†2ä¸ªé˜Ÿåˆ—ã€‚ å¤´äº¤æ¢æœº header æœ‰æ—¶æ¶ˆæ¯çš„è·¯ç”±æ“ä½œä¼šæ¶‰åŠåˆ°å¤šä¸ªå±žæ€§ï¼Œæ­¤æ—¶ä½¿ç”¨æ¶ˆæ¯å¤´å°±æ¯”ç”¨è·¯ç”±é”®æ›´å®¹æ˜“è¡¨è¾¾ï¼Œå¤´äº¤æ¢æœºï¼ˆheaders exchangeï¼‰å°±æ˜¯ä¸ºæ­¤è€Œç”Ÿçš„ã€‚å¤´äº¤æ¢æœºä½¿ç”¨å¤šä¸ªæ¶ˆæ¯å±žæ€§æ¥ä»£æ›¿è·¯ç”±é”®å»ºç«‹è·¯ç”±è§„åˆ™ã€‚é€šè¿‡åˆ¤æ–­æ¶ˆæ¯å¤´çš„å€¼èƒ½å¦ä¸ŽæŒ‡å®šçš„ç»‘å®šç›¸åŒ¹é…æ¥ç¡®ç«‹è·¯ç”±è§„åˆ™ã€‚ å®ƒæä¾›æ›´å¤šçš„åŒ¹é…ï¼Œå¯è®¾ç½®x-match ä¸ºany æˆ–all æ¥æŽ§åˆ¶æ˜¯ä»»æ„åŒ¹é…è¿˜æ˜¯å…¨éƒ¨åŒ¹é…ã€‚ é˜Ÿåˆ— queueAMQPä¸­çš„é˜Ÿåˆ—ï¼ˆqueueï¼‰è·Ÿå…¶ä»–æ¶ˆæ¯é˜Ÿåˆ—æˆ–ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„é˜Ÿåˆ—æ˜¯å¾ˆç›¸ä¼¼çš„ï¼šå®ƒä»¬å­˜å‚¨ç€å³å°†è¢«åº”ç”¨æ¶ˆè´¹æŽ‰çš„æ¶ˆæ¯ã€‚é˜Ÿåˆ—è·Ÿäº¤æ¢æœºå…±äº«æŸäº›å±žæ€§ï¼Œä½†æ˜¯é˜Ÿåˆ—ä¹Ÿæœ‰ä¸€äº›å¦å¤–çš„å±žæ€§ã€‚ Name Durableï¼ˆæ¶ˆæ¯ä»£ç†é‡å¯åŽï¼Œé˜Ÿåˆ—ä¾æ—§å­˜åœ¨ï¼‰ Exclusiveï¼ˆåªè¢«ä¸€ä¸ªè¿žæŽ¥ï¼ˆconnectionï¼‰ä½¿ç”¨ï¼Œè€Œä¸”å½“è¿žæŽ¥å…³é—­åŽé˜Ÿåˆ—å³è¢«åˆ é™¤ï¼‰ Auto-deleteï¼ˆå½“æœ€åŽä¸€ä¸ªæ¶ˆè´¹è€…é€€è®¢åŽå³è¢«åˆ é™¤ï¼‰ Argumentsï¼ˆä¸€äº›æ¶ˆæ¯ä»£ç†ç”¨ä»–æ¥å®Œæˆç±»ä¼¼ä¸ŽTTLçš„æŸäº›é¢å¤–åŠŸèƒ½ï¼‰ æ¶ˆæ¯ç¡®è®¤æ¶ˆè´¹è€…åº”ç”¨ï¼ˆConsumer applicationsï¼‰ - ç”¨æ¥æŽ¥å—å’Œå¤„ç†æ¶ˆæ¯çš„åº”ç”¨ - åœ¨å¤„ç†æ¶ˆæ¯çš„æ—¶å€™å¶å°”ä¼šå¤±è´¥æˆ–è€…æœ‰æ—¶ä¼šç›´æŽ¥å´©æºƒæŽ‰ã€‚è€Œä¸”ç½‘ç»œåŽŸå› ä¹Ÿæœ‰å¯èƒ½å¼•èµ·å„ç§é—®é¢˜ã€‚è¿™å°±ç»™æˆ‘ä»¬å‡ºäº†ä¸ªéš¾é¢˜ï¼ŒAMQPä»£ç†åœ¨ä»€ä¹ˆæ—¶å€™åˆ é™¤æ¶ˆæ¯æ‰æ˜¯æ­£ç¡®çš„ï¼ŸAMQP 0-9-1 è§„èŒƒç»™æˆ‘ä»¬ä¸¤ç§å»ºè®®ï¼š å½“æ¶ˆæ¯ä»£ç†ï¼ˆbrokerï¼‰å°†æ¶ˆæ¯å‘é€ç»™åº”ç”¨åŽç«‹å³åˆ é™¤ã€‚ï¼ˆä½¿ç”¨AMQPæ–¹æ³•ï¼šbasic.deliveræˆ–basic.get-okï¼‰ å¾…åº”ç”¨ï¼ˆapplicationï¼‰å‘é€ä¸€ä¸ªç¡®è®¤å›žæ‰§ï¼ˆacknowledgementï¼‰åŽå†åˆ é™¤æ¶ˆæ¯ã€‚ï¼ˆä½¿ç”¨AMQPæ–¹æ³•ï¼šbasic.ackï¼‰ å‰è€…è¢«ç§°ä½œè‡ªåŠ¨ç¡®è®¤æ¨¡å¼ï¼ˆautomatic acknowledgement modelï¼‰ï¼ŒåŽè€…è¢«ç§°ä½œæ˜¾å¼ç¡®è®¤æ¨¡å¼ï¼ˆexplicit acknowledgement model)ã€‚ $callback = function ($msg) &#123; echo ' [x] Received ', $msg->body, \"\\n\"; sleep(substr_count($msg->body, '.')); echo \" [x] Done\\n\"; $msg->ack(); &#125;; $channel->basic_consume('task_queue', '', false, false, false, false, $callback); ä»¥ä¸Šä»£ç ç¤ºä¾‹å±•ç¤ºackä½¿ç”¨ï¼Œbasic_consumeçš„ç¬¬4ä¸ªå‚æ•°è¦ è®¾ç½®ä¸ºtrueã€‚ æ‹’ç»æ¶ˆæ¯å½“ä¸€ä¸ªæ¶ˆè´¹è€…æŽ¥æ”¶åˆ°æŸæ¡æ¶ˆæ¯åŽï¼Œå¤„ç†è¿‡ç¨‹æœ‰å¯èƒ½æˆåŠŸï¼Œæœ‰å¯èƒ½å¤±è´¥ã€‚åº”ç”¨å¯ä»¥å‘æ¶ˆæ¯ä»£ç†è¡¨æ˜Žï¼Œæœ¬æ¡æ¶ˆæ¯ç”±äºŽâ€œæ‹’ç»æ¶ˆæ¯ï¼ˆRejecting Messagesï¼‰â€çš„åŽŸå› å¤„ç†å¤±è´¥äº†ï¼ˆæˆ–è€…æœªèƒ½åœ¨æ­¤æ—¶å®Œæˆï¼‰ã€‚å½“æ‹’ç»æŸæ¡æ¶ˆæ¯æ—¶ï¼Œåº”ç”¨å¯ä»¥å‘Šè¯‰æ¶ˆæ¯ä»£ç†å¦‚ä½•å¤„ç†è¿™æ¡æ¶ˆæ¯â€”â€”é”€æ¯å®ƒæˆ–è€…é‡æ–°æ”¾å…¥é˜Ÿåˆ—ã€‚å½“æ­¤é˜Ÿåˆ—åªæœ‰ä¸€ä¸ªæ¶ˆè´¹è€…æ—¶ï¼Œè¯·ç¡®è®¤ä¸è¦ç”±äºŽæ‹’ç»æ¶ˆæ¯å¹¶ä¸”é€‰æ‹©äº†é‡æ–°æ”¾å…¥é˜Ÿåˆ—çš„è¡Œä¸ºè€Œå¼•èµ·æ¶ˆæ¯åœ¨åŒä¸€ä¸ªæ¶ˆè´¹è€…èº«ä¸Šæ— é™å¾ªçŽ¯çš„æƒ…å†µå‘ç”Ÿã€‚ è¿žæŽ¥AMQPè¿žæŽ¥é€šå¸¸æ˜¯é•¿è¿žæŽ¥ã€‚AMQPæ˜¯ä¸€ä¸ªä½¿ç”¨TCPæä¾›å¯é æŠ•é€’çš„åº”ç”¨å±‚åè®®ã€‚AMQPä½¿ç”¨è®¤è¯æœºåˆ¶å¹¶ä¸”æä¾›TLSï¼ˆSSLï¼‰ä¿æŠ¤ã€‚å½“ä¸€ä¸ªåº”ç”¨ä¸å†éœ€è¦è¿žæŽ¥åˆ°AMQPä»£ç†çš„æ—¶å€™ï¼Œéœ€è¦ä¼˜é›…çš„é‡Šæ”¾æŽ‰AMQPè¿žæŽ¥ï¼Œè€Œä¸æ˜¯ç›´æŽ¥å°†TCPè¿žæŽ¥å…³é—­ã€‚ è™šæ‹Ÿä¸»æœº vhostä¸ºäº†åœ¨ä¸€ä¸ªå•ç‹¬çš„ä»£ç†ä¸Šå®žçŽ°å¤šä¸ªéš”ç¦»çš„çŽ¯å¢ƒï¼ˆç”¨æˆ·ã€ç”¨æˆ·ç»„ã€äº¤æ¢æœºã€é˜Ÿåˆ— ç­‰ï¼‰ï¼ŒAMQPæä¾›äº†ä¸€ä¸ªè™šæ‹Ÿä¸»æœºï¼ˆvirtual hosts - vhostsï¼‰çš„æ¦‚å¿µã€‚è¿™è·ŸWeb serversè™šæ‹Ÿä¸»æœºæ¦‚å¿µéžå¸¸ç›¸ä¼¼ï¼Œè¿™ä¸ºAMQPå®žä½“æä¾›äº†å®Œå…¨éš”ç¦»çš„çŽ¯å¢ƒã€‚ $connection = new AMQPStreamConnection('192.168.106.179', 5672, 'guest', 'guest','test-vhost'); åŠ¨æ€åŒ¹é…æ¨¡åž‹ç”Ÿäº§è€… protected function execute(InputInterface $input, OutputInterface $output): int &#123; $connection = new AMQPStreamConnection('192.168.106.179', 5672, 'guest', 'guest'); // åˆ›å»ºé€šé“ $channel = $connection->channel(); $channel->exchange_declare('order.lifecycle', AMQPExchangeType::TOPIC, false, false, false); //å®šä¹‰ä¸€ä¸ªé»˜è®¤ å…¨çŠ¶æ€é˜Ÿåˆ— $channel->queue_declare('order.all'); //åŒ¹é… å…¨çŠ¶æ€ è®¢å•æ¶ˆæ¯ $channel->queue_bind('order.all', 'order.lifecycle', 'order.*'); $faker = Factory::create('zh_CN'); $orderStatus = [ self::ORDER_CREATE, self::ORDER_SENDED, self::ORDER_WAIT_PAY ]; $status = $orderStatus[array_rand($orderStatus)]; $body = [ 'status' => $status, 'name' => $faker->name, 'order_no' => $faker->uuid ]; dump($body); $msg = new AMQPMessage(json_encode($body), ['delivery_mode' => AMQPMessage::DELIVERY_MODE_PERSISTENT]); //æ¶ˆæ¯ åŠ¨æ€ ç»‘å®š è·¯ç”±é”® $channel->basic_publish($msg, 'order.lifecycle','order.'.$status); return Command::SUCCESS; &#125; æ¶ˆè´¹è€… public function handPay() &#123; $connection = new AMQPStreamConnection('192.168.106.179', 5672, 'guest', 'guest'); // åˆ›å»ºé€šé“ $channel = $connection->channel(); //å®šä¹‰ h66 æ¶ˆè´¹ pay é˜Ÿåˆ— $channel->queue_declare('h66.pay'); //å°† WAIY_PAY ç±»åž‹æ¶ˆæ¯ ç»‘å®šåˆ°è¯¥é˜Ÿåˆ— $channel->queue_bind('h66.pay', 'order.lifecycle', 'order.WAIT_PAY'); $callback = function($msg) &#123; $body = json_decode($msg->body, true); $this->info(\"å¤„ç†æ•°æ®...&#123;$body['status']&#125; &#123;$body['order_no']&#125;\"); &#125;; // æ¶ˆè´¹ é˜Ÿåˆ— $channel->basic_consume('h66.pay', '', false, true, false, false, $callback); // é˜»å¡žé˜Ÿåˆ—ç›‘å¬äº‹ä»¶ while ($channel->is_open()) &#123; $channel->wait(); &#125; &#125; ä»£ç ç¤ºä¾‹ä¸­ ç”Ÿæˆè€…æ ¹æ®è®¢å•çŠ¶æ€åŠ¨æ€ç”Ÿäº§ç›¸åº”è·¯ç”±é”®æ¶ˆæ¯åˆ°äº¤æ¢æœºï¼Œæ¶ˆè´¹è€…è®¢é˜…è‡ªå·±æ‰€éœ€çš„çŠ¶æ€åˆ°è‡ªå·±çš„é˜Ÿåˆ—å½“ä¸­è¿›è¡Œæ¶ˆè´¹ã€‚ ä¾‹å¦‚ handPay æ¶ˆè´¹è€…åªè®¢é˜…å¾…æ”¯ä»˜ç±»åž‹ã€‚ å‚è€ƒ https://rabbitmq.mr-ping.com/ https://www.rabbitmq.com/getstarted.html","categories":[],"tags":[{"name":"æž¶æž„","slug":"æž¶æž„","permalink":"http://visonforcoding.xyz/tags/%E6%9E%B6%E6%9E%84/"}]},{"title":"mysqlçš„waitimeout","slug":"mysqlçš„waitimeout","date":"2021-06-02T12:33:18.000Z","updated":"2021-10-30T02:59:33.279Z","comments":true,"path":"2021/06/02/mysqlçš„waitimeout/","link":"","permalink":"http://visonforcoding.xyz/2021/06/02/mysql%E7%9A%84waitimeout/","excerpt":"é¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹ show GLOBAL VARIABLES like '%timeout%'; é»˜è®¤å€¼ä¸º28800så³8å°æ—¶,æˆ‘ä»¬æ”¹ä¸º100s # Default Homebrew MySQL server config [mysqld] # Only allow connections from localhost bind-address = 0.0.0.0 wait_timeout=100 interactive_timeout=100 é‡æ–°æŸ¥çœ‹ç»“æžœ","text":"é¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹ show GLOBAL VARIABLES like '%timeout%'; é»˜è®¤å€¼ä¸º28800så³8å°æ—¶,æˆ‘ä»¬æ”¹ä¸º100s # Default Homebrew MySQL server config [mysqld] # Only allow connections from localhost bind-address = 0.0.0.0 wait_timeout=100 interactive_timeout=100 é‡æ–°æŸ¥çœ‹ç»“æžœ æŸ¥çœ‹å¯¹å®ˆæŠ¤è¿›ç¨‹è¿žæŽ¥çš„å½±å“ public function longT() &#123; $TicketModel = new TicketModel(); $this->success('å¼€å§‹å»ºç«‹è¿žæŽ¥...'); while (true) &#123; sleep(120); dump($TicketModel->select('t_id')->fetch()); &#125; &#125; å‘çŽ°åœ¨100såŽçš„è¿žæŽ¥å·²è¢«ä¸»åŠ¨æ–­å¼€ ä»£ç ä¸­çš„åœºæ™¯æ˜¯ï¼Œåœ¨wait_timeoutä¹‹å†…æ— ä»»ä½•æ“ä½œä¼šè‡ªåŠ¨å…³é—­ å®˜æ–¹è§£é‡Šinteractive_timeout 28800 The number of seconds the server waits for activity on an interactive connection before closing it. An interactive client is defined as a client that uses the CLIENT_INTERACTIVE option to mysql_real_connect(). See also wait_timeout. waitimeout 28800 The number of seconds the server waits for activity on a noninteractive connection before closing it. On thread startup, the session wait_timeout value is initialized from the global wait_timeout value or from the global interactive_timeout value, depending on the type of client (as defined by the CLIENT_INTERACTIVE connect option to mysql_real_connect()). See also interactive_timeout. é€šè¿‡MySQLå®¢æˆ·ç«¯è¿žæŽ¥dbçš„æ˜¯äº¤äº’ä¼šè¯ï¼Œé€šè¿‡jdbcç­‰ç¨‹åºè¿žæŽ¥dbçš„æ˜¯éžäº¤äº’ä¼šè¯ã€‚ æ€»ç»“ï¼š å¦‚æžœåº”ç”¨ç¨‹åºé•¿æ—¶é—´çš„ä½¿ç”¨ä¸€ä¸ªè¿žæŽ¥ï¼Œè€Œæœ‰æœºä¼šé•¿æ—¶é—´ä¸è¿›è¡Œä»»ä½•æ“ä½œã€‚åˆ™ä¼šå¯¼è‡´è¿žæŽ¥è¢«å…³é—­ã€‚ å‚è€ƒæ–‡çŒ®: 1.https://dev.mysql.com/doc/refman/5.7/en/server-system-variables.html2.https://cloud.tencent.com/developer/article/1181515","categories":[],"tags":[{"name":"mysql","slug":"mysql","permalink":"http://visonforcoding.xyz/tags/mysql/"}]},{"title":"vue+quasar+electron+springboot+mysqlæ’¸ä¸€ä¸ªTODO LIST çœ‹æ¿","slug":"vue-quasar-electron-springboot-mysqlæ’¸ä¸€ä¸ªTODO-LIST-çœ‹æ¿","date":"2021-04-09T03:39:08.000Z","updated":"2021-10-30T02:59:33.282Z","comments":true,"path":"2021/04/09/vue-quasar-electron-springboot-mysqlæ’¸ä¸€ä¸ªTODO-LIST-çœ‹æ¿/","link":"","permalink":"http://visonforcoding.xyz/2021/04/09/vue-quasar-electron-springboot-mysql%E6%92%B8%E4%B8%80%E4%B8%AATODO-LIST-%E7%9C%8B%E6%9D%BF/","excerpt":"å…ˆçœ‹æ•ˆæžœ å†™æœ¬é¡¹ç›®çš„ç›®çš„æœ‰å‡ ç‚¹ï¼š å­¦ä¹ ä¸‹vue+electronæ¡Œé¢å¼€å‘ å­¦ä¹ ä¸‹javaå’Œspringå¼€å‘(æœ¬äººä¸€ç›´ä½¿ç”¨PHP) ä¸€ç›´ç¼ºå°‘ä¸€æ¬¾èƒ½é€‚åˆè‡ªå·±çš„TODO LISTè½¯ä»¶ï¼Œèƒ½æœ‰æ¡Œé¢ç«¯çš„","text":"å…ˆçœ‹æ•ˆæžœ å†™æœ¬é¡¹ç›®çš„ç›®çš„æœ‰å‡ ç‚¹ï¼š å­¦ä¹ ä¸‹vue+electronæ¡Œé¢å¼€å‘ å­¦ä¹ ä¸‹javaå’Œspringå¼€å‘(æœ¬äººä¸€ç›´ä½¿ç”¨PHP) ä¸€ç›´ç¼ºå°‘ä¸€æ¬¾èƒ½é€‚åˆè‡ªå·±çš„TODO LISTè½¯ä»¶ï¼Œèƒ½æœ‰æ¡Œé¢ç«¯çš„ å¯ç›´æŽ¥æ‰“åŒ…æˆdmgã€exe ç­‰äºŒè¿›åˆ¶æ–‡ä»¶ä½¿ç”¨ã€‚è¿™æ˜¯æˆ‘æ‰“åŒ…åŽçš„æ•ˆæžœã€‚ æŠ€æœ¯æ ˆ vue quasar electron springboot mysql è‡ªå®šä¹‰æ³¨è§£æºç åœ°å€ å‰ç«¯ https://github.com/visonforcoding/carambola-todo åŽç«¯ https://github.com/visonforcoding/carambola-todo-service","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://visonforcoding.xyz/tags/web/"}]},{"title":"å¹¶å‘ç¼–ç¨‹æ—¥è®°-çº¿ç¨‹ä¸å®‰å…¨çš„å±å®³","slug":"ç¼–å‘ç¼–ç¨‹æ—¥è®°-çº¿ç¨‹ä¸å®‰å…¨çš„å±å®³","date":"2021-03-03T11:16:37.000Z","updated":"2021-10-30T02:59:33.283Z","comments":true,"path":"2021/03/03/ç¼–å‘ç¼–ç¨‹æ—¥è®°-çº¿ç¨‹ä¸å®‰å…¨çš„å±å®³/","link":"","permalink":"http://visonforcoding.xyz/2021/03/03/%E7%BC%96%E5%8F%91%E7%BC%96%E7%A8%8B%E6%97%A5%E8%AE%B0-%E7%BA%BF%E7%A8%8B%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E5%8D%B1%E5%AE%B3/","excerpt":"","text":"è®¡æ•°å™¨@WebServlet(name = \"HelloServlet\", urlPatterns = &#123;\"/hello\"&#125;) public class HelloServlet extends HttpServlet &#123; private static final Logger LOG = Logger.getLogger(HelloServlet.class.getName()); private Integer count = 0; @Override protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123; ++count; processRequest(request, response); LOG.info(String.format(\"è®¡æ•° %d\", count)); &#125; &#125; æŒ‰å¸¸ç†å¤šå°‘æ¬¡è¯·æ±‚åŽå°±ä¼šæ‰“å°å‡ºè®¡æ•°å¤šå°‘ã€‚ ab -n300 -c20 http:&#x2F;&#x2F;localhost:8080&#x2F;servlet-demo&#x2F;hello æ­£å¸¸ä¸‹ï¼Œæ‰§è¡Œç¬¬ä¸€æ¬¡ è®¡æ•°åº”ä¸º300 äº‹å®žä¸Šå¾—åˆ°çš„å´ä¸æ˜¯ å†æ‰§è¡Œ.. 2 ~ 5903 ~ 8794 ~ 1170 å‡ ä¹Žæ²¡æœ‰è§„å¾‹ï¼Œå¹¶ä¸æ˜¯é¢„æœŸçš„ 300çš„å€æ•°ã€‚ è§£é‡Šå®žé™…ä¸Š++countæ˜¯ä¸€ä¸ªè¯»å–-ä¿®æ”¹-å†™å…¥çš„æ“ä½œã€‚ å‡è®¾çº¿ç¨‹Aã€B åŒæ—¶è¯»å–åˆ°äº†å€¼æ˜¯m,åŒæ—¶å†™å…¥+1åŽçš„å€¼m+1ã€‚ç»“æžœcount = m+1,åˆ™äº‹å®žä¸Šæ•´ä¸ªè®¡æ•°å°±å°‘äº†1,åº”è¯¥ä¸ºm+2ã€‚ å¤„ç†å°†countå£°æ˜Žä¸ºAtomicInter private Integer count = 0; private AtomicInteger atomicCount = new AtomicInteger(0); @Override protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123; ++count; processRequest(request, response); LOG.info(String.format(\"è®¡æ•°count %d\", count)); LOG.info(String.format(\"è®¡æ•°atomicCount %d\", atomicCount.incrementAndGet())); &#125; å¯ä»¥çœ‹åˆ°ï¼ŒAtomicIntegerç»Ÿè®¡çš„æ˜¯æ­£ç¡®çš„äº†ã€‚","categories":[],"tags":[{"name":"java","slug":"java","permalink":"http://visonforcoding.xyz/tags/java/"}]},{"title":"spring-boot+vue+supervisor+nginxçš„å‰åŽç«¯åˆ†ç¦»éƒ¨ç½²","slug":"java/spring-boot-vueçš„å‰åŽç«¯åˆ†ç¦»éƒ¨ç½²","date":"2021-02-22T06:43:54.000Z","updated":"2021-10-30T02:59:33.277Z","comments":true,"path":"2021/02/22/java/spring-boot-vueçš„å‰åŽç«¯åˆ†ç¦»éƒ¨ç½²/","link":"","permalink":"http://visonforcoding.xyz/2021/02/22/java/spring-boot-vue%E7%9A%84%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E9%83%A8%E7%BD%B2/","excerpt":"è¦ä¿è¯åŒåŸŸéƒ¨ç½²,å› ä¸ºè·¨åŸŸä¼šæœ‰å¾ˆå¤šé—®é¢˜è¦é‡æ–°è§£å†³ é¡ºä¾¿æ ‘ä¸‹ï¼Œä½†å…¶å®žçŽ°åœ¨äº’è”ç½‘äº§å“ä¸€èˆ¬éƒ½æœ‰å¤šå®¢æˆ·ç«¯ï¼Œpc web ã€å°ç¨‹åºã€appã€‚ä¿å®ˆçš„åŒåŸŸsessionæ¨¡å¼ä¿æŒä¼šè¯å·²ç»æ»¡è¶³ä¸äº†ä¸€äº›éœ€æ±‚ã€‚æ¯”å¦‚ï¼Œå•ç«¯ç™»å½•ç­‰ã€‚ è¨€å½’æ­£ä¼ ï¼Œæˆ‘é‡‡å–çš„æ€è·¯æ˜¯ï¼Œå‰ç«¯è¯·æ±‚æŽ¥å£æ—¶ç»Ÿä¸€åŠ ä¸Šapiå‰ç¼€ï¼Œnginxå°†apiå‰ç¼€çš„è·¯ç”±è¯·æ±‚ä»£ç†è½¬å‘åˆ°spring-boot","text":"è¦ä¿è¯åŒåŸŸéƒ¨ç½²,å› ä¸ºè·¨åŸŸä¼šæœ‰å¾ˆå¤šé—®é¢˜è¦é‡æ–°è§£å†³ é¡ºä¾¿æ ‘ä¸‹ï¼Œä½†å…¶å®žçŽ°åœ¨äº’è”ç½‘äº§å“ä¸€èˆ¬éƒ½æœ‰å¤šå®¢æˆ·ç«¯ï¼Œpc web ã€å°ç¨‹åºã€appã€‚ä¿å®ˆçš„åŒåŸŸsessionæ¨¡å¼ä¿æŒä¼šè¯å·²ç»æ»¡è¶³ä¸äº†ä¸€äº›éœ€æ±‚ã€‚æ¯”å¦‚ï¼Œå•ç«¯ç™»å½•ç­‰ã€‚ è¨€å½’æ­£ä¼ ï¼Œæˆ‘é‡‡å–çš„æ€è·¯æ˜¯ï¼Œå‰ç«¯è¯·æ±‚æŽ¥å£æ—¶ç»Ÿä¸€åŠ ä¸Šapiå‰ç¼€ï¼Œnginxå°†apiå‰ç¼€çš„è·¯ç”±è¯·æ±‚ä»£ç†è½¬å‘åˆ°spring-boot nginxé…ç½® server &#123; server_name admin.domain.xyz; index index.html; location / &#123; index index.html; root /home/wwwuser/webroot/itdoc-admin-web/dist/spa; &#125; location /api/ &#123; proxy_pass http://127.0.0.1:8081/; &#125; # optionally disable falling back to PHP script for the asset directories; # nginx will return a 404 error when files are not found instead of passing the # request to Symfony (improves performance but Symfony's 404 page is not displayed) # location /bundles &#123; # try_files $uri =404; # &#125; error_log /var/log/nginx/admin_error.log; access_log /var/log/nginx/admin_access.log; &#125; supervisorå®ˆæŠ¤java -jaræˆ‘è¿™é‡Œé‡‡å–java -jaræ¨¡å¼éƒ¨ç½²ï¼Œä½†æ˜¯å•çº¯çš„è¿™ç§æ¨¡å¼å¹¶ä¸èƒ½ä¿è¯è‡ªå¯åŠ¨å’Œè¿›ç¨‹ç›‘æŽ§ç­‰ã€‚å› æ­¤éœ€è¦å€ŸåŠ©supervisorã€‚ [program:itdoc] command=/usr/local/jdk-11.0.2/bin/java -jar itdoc-0.0.2-SNAPSHOT.jar process_name=%(program_name)s numprocs=1 directory=/home/wwwuser/webroot umask=022 priority=999 autostart=true autorestart=unexpected startsecs=10 startretries=3 exitcodes=0 stopsignal=TERM stopwaitsecs=10 stopasgroup=false killasgroup=false user=wwwuser redirect_stderr=false stdout_logfile=/var/log/webroot/itdoc-out.log stdout_logfile_maxbytes=1MB stdout_logfile_backups=10 stdout_capture_maxbytes=1MB stdout_events_enabled=false stderr_logfile=/var/log/webroot/itdoc-err.log stderr_logfile_maxbytes=1MB stderr_logfile_backups=10 stderr_capture_maxbytes=1MB è¿™é‡Œçš„autostart å’Œ autorestart èƒ½ä¿è¯è‡ªå¯åŠ¨å’Œå¯åŠ¨é‡å¯","categories":[],"tags":[{"name":"java","slug":"java","permalink":"http://visonforcoding.xyz/tags/java/"}]},{"title":"åˆ©ç”¨Locustè¿›è¡Œæ€§èƒ½æµ‹è¯•","slug":"åˆ©ç”¨Locustè¿›è¡Œæ€§èƒ½æµ‹è¯•","date":"2021-01-23T02:17:02.000Z","updated":"2021-10-30T02:59:33.283Z","comments":true,"path":"2021/01/23/åˆ©ç”¨Locustè¿›è¡Œæ€§èƒ½æµ‹è¯•/","link":"","permalink":"http://visonforcoding.xyz/2021/01/23/%E5%88%A9%E7%94%A8Locust%E8%BF%9B%E8%A1%8C%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/","excerpt":"è¦çœ‹ä¸€ä¸ªé¡¹ç›®çš„æœ€å¤§å¯ç”¨èƒ½åŠ›æ˜¯å¤šå°‘ï¼Œæ€§èƒ½æµ‹è¯•å·¥ä½œå°‘ä¸äº†. æ¯ä¸€ä¸ªé¡¹ç›®éƒ½åº”è¯¥åšåŽ‹æµ‹ å¤šçº¿ç¨‹å¹¶å‘æ¨¡åž‹ä¸€å®šè¦åšåŽ‹æµ‹","text":"è¦çœ‹ä¸€ä¸ªé¡¹ç›®çš„æœ€å¤§å¯ç”¨èƒ½åŠ›æ˜¯å¤šå°‘ï¼Œæ€§èƒ½æµ‹è¯•å·¥ä½œå°‘ä¸äº†. æ¯ä¸€ä¸ªé¡¹ç›®éƒ½åº”è¯¥åšåŽ‹æµ‹ å¤šçº¿ç¨‹å¹¶å‘æ¨¡åž‹ä¸€å®šè¦åšåŽ‹æµ‹ å®‰è£…$ pip3 install locust ç¼–å†™è„šæœ¬import time from locust import HttpUser, task, between class QuickstartUser(HttpUser): wait_time = between(1, 2.5) @task def hello_world(self): self.client.get(\"/hello\") self.client.get(\"/world\") @task(3) def view_items(self): for item_id in range(10): self.client.get(f\"/item?id=&#123;item_id&#125;\", name=\"/item\") time.sleep(1) def on_start(self): self.client.post(\"/login\", json=&#123;\"username\":\"foo\", \"password\":\"bar\"&#125;) wait_time = between(1, 2.5) Our class defines a wait_time that will make the simulated users wait between 1 and 2.5 seconds after each task (see below) is executed. For more info see wait_time attribute. def hello_world(self): @task def hello_world(self): self.client.get(\"/hello\") self.client.get(\"/world\") @task(3) def view_items(self): ... task(3) å†…çš„å‚æ•°è¡¨ç¤ºä»»åŠ¡æ‰§è¡Œçš„æƒé‡ï¼Œview_itemsçš„æ¬¡æ•°å°†æ˜¯hello_worldæ¬¡æ•°çš„3å€ã€‚ æ‰§è¡Œ$ locust -f locust_files&#x2F;my_locust_file.py ä»»åŠ¡æ‰§è¡Œç•Œé¢å’Œç»“æžœ","categories":[],"tags":[{"name":"è½¯ä»¶å·¥ç¨‹","slug":"è½¯ä»¶å·¥ç¨‹","permalink":"http://visonforcoding.xyz/tags/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B/"}]},{"title":"é»‘å¯åŠ¨","slug":"é»‘å¯åŠ¨","date":"2021-01-21T13:38:28.000Z","updated":"2021-11-29T09:41:14.347Z","comments":true,"path":"2021/01/21/é»‘å¯åŠ¨/","link":"","permalink":"http://visonforcoding.xyz/2021/01/21/%E9%BB%91%E5%90%AF%E5%8A%A8/","excerpt":"","text":"facebookæ¡ˆä¾‹ä½œä¸ºé»‘å¯åŠ¨æµç¨‹çš„ä¸€éƒ¨åˆ†ï¼Œæ¯ä¸ªFacebook ç”¨æˆ·ä¼šè¯ï¼ˆåœ¨ç”¨æˆ·ç«¯æµè§ˆå™¨ä¸­è¿è¡ŒJavaScript ä»£ç ï¼‰éƒ½åŠ è½½äº†æµ‹è¯•å·¥å…·ã€‚è™½ç„¶èŠå¤©åŠŸèƒ½çš„ç”¨æˆ·ç•Œé¢å…ƒç´ è¢«éšè—èµ·æ¥ï¼Œä½†æµè§ˆå™¨è¿˜æ˜¯ä¼šå‘å·²éƒ¨ç½²åœ¨ç”Ÿäº§çŽ¯å¢ƒä¸­çš„åŽå°èŠå¤©æœåŠ¡å™¨å‘é€ç”¨æˆ·ä¸å¯è§çš„èŠå¤©æµ‹è¯•ä¿¡æ¯ï¼Œè¿™ä½¿å¼€ å‘å›¢é˜Ÿèƒ½å¤Ÿåœ¨æ•´ä¸ªé¡¹ç›®è¿‡ç¨‹ä¸­æ¨¡æ‹Ÿå‡ºç±»ç”Ÿäº§è´Ÿè½½ï¼Œä»Žè€Œåœ¨å‘å¸ƒä¹‹å‰æ‰¾å‡ºå¹¶è§£å†³æ€§èƒ½é—®é¢˜ã€‚ è€å­æƒŠäº†,è¿™æœ‰ç‚¹ç‰›çš®","categories":[],"tags":[{"name":"æ–¹æ¡ˆ","slug":"æ–¹æ¡ˆ","permalink":"http://visonforcoding.xyz/tags/%E6%96%B9%E6%A1%88/"}]},{"title":"servlet | servleté›†æˆmybatis-æ— xml&æ³¨è§£æ–¹å¼","slug":"java/servleté›†æˆmybatis-æ— xml-æ³¨è§£æ–¹å¼","date":"2021-01-06T08:14:24.000Z","updated":"2021-11-28T05:27:39.248Z","comments":true,"path":"2021/01/06/java/servleté›†æˆmybatis-æ— xml-æ³¨è§£æ–¹å¼/","link":"","permalink":"http://visonforcoding.xyz/2021/01/06/java/servlet%E9%9B%86%E6%88%90mybatis-%E6%97%A0xml-%E6%B3%A8%E8%A7%A3%E6%96%B9%E5%BC%8F/","excerpt":"ä¹ æƒ¯äº†phpé¡¹ç›®ä¹‹åŽï¼Œææ€•éžå¸¸ä¸å–œæ¬¢æ“ä½œxmlå§.æœ¬ç« å°†ä»‹ç»servlet+mybatisæ— xmlé…ç½®æ¨¡å¼ã€‚","text":"ä¹ æƒ¯äº†phpé¡¹ç›®ä¹‹åŽï¼Œææ€•éžå¸¸ä¸å–œæ¬¢æ“ä½œxmlå§.æœ¬ç« å°†ä»‹ç»servlet+mybatisæ— xmlé…ç½®æ¨¡å¼ã€‚ ä¾èµ–&lt;dependency> &lt;groupId>mysql&lt;/groupId> &lt;artifactId>mysql-connector-java&lt;/artifactId> &lt;version>5.1.26&lt;/version> &lt;/dependency> &lt;!-- https://mvnrepository.com/artifact/org.mybatis/mybatis --> &lt;dependency> &lt;groupId>org.mybatis&lt;/groupId> &lt;artifactId>mybatis&lt;/artifactId> &lt;version>3.5.6&lt;/version> &lt;/dependency> å¼•å…¥é¦–å…ˆå®šä¹‰datasource public class DatabaseConfig &#123; static String driver = \"com.mysql.jdbc.Driver\"; static String url = \"jdbc:mysql://localhost:3306/db_itdoc?useSSL=false\"; static String username = \"root\"; static String password = \"12345678\"; public static DataSource getDataSource() &#123; Properties properties = new Properties(); properties.setProperty(\"driver\", driver); properties.setProperty(\"url\", url); properties.setProperty(\"username\", username); properties.setProperty(\"password\", password); UnpooledDataSourceFactory unpooledDataSourceFactory = new UnpooledDataSourceFactory(); unpooledDataSourceFactory.setProperties(properties); DataSource dataSource = unpooledDataSourceFactory.getDataSource(); return dataSource; &#125; &#125; èŽ·å–sessionFactory public class MybatisLoader &#123; static SqlSessionFactory sqlSessionFactory = null; public static SqlSessionFactory getSqlSessionFactory() &#123; if (sqlSessionFactory == null) &#123; DataSource dataSource = DatabaseConfig.getDataSource(); TransactionFactory transactionFactory = new JdbcTransactionFactory(); Environment environment = new Environment(\"development\", transactionFactory, dataSource); Configuration configuration = new Configuration(environment); configuration.addMapper(UserMapper.class); sqlSessionFactory = new SqlSessionFactoryBuilder().build(configuration); &#125; return sqlSessionFactory; &#125; &#125; å®šä¹‰mapperpublic interface UserMapper &#123; @Select(\"SELECT * FROM user WHERE id = #&#123;id&#125;\") User selectUser(int id); @Insert(\"INSERT INTO user(name,email) VALUES(#&#123;name&#125;, #&#123;email&#125;)\") int insertUser(User user); &#125; æŸ¥è¯¢å’Œæ’å…¥public class UserController &#123; public UserController() &#123; &#125; @GetMapping(path = \"/user/profile\") public String profile(HttpServletRequest request, HttpServletResponse response) &#123; System.out.print(request.getCookies()); return \"i am user profile\"; &#125; @GetMapping(path = \"/user\") public Response user(HttpServletRequest request, int id) &#123; User user = null; SqlSession session = MybatisLoader.getSqlSessionFactory().openSession(); UserMapper mapper = session.getMapper(UserMapper.class); user = mapper.selectUser(id); return new Response(0, \"èŽ·å–æˆåŠŸ\", user); &#125; @PostMapping(path = \"/user/add\") public Response add(User user) &#123; Log.info(\"request user\", user); try &#123; SqlSession session = MybatisLoader.getSqlSessionFactory().openSession(); UserMapper mapper = session.getMapper(UserMapper.class); int id = mapper.insertUser(user); session.commit(); Log.debug(\"è¿”å›ž\", id); &#125; catch (Exception e) &#123; Log.error(\"ä¿å­˜å¤±è´¥\", e); &#125; return new Response(0, \"ä¿å­˜\", user); &#125; &#125;","categories":[],"tags":[{"name":"java","slug":"java","permalink":"http://visonforcoding.xyz/tags/java/"}]},{"title":"Introduction to Spring MVC HandlerInterceptoræ‹¦æˆªå™¨ä»‹ç»","slug":"java/Introduction-to-Spring-MVC-HandlerInterceptoræ‹¦æˆªå™¨ä»‹ç»","date":"2020-09-24T06:41:22.000Z","updated":"2021-10-30T02:59:33.276Z","comments":true,"path":"2020/09/24/java/Introduction-to-Spring-MVC-HandlerInterceptoræ‹¦æˆªå™¨ä»‹ç»/","link":"","permalink":"http://visonforcoding.xyz/2020/09/24/java/Introduction-to-Spring-MVC-HandlerInterceptor%E6%8B%A6%E6%88%AA%E5%99%A8%E4%BB%8B%E7%BB%8D/","excerpt":"","text":"","categories":[],"tags":[{"name":"JAVA","slug":"JAVA","permalink":"http://visonforcoding.xyz/tags/JAVA/"}]},{"title":"Java JPAæ€è€ƒ","slug":"java/Java-JPAæ€è€ƒ","date":"2020-09-23T08:56:11.000Z","updated":"2021-10-30T02:59:33.276Z","comments":true,"path":"2020/09/23/java/Java-JPAæ€è€ƒ/","link":"","permalink":"http://visonforcoding.xyz/2020/09/23/java/Java-JPA%E6%80%9D%E8%80%83/","excerpt":"JPAå³Java Persistence API. 2006å¹´5æœˆ11å·ï¼ŒJPA 1.0 è§„èŒƒä½œä¸º JCP JSR 220 çš„ä¸€éƒ¨åˆ†æœ€ç»ˆè¢«å‘å¸ƒã€‚ åœ¨PHPä¸–ç•Œå½“ä¸­doctrineã€cake ORM éƒ½æœ‰JPAçš„å½±å­ã€‚","text":"JPAå³Java Persistence API. 2006å¹´5æœˆ11å·ï¼ŒJPA 1.0 è§„èŒƒä½œä¸º JCP JSR 220 çš„ä¸€éƒ¨åˆ†æœ€ç»ˆè¢«å‘å¸ƒã€‚ åœ¨PHPä¸–ç•Œå½“ä¸­doctrineã€cake ORM éƒ½æœ‰JPAçš„å½±å­ã€‚ EntityæŒä¹…åŒ–å®žä½“æ˜¯ä¸€ä¸ªè½»é‡çº§çš„ Java ç±»ï¼Œå…¶çŠ¶æ€é€šå¸¸æŒä¹…åœ°ä¿å­˜åˆ°å…³ç³»æ•°æ®åº“çš„è¡¨ä¸­ã€‚ è¿™ç§å®žä½“çš„å®žä¾‹å¯¹åº”äºŽè¡¨ä¸­çš„å„ä¸ªè¡Œã€‚ å®žä½“ä¹‹é—´é€šå¸¸æœ‰å…³ç³»ï¼Œè¿™äº›å…³ç³»é€šè¿‡å¯¹è±¡/å…³ç³»å…ƒæ•°æ®è¡¨ç¤ºã€‚ å¯ä»¥åœ¨å®žä½“ç±»æ–‡ä»¶ä¸­ç›´æŽ¥ä½¿ç”¨æ³¨é‡Šæ¥æŒ‡å®šè¿™ç§å…³ç³»ï¼Œä¹Ÿå¯ä»¥åœ¨éšåº”ç”¨ç¨‹åºåˆ†å‘çš„å•ç‹¬XMLæè¿°æ–‡ä»¶ä¸­æŒ‡å®šã€‚ JPQLJavaæŒä¹…åŒ–æŸ¥è¯¢è¯­è¨€ ï¼ˆJPQLï¼‰å¯¹å­˜å‚¨åœ¨å…³ç³»æ•°æ®åº“ä¸­çš„å®žä½“è¿›è¡ŒæŸ¥è¯¢ã€‚æŸ¥è¯¢åœ¨è¯­æ³•ä¸Šç±»ä¼¼äºŽSQLæŸ¥è¯¢ï¼Œä½†æ˜¯æ“ä½œçš„æ˜¯å®žä½“å¯¹è±¡è€Œä¸æ˜¯ç›´æŽ¥å¯¹æ•°æ®åº“è¡¨è¿›è¡Œæ“ä½œã€‚ åŠ¨æœºåœ¨å¼•å…¥EJB 3.0è§„èŒƒä¹‹å‰ï¼Œè®¸å¤šä¼ä¸šçº§Javaå¼€å‘äººå‘˜ä½¿ç”¨ç”±æŒä¹…åŒ–æ¡†æž¶ï¼ˆä¾‹å¦‚Hibernateï¼‰æˆ–æ•°æ®è®¿é—®å¯¹è±¡ï¼ˆDAOï¼‰æä¾›çš„è½»é‡çº§æŒä¹…åŒ–å¯¹è±¡ï¼Œæ¥ä»£æ›¿å®žä½“beanï¼ˆEJBçš„ä¸€ç§ï¼‰ã€‚ è¿™æ˜¯å› ä¸ºåœ¨ä»¥å‰çš„EJBè§„èŒƒä¸­ï¼Œå®žä½“beanéœ€è¦å¤ªå¤šå¤æ‚çš„ä»£ç å’Œç¹é‡çš„èµ„æºå ç”¨ï¼Œå¹¶ä¸”ç”±äºŽbeanå’ŒDAOå¯¹è±¡æˆ–æŒä¹…åŒ–æ¡†æž¶ä¹‹é—´çš„æºä»£ç ä¸­çš„äº’è¿žå’Œä¾èµ–æ€§ï¼Œå®ƒä»¬åªèƒ½åœ¨Java EEåº”ç”¨ç¨‹åºæœåŠ¡å™¨ä¸­ä½¿ç”¨ã€‚ å› æ­¤ï¼Œæœ€åˆåœ¨ç¬¬ä¸‰æ–¹æŒä¹…æ€§æ¡†æž¶ä¸­æä¾›çš„è®¸å¤šåŠŸèƒ½éƒ½è¢«åˆå¹¶åˆ°Java Persistence APIä¸­ï¼Œå¹¶ä¸”ä»Ž2006å¹´å¼€å§‹ï¼ŒåƒHibernateï¼ˆç‰ˆæœ¬3.2ï¼‰å’ŒTopLink Essentialsè¿™æ ·çš„é¡¹ç›®å·²ç»å®žçŽ°Java Persistence APIè§„èŒƒã€‚ JPAæä¾›å•†JPAæ˜¯ä¸€ä¸ªå¼€æºAPIï¼Œå› æ­¤Oracleï¼ŒRedhatï¼ŒEclipseç­‰å„ç§ä¼ä¸šä¾›åº”å•†é€šè¿‡åœ¨å…¶ä¸­æ·»åŠ JPAæŒä¹…æ€§é£Žæ ¼æ¥æä¾›æ–°äº§å“ã€‚ å…¶ä¸­ä¸€äº›äº§å“åŒ…æ‹¬: Hibernate, Eclipselink, Toplink, Spring Data JPA, etc. JSRå®šä¹‰äº†æ ‡å‡†ï¼Œä¼—å¤šç»„ç»‡å¯¹è¿™ä¸ªæ ‡å‡†è¿›è¡Œäº†å®žçŽ°ï¼Œè¿™ä½¿å¾—å¼€å‘è€…å‡ ä¹Žå¯ä»¥åœ¨ä¸åŒçš„å®žçŽ°ç‰ˆæœ¬é‡Œæ— ç¼åˆ‡æ¢ã€‚ æ³¨è§£ Annotationsé€šå¸¸ï¼ŒXmlæ–‡ä»¶ç”¨äºŽé…ç½®ç‰¹å®šç»„ä»¶ï¼Œæˆ–æ˜ å°„ä¸¤ç§ä¸åŒè§„æ ¼çš„ç»„ä»¶ã€‚ åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨æ¡†æž¶ä¸­å•ç‹¬ç»´æŠ¤xmlã€‚ è¿™æ„å‘³ç€åœ¨ç¼–å†™æ˜ å°„xmlæ–‡ä»¶æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å°†POJOç±»å±žæ€§ä¸Žmapping.xmlæ–‡ä»¶ä¸­çš„å®žä½“æ ‡è®°è¿›è¡Œæ¯”è¾ƒã€‚ è¿™æ˜¯è§£å†³æ–¹æ¡ˆ:åœ¨ç±»å®šä¹‰ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ³¨é‡Šç¼–å†™é…ç½®éƒ¨åˆ†ã€‚ æ³¨é‡Šç”¨äºŽç±»ï¼Œå±žæ€§å’Œæ–¹æ³•ã€‚ æ³¨é‡Šä»¥â€œ@â€ç¬¦å·å¼€å¤´ã€‚ åœ¨å£°æ˜Žç±»ï¼Œå±žæ€§æˆ–æ–¹æ³•ä¹‹å‰å£°æ˜Žæ³¨é‡Šã€‚ JPAçš„æ‰€æœ‰æ³¨é‡Šéƒ½åœ¨javax.persistenceåŒ…ä¸­å®šä¹‰ã€‚ ä»¥ä¸‹æ˜¯æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ä½¿ç”¨çš„æ³¨é‡Šåˆ—è¡¨ æ³¨è§£ æè¿° @Entity æ­¤æ‰¹æ³¨æŒ‡å®šå°†ç±»å£°æ˜Žä¸ºå®žä½“æˆ–è¡¨ @Table æ­¤æ‰¹æ³¨æŒ‡å®šå£°æ˜Žè¡¨åã€‚ @Basic æ­¤æ‰¹æ³¨æ˜Žç¡®æŒ‡å®šéžçº¦æŸå­—æ®µ @Embedded æ­¤æ‰¹æ³¨æŒ‡å®šç±»æˆ–å®žä½“çš„å±žæ€§ï¼Œè¯¥å®žä½“çš„å¯åµŒå…¥ç±»çš„å€¼å®žä¾‹ã€‚ @Id æ­¤æ‰¹æ³¨æŒ‡å®šå±žæ€§ï¼Œç”¨äºŽç±»çš„æ ‡è¯†ï¼ˆè¡¨çš„ä¸»é”®ï¼‰ã€‚ @GeneratedValue æ­¤æ‰¹æ³¨æŒ‡å®šäº†å¦‚ä½•åˆå§‹åŒ–æ ‡è¯†å±žæ€§ï¼Œä¾‹å¦‚è‡ªåŠ¨ï¼Œæ‰‹åŠ¨æˆ–ä»Žåºåˆ—è¡¨ä¸­èŽ·å–çš„å€¼ã€‚ @Transient æ­¤æ‰¹æ³¨æŒ‡å®šäº†ä¸æŒä¹…çš„å±žæ€§ï¼Œå³è¯¥å€¼æ°¸è¿œä¸ä¼šå­˜å‚¨åˆ°æ•°æ®åº“ä¸­ã€‚ @Column æ­¤æ‰¹æ³¨ç”¨äºŽæŒ‡å®šæŒä¹…æ€§å±žæ€§çš„åˆ—æˆ–å±žæ€§ã€‚ @SequenceGenerator æ­¤æ‰¹æ³¨ç”¨äºŽå®šä¹‰@GeneratedValueæ‰¹æ³¨ä¸­æŒ‡å®šçš„å±žæ€§çš„å€¼ã€‚ å®ƒåˆ›å»ºäº†ä¸€ä¸ªåºåˆ—ã€‚ @TableGenerator æ­¤æ‰¹æ³¨ç”¨äºŽæŒ‡å®š@GeneratedValueæ‰¹æ³¨ä¸­æŒ‡å®šçš„å±žæ€§çš„å€¼ç”Ÿæˆå™¨ã€‚ å®ƒåˆ›å»ºäº†ä¸€ä¸ªä»·å€¼ç”Ÿæˆè¡¨ã€‚ @AccessType æ­¤ç±»æ³¨é‡Šç”¨äºŽè®¾ç½®è®¿é—®ç±»åž‹ã€‚ å¦‚æžœè®¾ç½®@AccessTypeï¼ˆFIELDï¼‰ï¼Œåˆ™ä¼šå‘ç”Ÿå­—æ®µè®¿é—®ã€‚ å¦‚æžœè®¾ç½®@AccessTypeï¼ˆPROPERTYï¼‰ï¼Œåˆ™å°†è¿›è¡ŒProperty wiseè¯„ä¼°ã€‚ @JoinColumn æ­¤æ‰¹æ³¨ç”¨äºŽæŒ‡å®šå®žä½“å…³è”æˆ–å®žä½“é›†åˆã€‚ è¿™ç”¨äºŽå¤šå¯¹ä¸€å’Œä¸€å¯¹å¤šå…³è”ã€‚ @UniqueConstraint æ­¤æ‰¹æ³¨ç”¨äºŽæŒ‡å®šä¸»è¦æˆ–è¾…åŠ©è¡¨çš„å­—æ®µï¼Œå”¯ä¸€çº¦æŸã€‚ @ColumnResult æ­¤æ‰¹æ³¨ä½¿ç”¨selectå­å¥å¼•ç”¨SQLæŸ¥è¯¢ä¸­çš„åˆ—çš„åç§°ã€‚ @ManyToMany æ­¤æ‰¹æ³¨ç”¨äºŽå®šä¹‰è¿žæŽ¥è¡¨ä¹‹é—´çš„å¤šå¯¹å¤šå…³ç³»ã€‚ @ManyToOne æ­¤æ‰¹æ³¨ç”¨äºŽå®šä¹‰è¿žæŽ¥è¡¨ä¹‹é—´çš„å¤šå¯¹ä¸€å…³ç³»ã€‚ @OneToMany æ­¤æ‰¹æ³¨ç”¨äºŽå®šä¹‰è¿žæŽ¥è¡¨ä¹‹é—´çš„ä¸€å¯¹å¤šå…³ç³»ã€‚ @OneToOne æ­¤æ‰¹æ³¨ç”¨äºŽå®šä¹‰è¿žæŽ¥è¡¨ä¹‹é—´çš„ä¸€å¯¹ä¸€å…³ç³»ã€‚ @NamedQueries æ­¤æ‰¹æ³¨ç”¨äºŽæŒ‡å®šå‘½åæŸ¥è¯¢çš„åˆ—è¡¨ã€‚ @NamedQuery æ­¤æ‰¹æ³¨ç”¨äºŽä½¿ç”¨é™æ€åç§°æŒ‡å®šæŸ¥è¯¢ã€‚","categories":[],"tags":[{"name":"Java","slug":"Java","permalink":"http://visonforcoding.xyz/tags/Java/"}]},{"title":"PHP QA","slug":"php/PHP-QAä¹‹PHPStan","date":"2020-09-17T12:44:41.000Z","updated":"2021-10-30T02:59:33.279Z","comments":true,"path":"2020/09/17/php/PHP-QAä¹‹PHPStan/","link":"","permalink":"http://visonforcoding.xyz/2020/09/17/php/PHP-QA%E4%B9%8BPHPStan/","excerpt":"å†™åœ¨å‰é¢ï¼Œå·¥ä½œ7å¹´ï¼ŒPHPä¹Ÿå†™äº†7å¹´äº†ã€‚æœŸé—´ä¹Ÿå†™ä¸€äº›javaå’Œpythonï¼Œä¹Ÿå¯¹å„è¯­è¨€çš„ç‰¹ç‚¹æœ‰ä¸€äº›è‡ªå·±çš„ä½“ä¼šã€‚è¿™æ¬¡å’±ä»¬èŠèŠQAä¹‹ä½™ä¹Ÿæ¥èŠèŠPHPè¯­è¨€æœ¬èº«ã€‚","text":"å†™åœ¨å‰é¢ï¼Œå·¥ä½œ7å¹´ï¼ŒPHPä¹Ÿå†™äº†7å¹´äº†ã€‚æœŸé—´ä¹Ÿå†™ä¸€äº›javaå’Œpythonï¼Œä¹Ÿå¯¹å„è¯­è¨€çš„ç‰¹ç‚¹æœ‰ä¸€äº›è‡ªå·±çš„ä½“ä¼šã€‚è¿™æ¬¡å’±ä»¬èŠèŠQAä¹‹ä½™ä¹Ÿæ¥èŠèŠPHPè¯­è¨€æœ¬èº«ã€‚ æ¥åˆ°PHPStançš„å®˜ç½‘ï¼Œæˆ‘çœ‹åˆ°äº†ä¸€æ®µè¯ã€‚ I really like how much productivity a web developer gains by switching from compiled languages like Java or C# to an interpreted one like PHP. Aside from the dead simple execution model (start, handle one request, and die) and a much shorter feedback loop (no need to wait for the compiler), thereâ€™s a healthy ecosystem of open-source frameworks and libraries to help developers with their everyday tasks. Because of these reasons, PHP is the most popular language for web development by far. å¤§æ„æ˜¯ä½œè€…å¾ˆä¹æ„çœ‹åˆ°webå¼€å‘è€…ä»¬ä»ŽC#æˆ–Javaè¿™äº›ç¼–è¯‘æ€§è¯­è¨€é‡Œåˆ‡æ¢åˆ°è§£é‡Šè¯­è¨€ã€‚é™¤äº†ç®€å•çš„æ‰§è¡Œæ¨¡åž‹ï¼ˆå¯åŠ¨ï¼Œå¤„ç†ä¸€ä¸ªè¯·æ±‚å’Œç»ˆæ­¢ï¼‰å’Œè¾ƒçŸ­çš„åé¦ˆå‘¨æœŸï¼ˆæ— éœ€ç­‰å¾…ç¼–è¯‘ï¼‰ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªå¥åº·çš„å¼€æºæ¡†æž¶å’Œåº“ç”Ÿæ€ç³»ç»Ÿå¯å¸®åŠ©å¼€å‘äººå‘˜å®Œæˆæ—¥å¸¸å·¥ä½œä»»åŠ¡ã€‚ç”±äºŽè¿™äº›åŽŸå› ï¼ŒPHPæ˜¯è¿„ä»Šä¸ºæ­¢æœ€æµè¡Œçš„Webå¼€å‘è¯­è¨€ã€‚ è¿™ç¯‡æ–‡ç« æ˜¯ä½œè€…2016å¹´12æœˆ4æ—¥å†™çš„ï¼Œè¯´å®žè¯å¯¹äºŽPHPæ˜¯è¿„ä»Šä¸ºæ­¢æœ€æµè¡Œçš„Webå¼€å‘è¯­è¨€è¿™å¥è¯æˆ‘å·²ç»å¼€å§‹æ€€ç–‘äº†ã€‚è‡³å°‘åœ¨æœ€è¿‘è¿™äº›å¹´ï¼Œåœ¨å›½å†…PHPçš„å¸‚åœºå·²ç»ä¸é‚£ä¹ˆå¥½äº†ã€‚å¹¶ä¸”æˆ‘ä¹Ÿåœ¨è¶‹å‘ä»Žè§£é‡Šæ€§è¯­è¨€å‘ç¼–è¯‘è¯­è¨€åˆ‡æ¢äº†ã€‚ä½†æ˜¯å…¶ä¸­å¯¹äºŽè§£é‡Šæ€§è¯­è¨€çš„ä¼˜åŠ¿æè¿°æˆ‘æ˜¯éžå¸¸èµžåŒçš„ï¼Œè¿™ä¹Ÿæ˜¯å®ƒå®è´µçš„ä¼˜åŠ¿ã€‚ ç®€å•çš„æ‰§è¡Œæ¨¡åž‹ è¾ƒçŸ­çš„åé¦ˆå‘¨æœŸ QAä¹‹PHPStanè¨€å½’æ­£ä¼ ï¼Œç»§ç»­PHPStan å®‰è£…composer require --dev phpstan&#x2F;phpstan è¿è¡Œvendor&#x2F;bin&#x2F;phpstan analyse src tests PHPmd~&#x2F;vendor&#x2F;bin&#x2F;phpmd src&#x2F;Service&#x2F;OrderService.php text codesize,unusedcode,naming","categories":[],"tags":[{"name":"PHP","slug":"PHP","permalink":"http://visonforcoding.xyz/tags/PHP/"}]},{"title":"vue+vuex+axios+vant+vue-routerç®€å•å•é¡µç™»å½•æ€demo","slug":"web/vue-vuex-axios-vant-vue-routerç®€å•å•é¡µç™»å½•æ€demo","date":"2020-09-15T10:12:12.000Z","updated":"2021-10-30T02:59:33.282Z","comments":true,"path":"2020/09/15/web/vue-vuex-axios-vant-vue-routerç®€å•å•é¡µç™»å½•æ€demo/","link":"","permalink":"http://visonforcoding.xyz/2020/09/15/web/vue-vuex-axios-vant-vue-router%E7%AE%80%E5%8D%95%E5%8D%95%E9%A1%B5%E7%99%BB%E5%BD%95%E6%80%81demo/","excerpt":"","text":"åˆ›å»ºvanté¡¹ç›®# å®‰è£… Vue Cli npm install -g @vue/cli # åˆ›å»ºä¸€ä¸ªé¡¹ç›® vue create hello-world # åˆ›å»ºå®ŒæˆåŽï¼Œå¯ä»¥é€šè¿‡å‘½ä»¤æ‰“å¼€å›¾å½¢åŒ–ç•Œé¢ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º vue ui # æˆ–è€… é€šè¿‡ yarn å®‰è£… yarn add vant åœ¨å›¾å½¢åŒ–ç•Œé¢ä¸­ï¼Œç‚¹å‡»ä¾èµ– -&gt; å®‰è£…ä¾èµ–ï¼Œç„¶åŽå°† vant æ·»åŠ åˆ°ä¾èµ–ä¸­å³å¯ã€‚ vue-routeryarn add vue-router &lt;template> &lt;div id=\"app\"> &lt;van-nav-bar title=\"æ ‡é¢˜\" left-text=\"è¿”å›ž\" right-text=\"æŒ‰é’®\" left-arrow @click-left=\"onClickLeft\" @click-right=\"onClickRight\" /> &lt;router-view>&lt;/router-view> &lt;van-tabbar v-model=\"active\"> &lt;van-tabbar-item icon=\"home-o\" to=\"/\">ä¸»é¡µ&lt;/van-tabbar-item> &lt;van-tabbar-item icon=\"search\">æ ‡ç­¾&lt;/van-tabbar-item> &lt;van-tabbar-item icon=\"friends-o\">æ ‡ç­¾&lt;/van-tabbar-item> &lt;van-tabbar-item icon=\"user-o\" to=\"/user/detail\">æˆ‘çš„&lt;/van-tabbar-item> &lt;/van-tabbar> &lt;/div> &lt;/template>&lt;template> &lt;div id=\"app\"> &lt;van-nav-bar title=\"æ ‡é¢˜\" left-text=\"è¿”å›ž\" right-text=\"æŒ‰é’®\" left-arrow @click-left=\"onClickLeft\" @click-right=\"onClickRight\" /> &lt;router-view>&lt;/router-view> &lt;van-tabbar v-model=\"active\"> &lt;van-tabbar-item icon=\"home-o\" to=\"/\">ä¸»é¡µ&lt;/van-tabbar-item> &lt;van-tabbar-item icon=\"search\">æ ‡ç­¾&lt;/van-tabbar-item> &lt;van-tabbar-item icon=\"friends-o\">æ ‡ç­¾&lt;/van-tabbar-item> &lt;van-tabbar-item icon=\"user-o\" to=\"/user/detail\">æˆ‘çš„&lt;/van-tabbar-item> &lt;/van-tabbar> &lt;/div> &lt;/template> è·¯ç”±é…ç½®å’Œç™»å½•æ€æŽ§åˆ¶ import Vue from 'vue' import VueRouter from 'vue-router' // import store from '@/store' // import layout from '@/layout/layout' Vue.use(VueRouter) const routes = [ &#123; path: '/', name: 'home', component: () => import(\"@/views/Home\") &#125;, &#123; path: '/user/detail', name: 'user_detail', meta:&#123; requireLogin:true &#125;, component: () => import(\"@/views/User/detail.vue\") &#125;, &#123; path: '/login', name: 'login', meta:&#123; requireLogin:false &#125;, component: () => import(\"@/views/Login/login.vue\") &#125;, ] const router = new VueRouter(&#123; mode: 'history', base: process.env.BASE_URL, routes &#125;) router.beforeEach((to, from, next) => &#123; const token = sessionStorage.getItem('token'); // store.getters('isLogin') if (to.meta.requireLogin) &#123; //éœ€è¦æ£€æµ‹ç™»å½• if (token) &#123; next(); &#125; else &#123; console.log('å‰å¾€ç™»å½•...') next(&#123; path: '/login' &#125;); &#125; &#125; else &#123; next(); &#125; &#125;) export default router ç™»å½•å¼•å…¥axios yarn add axios import &#123; login &#125; from \"@/api/loginReq\"; export default &#123; data() &#123; return &#123; loading: false, loginInfo:&#123; username:\"\", pwd:\"\" &#125; &#125;; &#125;, methods: &#123; onSubmit(values) &#123; this.loading = true; login(this.loginInfo).then((response) => &#123; console.log(response); if(response.code===0)&#123; sessionStorage.setItem('token',response.data.username); &#125; this.$router.push('/') &#125;); this.loading = false; &#125;, &#125; &#125;","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://visonforcoding.xyz/tags/web/"}]},{"title":"spring-boot validationæ•°æ®éªŒè¯","slug":"java/spring-boot-validationæ•°æ®éªŒè¯","date":"2020-09-14T14:40:18.000Z","updated":"2021-10-30T02:59:33.277Z","comments":true,"path":"2020/09/14/java/spring-boot-validationæ•°æ®éªŒè¯/","link":"","permalink":"http://visonforcoding.xyz/2020/09/14/java/spring-boot-validation%E6%95%B0%E6%8D%AE%E9%AA%8C%E8%AF%81/","excerpt":"åšä¸šåŠ¡å¤„ç†ï¼Œä¸å¯é¿å…çš„è¦å¯¹å‚æ•°è¿›è¡Œæ ¡éªŒï¼Œä¸€å¥—å®Œæ•´è§„èŒƒçš„æ ¡éªŒä½“ç³»å¯ä»¥æé«˜ä¸å°‘çš„æ•ˆçŽ‡ã€‚ åœ¨å†™äº†PHPã€javaã€python ç­‰ç¼–ç¨‹è¯­è¨€ä¹‹åŽï¼Œæˆ‘å‘çŽ°javaçš„ä¼˜åŠ¿å°±æ˜¯å®ƒçš„è§„èŒƒã€å®ƒçš„ä¸¥è°¨ã€‚åœ¨jsrä¹‹ä¸‹å»ºç«‹å„ç§åœºæ™¯çš„æ ‡å‡†ï¼Œæ‰€æœ‰äººéƒ½åœ¨è¿™å¥—è§„èŒƒä¸‹æ‹“å±•ã€è¿­ä»£ã€å‡çº§ã€‚æœ€ç»ˆè¿™å¥—ä½“ç³»å˜å¾—è¶Šæ¥è¶Šå®Œç¾Žã€ç¬¦åˆä½“ç³»çš„ç”Ÿæ€äº§å“ä¹Ÿè¶Šæ¥è¶Šå¤šã€‚ è¿™å¤§æ¦‚å°±æ˜¯javaæœ€å¼ºä¹‹å¤„å§ã€‚ æœ¬èŠ‚ä»‹ç»ä¸‹spring-bootçš„éªŒè¯ï¼Œå®ƒä¹Ÿæ˜¯åŸºäºŽjsrçš„validationä¹‹ä¸‹ã€‚","text":"åšä¸šåŠ¡å¤„ç†ï¼Œä¸å¯é¿å…çš„è¦å¯¹å‚æ•°è¿›è¡Œæ ¡éªŒï¼Œä¸€å¥—å®Œæ•´è§„èŒƒçš„æ ¡éªŒä½“ç³»å¯ä»¥æé«˜ä¸å°‘çš„æ•ˆçŽ‡ã€‚ åœ¨å†™äº†PHPã€javaã€python ç­‰ç¼–ç¨‹è¯­è¨€ä¹‹åŽï¼Œæˆ‘å‘çŽ°javaçš„ä¼˜åŠ¿å°±æ˜¯å®ƒçš„è§„èŒƒã€å®ƒçš„ä¸¥è°¨ã€‚åœ¨jsrä¹‹ä¸‹å»ºç«‹å„ç§åœºæ™¯çš„æ ‡å‡†ï¼Œæ‰€æœ‰äººéƒ½åœ¨è¿™å¥—è§„èŒƒä¸‹æ‹“å±•ã€è¿­ä»£ã€å‡çº§ã€‚æœ€ç»ˆè¿™å¥—ä½“ç³»å˜å¾—è¶Šæ¥è¶Šå®Œç¾Žã€ç¬¦åˆä½“ç³»çš„ç”Ÿæ€äº§å“ä¹Ÿè¶Šæ¥è¶Šå¤šã€‚ è¿™å¤§æ¦‚å°±æ˜¯javaæœ€å¼ºä¹‹å¤„å§ã€‚ æœ¬èŠ‚ä»‹ç»ä¸‹spring-bootçš„éªŒè¯ï¼Œå®ƒä¹Ÿæ˜¯åŸºäºŽjsrçš„validationä¹‹ä¸‹ã€‚ ä¾èµ–&lt;dependency> &lt;groupId>org.springframework.boot&lt;/groupId> &lt;artifactId>spring-boot-starter-web&lt;/artifactId> &lt;/dependency> &lt;dependency> &lt;groupId>org.springframework.boot&lt;/groupId> &lt;artifactId>spring-boot-starter-validation&lt;/artifactId> &lt;/dependency> &lt;dependency> &lt;groupId>javax.validation&lt;/groupId> &lt;artifactId>validation-api&lt;/artifactId> &lt;version>2.0.1.Final&lt;/version> &lt;type>jar&lt;/type> &lt;/dependency> javax.validation æ­£æ˜¯ jsrçš„è§„èŒƒã€‚ å®šä¹‰éªŒè¯è§„åˆ™@NotBlank(message = \"ç”¨æˆ·åä¸å¯ä¸ºç©º\") @NotNull(message = \"ä¸å¯ä¸ºç©º\") private String username; @NotBlank(message = \"å¯†ç ä¸å¯ä¸ºç©º\") @NotNull(message = \"å¯†ç ä¸å¯ä¸ºç©º\") private String pwd; controllerä½¿ç”¨public Response login(@Valid @RequestBody LoginInfo loginInfo, HttpServletRequest request, HttpSession session) &#123; &#125; è¿™é‡Œè¦å¯¹@Valid è¿›è¡Œä½¿ç”¨ å…¨å±€å¤„ç† @RestControllerAdvice public class ControllerAdvice &#123; /** * ConstraintViolationException */ @ExceptionHandler(MethodArgumentNotValidException.class) public Response handleConstraintViolationException(MethodArgumentNotValidException ex) &#123; Map&lt;String, String> errors = new HashMap&lt;>(); ex.getBindingResult().getAllErrors().forEach((error) -> &#123; String fieldName = ((FieldError) error).getField(); System.out.println(fieldName); String errorMessage = error.getDefaultMessage(); errors.put(fieldName, errorMessage); System.out.println(errorMessage); &#125;); return new Response(ResponseCode.parametrErrror, \"å‚æ•°é”™è¯¯\", errors); &#125; &#125; ç”±äºŽä½¿ç”¨@Validå¯¹å‚æ•°è¿›è¡Œæ ¡éªŒä¹‹åŽï¼Œå¦‚æžœæœ‰æ ¡éªŒä¸é€šè¿‡ä¼šæŠ›å‡ºä¸€ä¸ªMethodArgumentNotValidExceptionå¼‚å¸¸ã€‚å…¨å±€è¿›è¡Œæ•èŽ·ä¹‹åŽå¯ä»¥å…¨å±€å¤„ç†å‚æ•°ä¸æ­£ç¡®çš„æƒ…å†µã€‚ å‚è€ƒhttps://www.cnblogs.com/fqybzhangji/p/10384347.html","categories":[],"tags":[{"name":"spring-boot","slug":"spring-boot","permalink":"http://visonforcoding.xyz/tags/spring-boot/"}]},{"title":"IOCå’Œspringå¯¹å®ƒçš„å®žçŽ°","slug":"java/IOCå’Œspringå¯¹å®ƒçš„å®žçŽ°","date":"2020-09-09T13:10:50.000Z","updated":"2021-10-30T02:59:33.276Z","comments":true,"path":"2020/09/09/java/IOCå’Œspringå¯¹å®ƒçš„å®žçŽ°/","link":"","permalink":"http://visonforcoding.xyz/2020/09/09/java/IOC%E5%92%8Cspring%E5%AF%B9%E5%AE%83%E7%9A%84%E5%AE%9E%E7%8E%B0/","excerpt":"","text":"IOSæ¦‚è¿°https://www.cnblogs.com/DebugLZQ/archive/2013/06/05/3107957.html è¿™ç¯‡æ–‡ç« å·²ç»è®²çš„å¾ˆå¥½ã€‚ æˆ‘åšä¸‹æ€»ç»“ã€‚ é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ä¸–ç•Œï¼Œç¨‹åºä¹‹é—´çš„è€¦åˆä¸å¯é¿å…ï¼Œè€Œä¸”ä¼šä½¿å¾—ç³»ç»Ÿå˜å¾—éš¾ä»¥ç»´æŠ¤ IOCå°±æ˜¯ä¸ºäº†é™ä½Žè¿™ç§è€¦åˆ IOSä¹Ÿä¸æ˜¯å®Œç¾Žçš„ï¼Œæ‰€æœ‰äº‹æƒ…éƒ½æœ‰ä¼˜ç¼ºç‚¹ IOCå°±æ˜¯ä¸ºäº†æŠŠåŽŸæœ¬äº’ç›¸ä¹‹é—´æœ‰è€¦åˆåœ¨ä¸€èµ·ï¼Œä¼šé€ æˆç‰µä¸€å‘è€ŒåŠ¨å…¨èº«çš„çŽ°è±¡ã€‚é€šè¿‡å®¹å™¨è§£è€¦å¼€,å„è‡ªèƒ½ç‹¬ç«‹è¿ä½œã€‚ springçš„å®žçŽ°org.springframework.beans å’Œorg.springframework.context åŒ…æ˜¯Spring Framework çš„IoC å®¹å™¨çš„åŸºç¡€ã€‚ BeanFactory æŽ¥å£æä¾›é«˜çº§çš„é…ç½®æœºåˆ¶ï¼Œå¯ä»¥ç®¡ç†ä»»æ„ç±»åž‹çš„å¯¹è±¡ã€‚ ApplicationContext æ˜¯BeanFactory çš„å­æŽ¥å£ã€‚ å®ƒæ·»åŠ äº†å’ŒSpring çš„AOP ç‰¹æ€§å¾ˆç®€ä¾¿çš„æ•´åˆï¼› æ¶ˆæ¯èµ„æºå¤„ç†ï¼ˆç”¨äºŽå›½é™…åŒ–i18nï¼‰ï¼Œäº‹ä»¶å‘å¸ƒï¼› åº”ç”¨å±‚ç‰¹å®šçš„ä¸Šä¸‹æ–‡ï¼Œ æ¯”å¦‚ç”¨äºŽWeb åº”ç”¨ç¨‹åºçš„WebApplicationContextã€‚ æ€»ä¹‹ï¼ŒBeanFactory æä¾›äº†é…ç½®æ¡†æž¶å’ŒåŸºæœ¬åŠŸèƒ½ï¼Œè€ŒApplicationContext æ·»åŠ äº†æ›´å¤šä¼ä¸šçº§å¼€å‘ç‰¹å®šçš„åŠŸèƒ½ã€‚","categories":[],"tags":[{"name":"java","slug":"java","permalink":"http://visonforcoding.xyz/tags/java/"}]},{"title":"phpç¼–è¯‘å‚æ•°è¯¦è§£","slug":"php/phpç¼–è¯‘å‚æ•°è¯¦è§£","date":"2020-09-03T02:19:37.000Z","updated":"2021-10-30T02:59:33.280Z","comments":true,"path":"2020/09/03/php/phpç¼–è¯‘å‚æ•°è¯¦è§£/","link":"","permalink":"http://visonforcoding.xyz/2020/09/03/php/php%E7%BC%96%E8%AF%91%E5%8F%82%E6%95%B0%E8%AF%A6%E8%A7%A3/","excerpt":"å°½ç®¡ç»åŽ†äº†Næ¬¡çš„æ‰‹åŠ¨ç¼–è¯‘ï¼Œä½ å¯èƒ½è¿˜æ˜¯ä¸çŸ¥é“å“ªäº›ç¼–è¯‘å‚æ•°éœ€è¦å“ªäº›ä¸éœ€è¦","text":"å°½ç®¡ç»åŽ†äº†Næ¬¡çš„æ‰‹åŠ¨ç¼–è¯‘ï¼Œä½ å¯èƒ½è¿˜æ˜¯ä¸çŸ¥é“å“ªäº›ç¼–è¯‘å‚æ•°éœ€è¦å“ªäº›ä¸éœ€è¦ helpæ‰§è¡Œå¸®åŠ©å‘½ä»¤æŸ¥çœ‹ç¼–è¯‘é…ç½®å¸®åŠ© .&#x2F;configure --help&#x3D;short å¾—åˆ°ç»“æžœ Optional Features and Packages: --disable-option-checking ignore unrecognized --enable&#x2F;--with options --disable-FEATURE do not include FEATURE (same as --enable-FEATURE&#x3D;no) --enable-FEATURE[&#x3D;ARG] include FEATURE [ARG&#x3D;yes] --with-PACKAGE[&#x3D;ARG] use PACKAGE [ARG&#x3D;yes] --without-PACKAGE do not use PACKAGE (same as --with-PACKAGE&#x3D;no) --with-libdir&#x3D;NAME Look for libraries in ...&#x2F;NAME rather than ...&#x2F;lib --disable-rpath Disable passing additional runtime library search paths --enable-re2c-cgoto Enable -g flag to re2c to use computed goto gcc extension --disable-gcc-global-regs whether to enable GCC global register variables SAPI modules: --with-apxs2&#x3D;FILE Build shared Apache 2.0 Handler module. FILE is the optional pathname to the Apache apxs tool apxs --disable-cli Disable building CLI version of PHP (this forces --without-pear) --enable-embed&#x3D;TYPE EXPERIMENTAL: Enable building of embedded SAPI library TYPE is either &#39;shared&#39; or &#39;static&#39;. TYPE&#x3D;shared --enable-fpm Enable building of the fpm SAPI executable fastcgiè¿›ç¨‹ç®¡ç†,è¿™ä¸ªåº”è¯¥å¿…ä¸å¯å°‘ --with-fpm-user&#x3D;USER Set the user for php-fpm to run as. (default: nobody) --with-fpm-group&#x3D;GRP Set the group for php-fpm to run as. For a system user, this should usually be set to match the fpm username (default: nobody) --with-fpm-systemd Activate systemd integration --with-fpm-acl Use POSIX Access Control Lists --with-litespeed Build PHP as litespeed module --enable-phpdbg Build phpdbg --enable-phpdbg-webhelper Build phpdbg web SAPI support --enable-phpdbg-debug Build phpdbg in debug mode --enable-phpdbg-readline Enable readline support in phpdbg (depends on static ext&#x2F;readline) --disable-cgi Disable building CGI version of PHP ç¦ç”¨cgi --with-valgrind&#x3D;DIR Enable valgrind support General settings: --enable-gcov Enable GCOV code coverage (requires LTP) - FOR DEVELOPERS ONLY!! --enable-debug Compile with debugging symbols --with-layout&#x3D;TYPE Set how installed files will be laid out. Type can be either PHP or GNU [PHP] --with-config-file-path&#x3D;PATH Set the path in which to look for php.ini [PREFIX&#x2F;lib] --with-config-file-scan-dir&#x3D;PATH Set the path where to scan for configuration files --enable-sigchild Enable PHP&#39;s own SIGCHLD handler --enable-libgcc Enable explicitly linking against libgcc --disable-short-tags Disable the short-form &lt;? start tag by default --enable-dmalloc Enable dmalloc --disable-ipv6 Disable IPv6 support --enable-dtrace Enable DTrace support --enable-fd-setsize Set size of descriptor sets Extensions: --with-EXTENSION&#x3D;shared[,PATH] NOTE: Not all extensions can be build as &#39;shared&#39;. Example: --with-foobar&#x3D;shared,&#x2F;usr&#x2F;local&#x2F;foobar&#x2F; o Builds the foobar extension as shared extension. o foobar package install prefix is &#x2F;usr&#x2F;local&#x2F;foobar&#x2F; --disable-all Disable all extensions which are enabled by default --disable-libxml Disable LIBXML support --with-libxml-dir&#x3D;DIR LIBXML: libxml2 install prefix --with-openssl&#x3D;DIR Include OpenSSL support (requires OpenSSL &gt;&#x3D; 1.0.1) --with-kerberos&#x3D;DIR OPENSSL: Include Kerberos support --with-system-ciphers OPENSSL: Use system default cipher list instead of hardcoded value --with-pcre-regex&#x3D;DIR Include Perl Compatible Regular Expressions support. DIR is the PCRE install prefix BUNDLED --with-pcre-jit Enable PCRE JIT functionality (BUNDLED only) --with-pcre-valgrind&#x3D;DIR Enable PCRE valgrind support. Developers only! --without-sqlite3&#x3D;DIR Do not include SQLite3 support. DIR is the prefix to SQLite3 installation directory. --with-zlib&#x3D;DIR Include ZLIB support (requires zlib &gt;&#x3D; 1.2.0.4) --with-zlib-dir&#x3D;&lt;DIR&gt; Define the location of zlib install directory --enable-bcmath Enable bc style precision math functions --with-bz2&#x3D;DIR Include BZip2 support --enable-calendar Enable support for calendar conversion --disable-ctype Disable ctype functions --with-curl&#x3D;DIR Include cURL support --enable-dba Build DBA with bundled modules. To build shared DBA extension use --enable-dba&#x3D;shared --with-qdbm&#x3D;DIR DBA: QDBM support --with-gdbm&#x3D;DIR DBA: GDBM support --with-ndbm&#x3D;DIR DBA: NDBM support --with-db4&#x3D;DIR DBA: Oracle Berkeley DB 4.x or 5.x support --with-db3&#x3D;DIR DBA: Oracle Berkeley DB 3.x support --with-db2&#x3D;DIR DBA: Oracle Berkeley DB 2.x support --with-db1&#x3D;DIR DBA: Oracle Berkeley DB 1.x support&#x2F;emulation --with-dbm&#x3D;DIR DBA: DBM support --with-tcadb&#x3D;DIR DBA: Tokyo Cabinet abstract DB support --with-lmdb&#x3D;DIR DBA: Lightning memory-mapped database support --without-cdb&#x3D;DIR DBA: CDB support (bundled) --disable-inifile DBA: INI support (bundled) --disable-flatfile DBA: FlatFile support (bundled) --disable-dom Disable DOM support --with-libxml-dir&#x3D;DIR DOM: libxml2 install prefix --with-enchant&#x3D;DIR Include enchant support. GNU Aspell version 1.1.3 or higher required. --enable-exif Enable EXIF (metadata from images) support --disable-fileinfo Disable fileinfo support --disable-filter Disable input filter support --with-pcre-dir FILTER: pcre install prefix --enable-ftp Enable FTP support --with-openssl-dir&#x3D;DIR FTP: openssl install prefix --with-gd&#x3D;DIR Include GD support. DIR is the GD library base install directory BUNDLED --with-webp-dir&#x3D;DIR GD: Set the path to libwebp install prefix --with-jpeg-dir&#x3D;DIR GD: Set the path to libjpeg install prefix --with-png-dir&#x3D;DIR GD: Set the path to libpng install prefix --with-zlib-dir&#x3D;DIR GD: Set the path to libz install prefix --with-xpm-dir&#x3D;DIR GD: Set the path to libXpm install prefix --with-freetype-dir&#x3D;DIR GD: Set the path to FreeType 2 install prefix --enable-gd-jis-conv GD: Enable JIS-mapped Japanese font support --with-gettext&#x3D;DIR Include GNU gettext support --with-gmp&#x3D;DIR Include GNU MP support --with-mhash&#x3D;DIR Include mhash support --disable-hash Disable hash support --without-iconv&#x3D;DIR Exclude iconv support --with-imap&#x3D;DIR Include IMAP support. DIR is the c-client install prefix --with-kerberos&#x3D;DIR IMAP: Include Kerberos support. DIR is the Kerberos install prefix --with-imap-ssl&#x3D;DIR IMAP: Include SSL support. DIR is the OpenSSL install prefix --with-interbase&#x3D;DIR Include Firebird support. DIR is the Firebird base install directory &#x2F;opt&#x2F;firebird --enable-intl Enable internationalization support --with-icu-dir&#x3D;DIR Specify where ICU libraries and headers can be found --disable-json Disable JavaScript Object Serialization support --with-ldap&#x3D;DIR Include LDAP support --with-ldap-sasl&#x3D;DIR LDAP: Include Cyrus SASL support --enable-mbstring Enable multibyte string support --disable-mbregex MBSTRING: Disable multibyte regex support --disable-mbregex-backtrack MBSTRING: Disable multibyte regex backtrack check --with-libmbfl&#x3D;DIR MBSTRING: Use external libmbfl. DIR is the libmbfl base install directory BUNDLED --with-onig&#x3D;DIR MBSTRING: Use external oniguruma. DIR is the oniguruma install prefix. If DIR is not set, the bundled oniguruma will be used --with-mysqli&#x3D;FILE Include MySQLi support. FILE is the path to mysql_config. If no value or mysqlnd is passed as FILE, the MySQL native driver will be used --enable-embedded-mysqli MYSQLi: Enable embedded support Note: Does not work with MySQL native driver! --with-mysql-sock&#x3D;SOCKPATH MySQLi&#x2F;PDO_MYSQL: Location of the MySQL unix socket pointer. If unspecified, the default locations are searched --with-oci8&#x3D;DIR Include Oracle Database OCI8 support. DIR defaults to $ORACLE_HOME. Use --with-oci8&#x3D;instantclient,&#x2F;path&#x2F;to&#x2F;instant&#x2F;client&#x2F;lib to use an Oracle Instant Client installation --with-odbcver&#x3D;HEX Force support for the passed ODBC version. A hex number is expected, default 0x0350. Use the special value of 0 to prevent an explicit ODBCVER to be defined. --with-adabas&#x3D;DIR Include Adabas D support &#x2F;usr&#x2F;local --with-sapdb&#x3D;DIR Include SAP DB support &#x2F;usr&#x2F;local --with-solid&#x3D;DIR Include Solid support &#x2F;usr&#x2F;local&#x2F;solid --with-ibm-db2&#x3D;DIR Include IBM DB2 support &#x2F;home&#x2F;db2inst1&#x2F;sqllib --with-ODBCRouter&#x3D;DIR Include ODBCRouter.com support &#x2F;usr --with-empress&#x3D;DIR Include Empress support \\$EMPRESSPATH (Empress Version &gt;&#x3D; 8.60 required) --with-empress-bcs&#x3D;DIR Include Empress Local Access support \\$EMPRESSPATH (Empress Version &gt;&#x3D; 8.60 required) --with-birdstep&#x3D;DIR Include Birdstep support &#x2F;usr&#x2F;local&#x2F;birdstep --with-custom-odbc&#x3D;DIR Include user defined ODBC support. DIR is ODBC install base directory &#x2F;usr&#x2F;local. Make sure to define CUSTOM_ODBC_LIBS and have some odbc.h in your include dirs. f.e. you should define following for Sybase SQL Anywhere 5.5.00 on QNX, prior to running this configure script: CPPFLAGS&#x3D;\\&quot;-DODBC_QNX -DSQLANY_BUG\\&quot; LDFLAGS&#x3D;-lunix CUSTOM_ODBC_LIBS&#x3D;\\&quot;-ldblib -lodbc\\&quot; --with-iodbc&#x3D;DIR Include iODBC support &#x2F;usr&#x2F;local --with-esoob&#x3D;DIR Include Easysoft OOB support &#x2F;usr&#x2F;local&#x2F;easysoft&#x2F;oob&#x2F;client --with-unixODBC&#x3D;DIR Include unixODBC support &#x2F;usr&#x2F;local --with-dbmaker&#x3D;DIR Include DBMaker support --disable-opcache Disable Zend OPcache support --disable-opcache-file Disable file based caching --disable-huge-code-pages Disable copying PHP CODE pages into HUGE PAGES --enable-pcntl Enable pcntl support (CLI&#x2F;CGI only) --disable-pdo Disable PHP Data Objects support --with-pdo-dblib&#x3D;DIR PDO: DBLIB-DB support. DIR is the FreeTDS home directory --with-pdo-firebird&#x3D;DIR PDO: Firebird support. DIR is the Firebird base install directory &#x2F;opt&#x2F;firebird --with-pdo-mysql&#x3D;DIR PDO: MySQL support. DIR is the MySQL base directory If no value or mysqlnd is passed as DIR, the MySQL native driver will be used --with-zlib-dir&#x3D;DIR PDO_MySQL: Set the path to libz install prefix --with-pdo-oci&#x3D;DIR PDO: Oracle OCI support. DIR defaults to $ORACLE_HOME. Use --with-pdo-oci&#x3D;instantclient,&#x2F;path&#x2F;to&#x2F;instant&#x2F;client&#x2F;lib for an Oracle Instant Client installation. --with-pdo-odbc&#x3D;flavour,dir PDO: Support for &#39;flavour&#39; ODBC driver. include and lib dirs are looked for under &#39;dir&#39;. &#39;flavour&#39; can be one of: ibm-db2, iODBC, unixODBC, generic If &#39;,dir&#39; part is omitted, default for the flavour you have selected will be used. e.g.: --with-pdo-odbc&#x3D;unixODBC will check for unixODBC under &#x2F;usr&#x2F;local. You may attempt to use an otherwise unsupported driver using the \\&quot;generic\\&quot; flavour. The syntax for generic ODBC support is: --with-pdo-odbc&#x3D;generic,dir,libname,ldflags,cflags When built as &#39;shared&#39; the extension filename is always pdo_odbc.so --with-pdo-pgsql&#x3D;DIR PDO: PostgreSQL support. DIR is the PostgreSQL base install directory or the path to pg_config --without-pdo-sqlite&#x3D;DIR PDO: sqlite 3 support. DIR is the sqlite base install directory BUNDLED --with-pgsql&#x3D;DIR Include PostgreSQL support. DIR is the PostgreSQL base install directory or the path to pg_config --disable-phar Disable phar support --disable-posix Disable POSIX-like functions --with-pspell&#x3D;DIR Include PSPELL support. GNU Aspell version 0.50.0 or higher required --with-libedit&#x3D;DIR Include libedit readline replacement (CLI&#x2F;CGI only) --with-readline&#x3D;DIR Include readline support (CLI&#x2F;CGI only) --with-recode&#x3D;DIR Include recode support --disable-session Disable session support --with-mm&#x3D;DIR SESSION: Include mm support for session storage --enable-shmop Enable shmop support --disable-simplexml Disable SimpleXML support --with-libxml-dir&#x3D;DIR SimpleXML: libxml2 install prefix --with-snmp&#x3D;DIR Include SNMP support --with-openssl-dir&#x3D;DIR SNMP: openssl install prefix --enable-soap Enable SOAP support --with-libxml-dir&#x3D;DIR SOAP: libxml2 install prefix --enable-sockets Enable sockets support --with-sodium&#x3D;DIR Include sodium support --with-password-argon2&#x3D;DIR Include Argon2 support in password_*. DIR is the Argon2 shared library path] --enable-sysvmsg Enable sysvmsg support --enable-sysvsem Enable System V semaphore support --enable-sysvshm Enable the System V shared memory support --with-tidy&#x3D;DIR Include TIDY support --disable-tokenizer Disable tokenizer support --enable-wddx Enable WDDX support --with-libxml-dir&#x3D;DIR WDDX: libxml2 install prefix --with-libexpat-dir&#x3D;DIR WDDX: libexpat dir for XMLRPC-EPI (deprecated) --disable-xml Disable XML support --with-libxml-dir&#x3D;DIR XML: libxml2 install prefix --with-libexpat-dir&#x3D;DIR XML: libexpat install prefix (deprecated) --disable-xmlreader Disable XMLReader support --with-libxml-dir&#x3D;DIR XMLReader: libxml2 install prefix --with-xmlrpc&#x3D;DIR Include XMLRPC-EPI support --with-libxml-dir&#x3D;DIR XMLRPC-EPI: libxml2 install prefix --with-libexpat-dir&#x3D;DIR XMLRPC-EPI: libexpat dir for XMLRPC-EPI (deprecated) --with-iconv-dir&#x3D;DIR XMLRPC-EPI: iconv dir for XMLRPC-EPI --disable-xmlwriter Disable XMLWriter support --with-libxml-dir&#x3D;DIR XMLWriter: libxml2 install prefix --with-xsl&#x3D;DIR Include XSL support. DIR is the libxslt base install directory (libxslt &gt;&#x3D; 1.1.0 required) --enable-zend-test Enable zend-test extension --enable-zip Include Zip read&#x2F;write support --with-zlib-dir&#x3D;DIR ZIP: Set the path to libz install prefix --with-pcre-dir ZIP: pcre install prefix --with-libzip&#x3D;DIR ZIP: use libzip --enable-mysqlnd Enable mysqlnd explicitly, will be done implicitly when required by other extensions --disable-mysqlnd-compression-support Disable support for the MySQL compressed protocol in mysqlnd --with-zlib-dir&#x3D;DIR mysqlnd: Set the path to libz install prefix PEAR: --with-pear&#x3D;DIR Install PEAR in DIR [PREFIX&#x2F;lib&#x2F;php] --without-pear Do not install PEAR Zend: --enable-maintainer-zts Enable thread safety - for code maintainers only!! --disable-inline-optimization If building zend_execute.lo fails, try this switch --disable-zend-signals whether to enable zend signal handling TSRM: --with-tsrm-pth&#x3D;pth-config Use GNU Pth --with-tsrm-st Use SGI&#39;s State Threads --with-tsrm-pthreads Use POSIX threads (default) Libtool: --enable-shared&#x3D;PKGS Build shared libraries default&#x3D;yes --enable-static&#x3D;PKGS Build static libraries default&#x3D;yes --enable-fast-install&#x3D;PKGS Optimize for fast installation default&#x3D;yes --with-gnu-ld Assume the C compiler uses GNU ld default&#x3D;no --disable-libtool-lock Avoid locking (might break parallel builds) --with-pic Try to use only PIC&#x2F;non-PIC objects default&#x3D;use both --with-tags&#x3D;TAGS Include additional configurations automatic Some influential environment variables: CC C compiler command CFLAGS C compiler flags LDFLAGS linker flags, e.g. -L&lt;lib dir&gt; if you have libraries in a nonstandard directory &lt;lib dir&gt; LIBS libraries to pass to the linker, e.g. -l&lt;library&gt; CPPFLAGS (Objective) C&#x2F;C++ preprocessor flags, e.g. -I&lt;include dir&gt; if you have headers in a nonstandard directory &lt;include dir&gt; CPP C preprocessor YACC The &#96;Yet Another Compiler Compiler&#39; implementation to use. Defaults to the first program found out of: &#96;bison -y&#39;, &#96;byacc&#39;, &#96;yacc&#39;. YFLAGS The list of arguments that will be passed by default to $YACC. This script will default YFLAGS to the empty string to avoid a default value of &#96;-d&#39; given by some make applications. CXX C++ compiler command CXXFLAGS C++ compiler flags CXXCPP C++ preprocessor Use these variables to override the choices made by &#96;configure&#39; or to help it to find libraries and programs with nonstandard names&#x2F;locations. é»˜è®¤æ‹“å±•å½“ä¸é…ç½®ä»»ä½•å‚æ•°æ—¶ï¼Œå®ƒé»˜è®¤ä¼šæœ‰å“ªäº›æ‹“å±•å‘¢ï¼Ÿ php -m [PHP Modules] Core ctype date dom fileinfo filter hash iconv json libxml pcre PDO pdo_sqlite Phar posix Reflection session SimpleXML SPL sqlite3 standard tokenizer xml xmlreader xmlwriter [Zend Modules] æ­¤æ—¶ä½ ä¼šå‘çŽ°è¿žphp-fpméƒ½æ²¡æœ‰ å¸¸ç”¨é…ç½®ä¾èµ–å®‰è£…yum install -y libxml2-devel openssl-devel .&#x2F;configure --enable-fpm --enable-bcmath --with-openssl \\ --enable-mbstring --with-mysqli --enable-mysqlnd ç¼–è¯‘å®‰è£…make &amp;&amp; make install å¯åŠ¨æŸ¥çœ‹inié…ç½®php -ini | grep &#39;ini&#39; Configuration File (php.ini) Path &#x3D;&gt; &#x2F;usr&#x2F;local&#x2F;lib Loaded Configuration File &#x3D;&gt; &#x2F;usr&#x2F;local&#x2F;lib&#x2F;php.ini Scan this dir for additional .ini files &#x3D;&gt; (none) Additional .ini files parsed &#x3D;&gt; (none) user_ini.cache_ttl &#x3D;&gt; 300 &#x3D;&gt; 300 user_ini.filename &#x3D;&gt; .user.ini &#x3D;&gt; .user.ini init_command_executed_count &#x3D;&gt; 0 init_command_failed_count &#x3D;&gt; 0 com_init_db &#x3D;&gt; 0 ä»Žæºä»£ç ç›®å½• å¤åˆ¶é…ç½®æ–‡ä»¶åˆ°Configuration File (php.ini) Path cp php.ini-production &#x2F;usr&#x2F;local&#x2F;lib&#x2F;php.ini è®¾ç½®æœåŠ¡&amp;å¼€æœºå¯åŠ¨(centos 7+)æœåŠ¡æœåŠ¡è„šæœ¬åˆ°systemd cp sapi&#x2F;fpm&#x2F;php-fpm.service &#x2F;etc&#x2F;systemd&#x2F;system&#x2F; æŸ¥çœ‹å¯åŠ¨è„šæœ¬ cat sapi&#x2F;fpm&#x2F;php-fpm.service ç»“æžœ # It&#39;s not recommended to modify this file in-place, because it # will be overwritten during upgrades. If you want to customize, # the best way is to use the &quot;systemctl edit&quot; command. [Unit] Description&#x3D;The PHP FastCGI Process Manager After&#x3D;network.target [Service] Type&#x3D;simple PIDFile&#x3D;&#x2F;usr&#x2F;local&#x2F;var&#x2F;run&#x2F;php-fpm.pid ExecStart&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin&#x2F;php-fpm --nodaemonize --fpm-config &#x2F;usr&#x2F;local&#x2F;etc&#x2F;php-fpm.conf ExecReload&#x3D;&#x2F;bin&#x2F;kill -USR2 $MAINPID PrivateTmp&#x3D;true [Install] WantedBy&#x3D;multi-user.target é…ç½®cp sapi&#x2F;fpm&#x2F;php-fpm.conf &#x2F;usr&#x2F;local&#x2F;etc&#x2F;php-fpm.conf ä¿®æ”¹php-fpm.conf ç›¸åº”é…ç½®ä½¿å¾—PIDFileæ–‡ä»¶ä½ç½®ä¸Žphp-fpm.serviceé…ç½®çš„ä¸€è‡´ã€‚å¹¶å¤åˆ¶www.confåˆ°å¯¹åº”ç›®å½• å¯åŠ¨systemctl daemon-reload systemctl start php-fpm.service systemctl status php-fpm.service systemctl enable php-fpm.service","categories":[],"tags":[{"name":"php","slug":"php","permalink":"http://visonforcoding.xyz/tags/php/"}]},{"title":"supervisorä½¿ç”¨","slug":"supervisorä½¿ç”¨","date":"2020-09-02T02:50:48.000Z","updated":"2021-10-30T02:59:33.281Z","comments":true,"path":"2020/09/02/supervisorä½¿ç”¨/","link":"","permalink":"http://visonforcoding.xyz/2020/09/02/supervisor%E4%BD%BF%E7%94%A8/","excerpt":"ä½œä¸ºä¸€æ¬¾è¿›ç¨‹ç®¡ç†å·¥å…·ï¼Œsupervisoræ™®éç”¨æ¥ç®¡ç†åº”ç”¨çš„å®ˆæŠ¤è¿›ç¨‹","text":"ä½œä¸ºä¸€æ¬¾è¿›ç¨‹ç®¡ç†å·¥å…·ï¼Œsupervisoræ™®éç”¨æ¥ç®¡ç†åº”ç”¨çš„å®ˆæŠ¤è¿›ç¨‹ å®‰è£…å¸¸è§„å®‰è£…çš„æ–¹å¼æœ‰ä¸¤ç§,pipå®‰è£…æˆ–å‘è¡Œç‰ˆå®‰è£… ä»¥centos 8ä¸ºpipå®‰è£…æ–¹å¼ä¸ºä¾‹ã€‚ pipå®‰è£…pip install supervisor è¿è¡Œé…ç½®æ–‡ä»¶echo_supervisord_conf &gt; &#x2F;etc&#x2F;supervisord.conf ç”Ÿæˆé…ç½®æ–‡ä»¶ é…ç½®systemdæœåŠ¡å¦‚æžœæ˜¯å‘è¡Œç‰ˆå®‰è£…ï¼Œé»˜è®¤ä¼šé…ç½®å¥½å¼€æœºå¯åŠ¨æœåŠ¡ã€‚å¦‚æžœéžå‘è¡Œç‰ˆå®‰è£…ï¼Œå¯ä»¥æ‰‹åŠ¨é…ç½®ã€‚ There are user-contributed scripts for various operating systems at: https://github.com/Supervisor/initscripts æ³¨æ„ï¼Œäº‹å®žä¸Šgithubä¸Šçš„è„šæœ¬æœ‰ç‚¹é—®é¢˜ï¼Œä¸Žå®žé™…å®‰è£…çš„ç›®å½•ä½ç½®ä¸åŒ¹é…ã€‚ç¨ä½œä¿®æ”¹ # supervisord service for systemd (CentOS 7.0+) # by ET-CS (https://github.com/ET-CS) [Unit] Description=Supervisor daemon [Service] Type=forking ExecStart=/usr/local/bin/supervisord ExecStop=/usr/local/bin/supervisorctl $OPTIONS shutdown ExecReload=/usr/local/bin/supervisorctl $OPTIONS reload KillMode=process Restart=on-failure RestartSec=42s [Install] WantedBy=multi-user.target å°†æ­¤æ–‡ä»¶ä¸ºä¿å­˜ä¸º vim /etc/systemd/system/supervisord.service å¯åŠ¨æœåŠ¡é‡æ–°è¯»å–æ‰€æœ‰æœåŠ¡é¡¹ systemctl daemon-reload å¯åŠ¨æœåŠ¡ systemctl start supervisord.service å¼€æœºå¯åŠ¨ systemctl enable supervisord.service ä½¿ç”¨å¯ç”¨å­é…ç½®ç›®å½•vim /etc/supervisord.confæœ€åŽ2è¡Œæ‰“å¼€æ³¨é‡Šå¹¶ç¼–è¾‘ä¸º [include] files &#x3D; .&#x2F;supervisord.d&#x2F;*.ini é‡å¯ systemctl reload supervisord.service # æˆ–è€… supervisorctl reload æ·»åŠ é¡¹ç›®vim /etc/supervisord.d/glances.ini [program:glances] command=glances --export influxdb -q process_name=%(program_name)s numprocs=1 directory=/tmp umask=022 priority=999 autostart=true autorestart=unexpected startsecs=10 startretries=3 exitcodes=0 stopsignal=TERM stopwaitsecs=10 stopasgroup=false killasgroup=false user=root redirect_stderr=false stdout_logfile=/var/log/glances/glances-out.log stdout_logfile_maxbytes=1MB stdout_logfile_backups=10 stdout_capture_maxbytes=1MB stdout_events_enabled=false stderr_logfile=/var/log/glances/glances-err.log stderr_logfile_maxbytes=1MB stderr_logfile_backups=10 stderr_capture_maxbytes=1MB æ³¨æ„å…ˆå»ºå¥½ç›®å½• /var/log/glances é‡æ–°è¯»å–é…ç½®å¹¶å¯ç”¨supervisorctl reload supervisorctl start glances å¯æŸ¥çœ‹è¿è¡ŒçŠ¶æ€supervisorctl status ç»“æžœ glances RUNNING pid 46026, uptime 0:05:05","categories":[],"tags":[{"name":"è¿ç»´","slug":"è¿ç»´","permalink":"http://visonforcoding.xyz/tags/%E8%BF%90%E7%BB%B4/"}]},{"title":"mysqlå­—ç¬¦é›†é—®é¢˜","slug":"mysqlå­—ç¬¦é›†é—®é¢˜","date":"2020-09-01T11:01:33.000Z","updated":"2021-10-30T02:59:33.278Z","comments":true,"path":"2020/09/01/mysqlå­—ç¬¦é›†é—®é¢˜/","link":"","permalink":"http://visonforcoding.xyz/2020/09/01/mysql%E5%AD%97%E7%AC%A6%E9%9B%86%E9%97%AE%E9%A2%98/","excerpt":"çŽ°ä»£äº§å“å’Œå›½é™…åŒ–äº§å“å»ºè®®éƒ½ä½¿ç”¨utf8mb4å­—ç¬¦é›†ï¼Œè¡¨æƒ…å·²æ— å¤„ä¸åœ¨ðŸ¤–ðŸ¦–ã€‚äººç”Ÿè‹¦çŸ­å»ºè®®mb4.","text":"çŽ°ä»£äº§å“å’Œå›½é™…åŒ–äº§å“å»ºè®®éƒ½ä½¿ç”¨utf8mb4å­—ç¬¦é›†ï¼Œè¡¨æƒ…å·²æ— å¤„ä¸åœ¨ðŸ¤–ðŸ¦–ã€‚äººç”Ÿè‹¦çŸ­å»ºè®®mb4. mysql å¯ä»¥è®¾ç½®æ•°æ®åº“çº§åˆ«ï¼Œè¡¨çº§åˆ«ï¼Œåˆ—çº§åˆ« å­—ç¬¦é›†ç¼–ç ï¼›æŽ§åˆ¶ç²’åº¦ä¾æ¬¡ç»†åŒ–ï¼Œä¹Ÿå°±æ˜¯å¦‚æžœéƒ½è®¾ç½®äº†ï¼Œåˆ—çº§åˆ«ä¼˜å…ˆçº§æœ€é«˜ã€‚ å®šä¹‰æ•°æ®è¡¨ç»“æž„æ—¶å»ºè®®ä¸è¦å®šä¹‰åˆ—çš„å­—ç¬¦é›†ï¼Œä»¥å…å°†æ¥ä¿®æ”¹å˜å¾—éº»çƒ¦ã€‚ ä¿®æ”¹è¡¨çš„å­—ç¬¦é›†ä¿®æ”¹è¡¨çš„å­—ç¬¦é›† å¹¶åˆ·æ–°ä¹‹å‰å·²å­˜åœ¨çš„æ•°æ®ALTER table table_name CONVERT to CHARACTER set æ–°çš„å­—ç¬¦é›†; ä¿®æ”¹è¡¨çš„å­—ç¬¦é›†ï¼Œä½†ä¸å¯¹ä¹‹å‰å·²å­˜åœ¨çš„æ•°æ®åˆ·æ–°ALTER table table_name DEFAULT to CHARACTER set æ–°çš„å­—ç¬¦é›†; æ‰¹é‡ä¿®æ”¹SELECT CONCAT( 'ALTER TABLE ', TABLE_NAME, ' CONVERT TO CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;' ) FROM information_schema.`TABLES` WHERE TABLE_SCHEMA = 'DATABASE_NAME'; å¾—åˆ°ä¿®æ”¹è¯­å¥ï¼Œå¤åˆ¶å‡ºæ‰§è¡Œè¯­å¥ï¼Œè¿›è¡Œæ‰§è¡Œã€‚å¦‚æžœæ•°æ®åº“æ•°æ®è¾ƒå¤šï¼Œå°†ä¼šæ¯”è¾ƒè€—æ—¶ã€‚ å¦‚æžœåªæ˜¯ä¿®æ”¹é»˜è®¤å­—ç¬¦é›†ä¸ä¿®æ”¹æ•°æ®ã€‚ SELECT CONCAT( 'ALTER TABLE ', TABLE_NAME, ' DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;' ) FROM information_schema.`TABLES` WHERE TABLE_SCHEMA = 'DATABASE_NAME'; è¿™æ ·æ‰§è¡Œåº”è¯¥è¾ƒä¸ºå®‰å…¨ï¼Œä¹Ÿæ»¡è¶³ä¸€èˆ¬éœ€æ±‚ã€‚","categories":[],"tags":[{"name":"mysql","slug":"mysql","permalink":"http://visonforcoding.xyz/tags/mysql/"}]},{"title":"javaå¼€å‘çŽ¯å¢ƒå‡†å¤‡","slug":"java/macä¸‹ä½¿ç”¨openjdk-11","date":"2020-08-27T03:41:07.000Z","updated":"2021-11-26T02:58:45.143Z","comments":true,"path":"2020/08/27/java/macä¸‹ä½¿ç”¨openjdk-11/","link":"","permalink":"http://visonforcoding.xyz/2020/08/27/java/mac%E4%B8%8B%E4%BD%BF%E7%94%A8openjdk-11/","excerpt":"JDKæœ€è¿‘ä¼¼ä¹Žjava 8ä»¥ä¸Šçš„ç‰ˆæœ¬éƒ½ä¸èƒ½ä»Žoracleå®˜ç½‘ä¸‹è½½äº†ï¼ŒäºŽæ˜¯å°±å°è¯•ä½¿ç”¨open jdk11","text":"JDKæœ€è¿‘ä¼¼ä¹Žjava 8ä»¥ä¸Šçš„ç‰ˆæœ¬éƒ½ä¸èƒ½ä»Žoracleå®˜ç½‘ä¸‹è½½äº†ï¼ŒäºŽæ˜¯å°±å°è¯•ä½¿ç”¨open jdk11 ä¸‹è½½å¯ä»¥ä»Ž https://mirrors.huaweicloud.com/openjdk/ ä¸‹è½½å¾—åˆ° macå®‰è£…sudo mv &#x2F;Downloads&#x2F;jdk11 &#x2F;Library&#x2F;Java&#x2F;JavaVirtualMachines&#x2F;jdk-11.jdk linuxé…ç½®bash_profile vim ~/.bash_profile JAVA_HOME&#x3D;&quot;&#x2F;usr&#x2F;local&#x2F;jdk-11.0.2&quot; PATH&#x3D;$PATH:$HOME&#x2F;bin:$JAVA_HOME&#x2F;bin export PATH mavenæºç å®‰è£…Maven ä¸‹è½½åœ°å€ï¼šhttp://maven.apache.org/download.cgi mac brew å®‰è£…brew install maven","categories":[],"tags":[{"name":"java","slug":"java","permalink":"http://visonforcoding.xyz/tags/java/"}]},{"title":"glances+influxdb+granfanaæ‰“é€ æœåŠ¡å™¨ç›‘æŽ§ç³»ç»Ÿ","slug":"glances-influxdb-granfanaæ‰“é€ æœåŠ¡å™¨ç›‘æŽ§ç³»ç»Ÿ","date":"2020-08-25T09:56:32.000Z","updated":"2021-10-30T02:59:33.275Z","comments":true,"path":"2020/08/25/glances-influxdb-granfanaæ‰“é€ æœåŠ¡å™¨ç›‘æŽ§ç³»ç»Ÿ/","link":"","permalink":"http://visonforcoding.xyz/2020/08/25/glances-influxdb-granfana%E6%89%93%E9%80%A0%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F/","excerpt":"æœåŠ¡ç›‘æŽ§å°±æ˜¯ä½ çš„çœ¼ç›ï¼Œå½“ä½ å¯¹æœåŠ¡å™¨è¿è¡ŒçŠ¶å†µä¸€æ— æ‰€çŸ¥æ—¶ï¼Œä½ åº”è¯¥æ„Ÿåˆ°åç«‹ä¸å®‰ã€‚","text":"æœåŠ¡ç›‘æŽ§å°±æ˜¯ä½ çš„çœ¼ç›ï¼Œå½“ä½ å¯¹æœåŠ¡å™¨è¿è¡ŒçŠ¶å†µä¸€æ— æ‰€çŸ¥æ—¶ï¼Œä½ åº”è¯¥æ„Ÿåˆ°åç«‹ä¸å®‰ã€‚ glanceså®‰è£…glancesæ˜¯ç”±pythonç¼–å†™çš„ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨pipç›´æŽ¥å®‰è£… pip3 install glances influxdbå®‰è£…wget https:&#x2F;&#x2F;dl.influxdata.com&#x2F;influxdb&#x2F;releases&#x2F;influxdb-1.8.2.x86_64.rpm sudo yum localinstall influxdb-1.8.2.x86_64.rpm æ”¶é›†æ•°æ®åˆ°influxdbé…ç½® glances vim /etc/glances/glances.conf [influxdb] # Configuration for the --export influxdb option # https://influxdb.com/ host=localhost port=8086 user=root password=root db=glances prefix=localhost #tags=foo:bar,spam:eggs pip3 install influxdb glances --export influxdb æ‰§è¡Œ glances --export influxdb æµ‹è¯•ä¸‹ï¼ŒæŠ¥é”™ InfluxDB database &#39;glances&#39; did not exist. Please create itéœ€è¦æ–°å»ºæ•°æ®åº“ã€‚ æ‰§è¡Œshell influx CREATE DATABASE glances #åˆ›å»ºæ•°æ® SHOW DATABASES # æŸ¥çœ‹æ•°æ®åº“ å†æ¬¡æ‰§è¡Œglances --export influxdb ,å¯æ˜¾ç¤ºå¦‚ä¸‹ä»£è¡¨ç›®å‰ä¸€åˆ‡æ­£å¸¸ ä½œä¸ºæœåŠ¡è¿è¡Œæ­¤æ—¶æˆ‘ä»¬éœ€è¦ç¼–å†™.serviceè„šæœ¬ä½œä¸ºæœåŠ¡åŽå°è¿è¡Œ [Unit] Description&#x3D;glances daemon After&#x3D;network.target influxdb.service [Service] User&#x3D;root Group&#x3D;root ExecStart&#x3D;&#x2F;usr&#x2F;local&#x2F;bin&#x2F;glances --quiet --export influxdb Type&#x3D;simple KillMode&#x3D;process [Install] WantedBy&#x3D;multi-user.target å‘½åè¯¥æ–‡ä»¶ä¸ºglances.serviceå¹¶æ”¾åˆ°/usr/lib/systemd/systemç›®å½•ä¸‹ systemctl start glances å¯åŠ¨ æ›´å¤šçš„ serviceè„šæœ¬ç¼–å†™å¯å‚è€ƒï¼Œhttp://www.jinbuguo.com/systemd/systemd.service.html granfanaå®‰è£…wget https:&#x2F;&#x2F;dl.grafana.com&#x2F;oss&#x2F;release&#x2F;grafana-7.1.5-1.x86_64.rpm sudo yum install grafana-7.1.5-1.x86_64.rpm å¯åŠ¨systemctl daemon-reload systemctl start grafana-server systemctl status grafana-server systemctl enable grafana-server.service docker-granfanaå®‰è£…# docker-compose.yml version: \"3.1\" services: grafana: image: grafana/grafana:5.1.0 ports: - 3001:3000 environment: - GF_SECURITY_ADMIN_PASSWORD__FILE=/run/secrets/granfa_admin_pwd # 5.2.0ä¹‹åŽæ‰å¯ç”¨ nginxé…ç½® server &#123; listen 80; server_name grafana-dev.domain.cn; #charset koi8-r; location &#x2F; &#123; proxy_pass http:&#x2F;&#x2F;127.0.0.1:3001; proxy_http_version 1.1; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection &quot;upgrade&quot;; &#125; &#125; å°±å¯ä»¥åœ¨webä¸Šè¿›è¡Œè®¿é—®,åˆå§‹çš„è´¦å·å¯†ç éƒ½æ˜¯admin é…ç½®æ•°æ®æº dockerå®‰è£…æƒ…å†µåº”æ³¨æ„dockerå®¹å™¨ip å’Œå®¿ä¸»æœºip docker network ls # æŸ¥çœ‹dockerç½‘ç»œ docker network inspect $networkid # æŸ¥çœ‹å…·ä½“ç½‘ç»œä¿¡æ¯ åœ¨é…ç½®influxdb æ•°æ®æºæ—¶ï¼Œå¦‚æžœä½ æ˜¯ç”¨dockerå®‰è£…ï¼Œéœ€è¦ä¿æŒgranfanaå’Œinfluxdbæ˜¯åœ¨åŒä¸€ä¸ªç½‘æ®µ æ·»åŠ ä¸€ä¸ªçœ‹æ¿ grafana è¿˜æ”¯æŒzipkin","categories":[],"tags":[{"name":"devops","slug":"devops","permalink":"http://visonforcoding.xyz/tags/devops/"}]},{"title":"vuetifyjså›¾æ ‡è§£å†³æ–¹æ¡ˆ","slug":"web/vuetifyjså›¾æ ‡è§£å†³æ–¹æ¡ˆ","date":"2020-08-24T02:24:41.000Z","updated":"2021-10-30T02:59:33.282Z","comments":true,"path":"2020/08/24/web/vuetifyjså›¾æ ‡è§£å†³æ–¹æ¡ˆ/","link":"","permalink":"http://visonforcoding.xyz/2020/08/24/web/vuetifyjs%E5%9B%BE%E6%A0%87%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/","excerpt":"vuetifyjså®˜æ–¹æä¾›çš„æ–¹æ³•å®žé™…è¿ç”¨å½“ä¸­ä¼¼ä¹Žä¼šå­˜åœ¨ä¸€äº›å…¼å®¹é—®é¢˜ï¼Œæ¯”å¦‚ä½¿ç”¨Font Awesomeæ—¶æœ‰äº›å›¾æ ‡å°±ä¸ä¼šæ­£å¸¸æ˜¾ç¤ºã€‚","text":"vuetifyjså®˜æ–¹æä¾›çš„æ–¹æ³•å®žé™…è¿ç”¨å½“ä¸­ä¼¼ä¹Žä¼šå­˜åœ¨ä¸€äº›å…¼å®¹é—®é¢˜ï¼Œæ¯”å¦‚ä½¿ç”¨Font Awesomeæ—¶æœ‰äº›å›¾æ ‡å°±ä¸ä¼šæ­£å¸¸æ˜¾ç¤ºã€‚ Font Awesome&lt;!-- å®˜æ–¹ --> &lt;v-icon>fas fa-php&lt;/v-icon> &lt;!-- æ›¿ä»£ --> &lt;i class=\"fab fa-php v-icon\">&lt;/i> æœ‰äº›å›¾æ ‡ä¸æ˜¾ç¤ºçš„é—®é¢˜å¯ä»¥ä½¿ç”¨ä¸Šè¿°æ–¹æ³•æ›¿ä»£è§£å†³ ä½¿ç”¨é˜¿é‡Œå·´å·´å­—ä½“é˜¿é‡Œå·´å·´å­—ä½“éžå¸¸å¤šéžå¸¸åºžå¤§ï¼ŒåŸºæœ¬æƒ³è¦çš„éƒ½æœ‰ï¼Œè€Œå›½å¤–çš„å¾ˆå¤šä¸èƒ½ç”¨ã€‚æ‰€ä»¥å¯ä»¥ä½¿ç”¨é˜¿é‡Œå·´å·´å­—ä½“æ›¿ä»£ã€‚ ç¬¬ä¸€æ­¥ï¼šæ‹·è´é¡¹ç›®ä¸‹é¢ç”Ÿæˆçš„fontclassä»£ç ï¼š å¯ä»¥åœ¨public/index.html ä¸‹ç”¨ link æ ‡ç­¾å¼•å…¥ //at.alicdn.com/t/font_8d5l8fzk5b87iudi.css ç¬¬äºŒæ­¥ï¼šæŒ‘é€‰ç›¸åº”å›¾æ ‡å¹¶èŽ·å–ç±»åï¼Œåº”ç”¨äºŽé¡µé¢ï¼š &lt;i class=\"iconfont icon-xxx\">&lt;/i>","categories":[],"tags":[{"name":"webå‰ç«¯","slug":"webå‰ç«¯","permalink":"http://visonforcoding.xyz/tags/web%E5%89%8D%E7%AB%AF/"}]},{"title":"gunicorn+flask_restæž„å»ºéƒ¨ç½²è½»é‡çº§apiæœåŠ¡","slug":"python/gunicorn-flask-restæž„å»ºéƒ¨ç½²è½»é‡çº§apiæœåŠ¡","date":"2020-08-20T07:51:30.000Z","updated":"2021-10-30T02:59:33.281Z","comments":true,"path":"2020/08/20/python/gunicorn-flask-restæž„å»ºéƒ¨ç½²è½»é‡çº§apiæœåŠ¡/","link":"","permalink":"http://visonforcoding.xyz/2020/08/20/python/gunicorn-flask-rest%E6%9E%84%E5%BB%BA%E9%83%A8%E7%BD%B2%E8%BD%BB%E9%87%8F%E7%BA%A7api%E6%9C%8D%E5%8A%A1/","excerpt":"","text":"flask ç»“æž„é¦–å…ˆç®€å•çœ‹çœ‹ flask_restçš„ç›®å½•ç»“æž„ã€‚ å…¥å£æ–‡ä»¶#app.py from flask import Flask from flask_restful import Resource, Api from resources.bd import Index,Format from flask_cors import CORS # from common import config app = Flask(__name__) CORS(app) api = Api(app) api.add_resource(Format, '/bd/format') # if __name__ == '__main__': # app.run(debug=True) å¦‚æžœä½¿ç”¨gunicornå¯åŠ¨ï¼Œåˆ™æ³¨é‡ŠæŽ‰app.run gunicornå¯åŠ¨é…ç½®# config.py import os import gevent.monkey gevent.monkey.patch_all() import multiprocessing debug = True loglevel = 'debug' bind = \"0.0.0.0:5000\" pidfile = \"logs/gunicorn.pid\" accesslog = \"logs/access.log\" errorlog = \"logs/debug.log\" daemon = True # å¯åŠ¨çš„è¿›ç¨‹æ•° workers = multiprocessing.cpu_count() worker_class = 'gevent' x_forwarded_for_header = 'X-FORWARDED-FOR' å¯åŠ¨python3 -m venv webpj source webpj/bin/activate pip install -r requirements.txt -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host mirrors.aliyun.com pip install xlrd -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host mirrors.aliyun.com pip install openpyxl -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host mirrors.aliyun.com gunicorn -c config.py app:app å¹³æ»‘é‡å¯cat logs/gunicorn.pid | xargs kill -HUP","categories":[],"tags":[{"name":"python","slug":"python","permalink":"http://visonforcoding.xyz/tags/python/"}]},{"title":"pandasæ•°æ®å¿«é€Ÿå¤„ç†","slug":"pandasæ•°æ®å¿«é€Ÿå¤„ç†","date":"2020-07-31T04:24:15.000Z","updated":"2021-10-30T02:59:33.279Z","comments":true,"path":"2020/07/31/pandasæ•°æ®å¿«é€Ÿå¤„ç†/","link":"","permalink":"http://visonforcoding.xyz/2020/07/31/pandas%E6%95%B0%E6%8D%AE%E5%BF%AB%E9%80%9F%E5%A4%84%E7%90%86/","excerpt":"é”€å”®åŒäº‹æ‹¿åˆ°ä¸€ä»½æ•°æ®ï¼Œä½†æ˜¯æ•°æ®å¯¼å‡ºåˆ—æ˜¯json,æˆ‘é¡ºæ‰‹å°±å¸®ä»–å¤„ç†äº†ä¸‹ã€‚ä¸å¾—ä¸è¯´ pandasåœ¨å¤„ç†è¿™ç±»é—®é¢˜è¿˜æ˜¯éžå¸¸æ•ˆçŽ‡é«˜çš„.","text":"é”€å”®åŒäº‹æ‹¿åˆ°ä¸€ä»½æ•°æ®ï¼Œä½†æ˜¯æ•°æ®å¯¼å‡ºåˆ—æ˜¯json,æˆ‘é¡ºæ‰‹å°±å¸®ä»–å¤„ç†äº†ä¸‹ã€‚ä¸å¾—ä¸è¯´ pandasåœ¨å¤„ç†è¿™ç±»é—®é¢˜è¿˜æ˜¯éžå¸¸æ•ˆçŽ‡é«˜çš„. import pandas import json data = pandas.read_excel('data.xlsx') address = data['address'].values.tolist() ordertime_list = data['order_datetime'].values.tolist() address_new_list = [] for ad in address: addressJson = json.loads(ad) address_new_list.append(addressJson[0]) for ad in address_new_list: for t in ordertime_list: ad['order_time'] = t df = pandas.DataFrame.from_records(address_new_list) df.to_excel('new_data.xlsx')","categories":[],"tags":[{"name":"python","slug":"python","permalink":"http://visonforcoding.xyz/tags/python/"}]},{"title":"phpç”Ÿæ€ä¹‹æ€§èƒ½åˆ†æž","slug":"php/phpç”Ÿæ€ä¹‹æ€§èƒ½åˆ†æž","date":"2020-07-23T07:00:58.000Z","updated":"2021-10-30T02:59:33.280Z","comments":true,"path":"2020/07/23/php/phpç”Ÿæ€ä¹‹æ€§èƒ½åˆ†æž/","link":"","permalink":"http://visonforcoding.xyz/2020/07/23/php/php%E7%94%9F%E6%80%81%E4%B9%8B%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90/","excerpt":"ä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬å¹¶ä¸ä¼šå¤ªå…³æ³¨PHPçš„æ‰§è¡Œæ•ˆçŽ‡ï¼Œå› ä¸ºä¸€èˆ¬è€Œè¨€ä»–éƒ½è¡¨çŽ°æ­£å¸¸æ»¡è¶³éœ€æ±‚ã€‚ä½†å½“çœŸæ­£é‡åˆ°é—®é¢˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æœ‰åˆ†æžæ€§èƒ½åœ¨å“ªä¸¢å¤±çš„èƒ½åŠ›ã€‚","text":"ä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬å¹¶ä¸ä¼šå¤ªå…³æ³¨PHPçš„æ‰§è¡Œæ•ˆçŽ‡ï¼Œå› ä¸ºä¸€èˆ¬è€Œè¨€ä»–éƒ½è¡¨çŽ°æ­£å¸¸æ»¡è¶³éœ€æ±‚ã€‚ä½†å½“çœŸæ­£é‡åˆ°é—®é¢˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æœ‰åˆ†æžæ€§èƒ½åœ¨å“ªä¸¢å¤±çš„èƒ½åŠ›ã€‚ xhprofæ­£æ˜¯è¿™æ ·çš„å·¥å…·ã€‚ä½†æ˜¯ç”±äºŽå¹´ä¹…å¤±ä¿®ï¼Œç›®å‰å·²ç»ä¸æ”¯æŒPHP7 . ä¸è¿‡ï¼Œå¥½åœ¨è¿˜æœ‰éžå®˜æ–¹å•†ä¸šç»„ç»‡å¼€æºäº†PHP7ç‰ˆæœ¬,tideways-xhprofã€‚ å®˜ç½‘ https://tideways.com/profiler/xhprof-for-php7 å®‰è£…git clone \"https://github.com/tideways/php-xhprof-extension.git\" cd php-xhprof-extension phpize ./configure make sudo make install é…ç½®å¥½iniï¼Œé‡å¯æŸ¥çœ‹ä¸‹php -m å›¾å½¢åŒ–tideways-xhprof å¯ä»¥å°†åˆ†æžå‡ºæ–¹æ³•è°ƒç”¨ã€æ–¹æ³•è°ƒç”¨è¿‡ç¨‹å’Œæ€§èƒ½æ¶ˆè€—æ•°æ®ã€‚ tideways-xhprof æœ¬èº«è¿˜æä¾›å•†ä¸šåŒ–æœåŠ¡ï¼Œæœ‰ç€æ¯”è¾ƒå¥½çš„ä½“éªŒã€‚ä¸è¿‡ä¹ŸåŒæ—¶æœ‰å¼€æºçš„å›¾å½¢åŒ–å·¥å…·ã€‚æ¯”è¾ƒå¥½çš„æ˜¯xhguiå’Œä»–é…å¥—çš„æ˜¯perftools/php-profiler.çœ‹äº†ä¸‹ä½œè€…ï¼Œè¿˜æ˜¯markstoryï¼Œcakephpçš„ä½œè€…ï¼Œå‡ å¹´å‰ä½¿ç”¨cakephpçš„æ—¶å€™ï¼Œè¿˜æœ‰è¿‡äº¤æµã€‚ xguiå®‰è£…å¯ä»¥é€‰æ‹©æºç éƒ¨ç½²ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©dockeréƒ¨ç½²ã€‚æ–¹ä¾¿ç‚¹é€‰æ‹©ä½¿ç”¨dockerã€‚ Clone or download xhgui from GitHub. Startup the containers: docker-compose up -d Open your browser at http://xhgui.127.0.0.1.xip.io:8142 or just http://localhost:8142 php-profilerä½¿ç”¨å®˜æ–¹githubä¸Šå†™å‡ ç§æŽ¥å…¥æ–¹å¼ï¼Œæˆ‘æŽ¨èç”¨æ³¨å†Œshutdownæ–¹å¼ï¼Œæ­£åœ¨å¯¹é¡¹ç›®ä»£ç æ— å…¥ä¾µã€‚ä¿å­˜è¿‡ç¨‹åœ¨shutdownä¹‹åŽã€‚ $profiler &#x3D; new \\Xhgui\\Profiler\\Profiler($config); &#x2F;&#x2F; The profiler itself checks whether it should be enabled &#x2F;&#x2F; for request (executes lambda function from config) $profiler-&gt;enable(); &#x2F;&#x2F; shutdown handler collects and stores the data. $profiler-&gt;registerShutdownHandler(); ä¸Šé¢çš„$configï¼Œåœ¨ä½¿ç”¨éžæ–‡ä»¶å­˜å‚¨çš„æ—¶å€™è¦æ³¨æ„ä¸è¦å®‰è£…å®˜æ–¹é…ç½®æ¥ï¼Œå®˜æ–¹é…ç½®ç›®å‰å­˜åœ¨ä¸€ç‚¹é—®é¢˜ï¼Œæ–°é…ç½®ä¼šä¸ç”Ÿæ•ˆã€‚æˆ‘çœ‹äº†æºç ï¼Œå¹¶ä¸”æäº¤äº†PRã€‚ &#x2F;&#x2F; &#39;db.host&#39; &#x3D;&gt; &#39;mongodb:&#x2F;&#x2F;127.0.0.1:27018&#39;, &#x2F;&#x2F; &#39;db.db&#39; &#x3D;&gt; &#39;xhprof&#39;, &#39;save.handler.mongodb&#39; &#x3D;&gt; array( &#39;dsn&#39; &#x3D;&gt; &#39;mongodb:&#x2F;&#x2F;127.0.0.1:27018&#39;, &#39;database&#39; &#x3D;&gt; &#39;xhprof&#39;, &#x2F;&#x2F; Allows you to pass additional options like replicaSet to MongoClient. &#x2F;&#x2F; &#39;username&#39;, &#39;password&#39; and &#39;db&#39; (where the user is added) &#39;options&#39; &#x3D;&gt; array(), ), æ³¨é‡Šéƒ¨åˆ†æ‰æœ‰æ•ˆ. é»˜è®¤é…ç½®&lt;?php &#x2F;** * Default configuration for Xhgui *&#x2F; $mongoUri &#x3D; getenv(&#39;XHGUI_MONGO_URI&#39;) ?: &#39;127.0.0.1:27017&#39;; $mongoUri &#x3D; str_replace(&#39;mongodb:&#x2F;&#x2F;&#39;, &#39;&#39;, $mongoUri); $mongoDb &#x3D; getenv(&#39;XHGUI_MONGO_DB&#39;) ?: &#39;xhprof&#39;; return array( &#39;debug&#39; &#x3D;&gt; false, &#39;mode&#39; &#x3D;&gt; &#39;development&#39;, &#x2F;&#x2F; Can be mongodb, file or upload. &#x2F;&#x2F; For file &#x2F;&#x2F; &#x2F;&#x2F;&#39;save.handler&#39; &#x3D;&gt; &#39;file&#39;, &#x2F;&#x2F;&#39;save.handler.filename&#39; &#x3D;&gt; dirname(__DIR__) . &#39;&#x2F;cache&#x2F;&#39; . &#39;xhgui.data.&#39; . microtime(true) . &#39;_&#39; . substr(md5($url), 0, 6), &#x2F;&#x2F; For upload &#x2F;&#x2F; &#x2F;&#x2F; Saving profile data by upload is only recommended with HTTPS &#x2F;&#x2F; endpoints that have IP whitelists applied. &#x2F;&#x2F; &#x2F;&#x2F; The timeout option is in seconds and defaults to 3 if unspecified. &#x2F;&#x2F; &#x2F;&#x2F;&#39;save.handler&#39; &#x3D;&gt; &#39;upload&#39;, &#x2F;&#x2F;&#39;save.handler.upload.uri&#39; &#x3D;&gt; &#39;https:&#x2F;&#x2F;example.com&#x2F;run&#x2F;import&#39;, &#x2F;&#x2F;&#39;save.handler.upload.timeout&#39; &#x3D;&gt; 3, &#x2F;&#x2F; For MongoDB &#39;save.handler&#39; &#x3D;&gt; &#39;mongodb&#39;, &#39;db.host&#39; &#x3D;&gt; sprintf(&#39;mongodb:&#x2F;&#x2F;%s&#39;, $mongoUri), &#39;db.db&#39; &#x3D;&gt; $mongoDb, &#39;pdo&#39; &#x3D;&gt; array( &#39;dsn&#39; &#x3D;&gt; &#39;sqlite:&#x2F;tmp&#x2F;xhgui.sqlite3&#39;, &#39;user&#39; &#x3D;&gt; null, &#39;pass&#39; &#x3D;&gt; null, &#39;table&#39; &#x3D;&gt; &#39;results&#39; ), &#x2F;&#x2F; Allows you to pass additional options like replicaSet to MongoClient. &#x2F;&#x2F; &#39;username&#39;, &#39;password&#39; and &#39;db&#39; (where the user is added) &#39;db.options&#39; &#x3D;&gt; array(), &#39;templates.path&#39; &#x3D;&gt; dirname(__DIR__) . &#39;&#x2F;src&#x2F;templates&#39;, &#39;date.format&#39; &#x3D;&gt; &#39;M jS H:i:s&#39;, &#39;detail.count&#39; &#x3D;&gt; 6, &#39;page.limit&#39; &#x3D;&gt; 25, &#x2F;&#x2F; call fastcgi_finish_request() in shutdown handler &#39;fastcgi_finish_request&#39; &#x3D;&gt; true, &#x2F;&#x2F; Profile x in 100 requests. (E.g. set XHGUI_PROFLING_RATIO&#x3D;50 to profile 50% of requests) &#x2F;&#x2F; You can return true to profile every request. &#39;profiler.enable&#39; &#x3D;&gt; function() &#123; $ratio &#x3D; getenv(&#39;XHGUI_PROFILING_RATIO&#39;) ?: 100; return (getenv(&#39;XHGUI_PROFILING&#39;) !&#x3D;&#x3D; false) &amp;&amp; (mt_rand(1, 100) &lt;&#x3D; $ratio); &#125;, &#39;profiler.simple_url&#39; &#x3D;&gt; function($url) &#123; return preg_replace(&#39;&#x2F;\\&#x3D;\\d+&#x2F;&#39;, &#39;&#39;, $url); &#125;, &#x2F;&#x2F;&#39;profiler.replace_url&#39; &#x3D;&gt; function($url) &#123; &#x2F;&#x2F; return str_replace(&#39;token&#39;, &#39;&#39;, $url); &#x2F;&#x2F;&#125;, &#39;profiler.options&#39; &#x3D;&gt; array(), &#39;profiler.skip_built_in&#39; &#x3D;&gt; false, ); ä»¥ä¸Šæ˜¯é»˜è®¤é…ç½® æ•ˆæžœ å›¾ä¸­å¯ä»¥çœ‹åˆ°,æ¯æ¬¡è¯·æ±‚çš„èŠ±è´¹æ—¶é—´ã€‚ é€šè¿‡è§‚å¯Ÿæ–¹æ³•è°ƒç”¨æ¬¡æ•°ï¼Œå¯ä»¥å‘çŽ°symfony ErrorHandlerè¿™ä¸ªç»„ä»¶æ–¹æ³•æ‰§è¡Œçš„ç‰¹åˆ«å¤šã€‚ äºŽæ˜¯æˆ‘å–æ¶ˆäº†è¿™ä¸ªç»„ä»¶ï¼Œå‘çŽ°æŽ¥å£è¯·æ±‚æ—¶é—´ä»Ž113msç›´æŽ¥å°±é™åˆ°äº†71ms. è¿™å°±æ˜¯å¾ˆç›´è§‚çš„æ€§èƒ½å®šä½äº†","categories":[],"tags":[{"name":"php","slug":"php","permalink":"http://visonforcoding.xyz/tags/php/"}]},{"title":"edgeä½¿ç”¨google theme","slug":"edgeä½¿ç”¨google-theme","date":"2020-07-10T09:27:30.000Z","updated":"2021-10-30T02:59:33.275Z","comments":true,"path":"2020/07/10/edgeä½¿ç”¨google-theme/","link":"","permalink":"http://visonforcoding.xyz/2020/07/10/edge%E4%BD%BF%E7%94%A8google-theme/","excerpt":"","text":"ç”¨edgeæ‰“å¼€ edge://flags/#edge-allow-store-extension-themes æ”¹ä¸ºå¯ç”¨ï¼ è®¿é—® https://chrome.google.com/webstore/category/themes å®‰è£…å³å¯å•¦ã€‚","categories":[],"tags":[]},{"title":"kafkaæ­å»ºå’Œä½¿ç”¨(PHPè¯­è¨€ç‰ˆæœ¬)","slug":"php/kafkaå®‰è£…å’Œä½¿ç”¨-PHPè¯­è¨€ç‰ˆæœ¬","date":"2020-07-08T08:13:45.000Z","updated":"2021-10-30T02:59:33.280Z","comments":true,"path":"2020/07/08/php/kafkaå®‰è£…å’Œä½¿ç”¨-PHPè¯­è¨€ç‰ˆæœ¬/","link":"","permalink":"http://visonforcoding.xyz/2020/07/08/php/kafka%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8-PHP%E8%AF%AD%E8%A8%80%E7%89%88%E6%9C%AC/","excerpt":"é¦–å…ˆ,å®‰è£…ç¡®å®žæ˜¯ä¸€ä¸ªè´¹æ—¶è´¹åŠ›çš„äº‹æƒ…ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨dockerå®‰è£…ã€‚","text":"é¦–å…ˆ,å®‰è£…ç¡®å®žæ˜¯ä¸€ä¸ªè´¹æ—¶è´¹åŠ›çš„äº‹æƒ…ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨dockerå®‰è£…ã€‚ dockeræ­å»ºkafka## docker-compose.yml version: '3.1' services: zookeeper: image: wurstmeister/zookeeper ports: - \"2181:2181\" kafka: image: wurstmeister/kafka ports: - \"9092:9092\" environment: KAFKA_ADVERTISED_HOST_NAME: 172.17.0.1 KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181 KAFKA_ADVERTISED_PORT: 9092 æ›´å¤šç»†èŠ‚å»ºè®®è®¿é—®å®˜æ–¹æ–‡æ¡£æŸ¥é˜…ã€‚ PHPå®žçŽ°ç”Ÿäº§è€…public function kafka(Request $request) &#123; $faker &#x3D; Factory::create(&#39;zh_CN&#39;); $message &#x3D; $faker-&gt;name(); Log::debug(&#39;æ¶ˆæ¯&#39;, [&#39;message&#39; &#x3D;&gt; $message]); $conf &#x3D; new Conf(); $conf-&gt;set(&#39;log_level&#39;, (string) LOG_DEBUG); $conf-&gt;set(&#39;debug&#39;, &#39;all&#39;); $conf-&gt;set(&#39;metadata.broker.list&#39;, &#39;127.0.0.1:9092&#39;); $conf-&gt;setDrMsgCb(function ($kafka, $message) &#123; Log::debug(&quot;kafkaä¿¡æ¯&quot;, [&#39;message&#39; &#x3D;&gt; var_export($message, true)]); &#125;); $conf-&gt;setErrorCb(function ($kafka, $err, $reason) &#123; Log::debug(&quot;kafkaé”™è¯¯&quot;, [&#39;err&#39; &#x3D;&gt; $err, &#39;reason&#39; &#x3D;&gt; $reason]); &#125;); $conf-&gt;setLogCb(function ($kafka, $level, $facility, $message) &#123; Log::debug(vsprintf(&quot;Kafka %s: %s (level: %d)\\n&quot;, [$facility, $message, $level])); &#125;); &#x2F;&#x2F;If you need to produce exactly once and want to keep the original produce order, uncomment the line below &#x2F;&#x2F;$conf-&gt;set(&#39;enable.idempotence&#39;, &#39;true&#39;); $producer &#x3D; new Producer($conf); $topic &#x3D; $producer-&gt;newTopic(&quot;test&quot;); $topic-&gt;produce(RD_KAFKA_PARTITION_UA, 0, $faker-&gt;name()); $producer-&gt;poll(0); $result &#x3D; $producer-&gt;flush(10000); if (RD_KAFKA_RESP_ERR_NO_ERROR !&#x3D;&#x3D; $result) &#123; throw new \\RuntimeException(&#39;Was unable to flush, messages might be lost!&#39;); &#125; return new ActionResponse($result); &#125; æ¶ˆè´¹è€…public function consume() &#123; $conf &#x3D; new Conf(); &#x2F;&#x2F; Configure the group.id. All consumer with the same group.id will consume &#x2F;&#x2F; different partitions. $conf-&gt;set(&#39;group.id&#39;, &#39;myConsumerGroup&#39;); &#x2F;&#x2F; Initial list of Kafka brokers $conf-&gt;set(&#39;metadata.broker.list&#39;, &#39;127.0.0.1&#39;); &#x2F;&#x2F; Set where to start consuming messages when there is no initial offset in &#x2F;&#x2F; offset store or the desired offset is out of range. &#x2F;&#x2F; &#39;smallest&#39;: start from the beginning $conf-&gt;set(&#39;auto.offset.reset&#39;, &#39;smallest&#39;); $consumer &#x3D; new KafkaConsumer($conf); &#x2F;&#x2F; Subscribe to topic &#39;test&#39; $consumer-&gt;subscribe([&#39;test&#39;]); echo &quot;Waiting for partition assignment... (make take some time when\\n&quot;; echo &quot;quickly re-joining the group after leaving it.)\\n&quot;; while (true) &#123; $message &#x3D; $consumer-&gt;consume(120 * 1000); switch ($message-&gt;err) &#123; case RD_KAFKA_RESP_ERR_NO_ERROR: $this-&gt;info($message-&gt;payload); break; case RD_KAFKA_RESP_ERR__PARTITION_EOF: echo &quot;No more messages; will wait for more\\n&quot;; break; case RD_KAFKA_RESP_ERR__TIMED_OUT: $this-&gt;info(&quot;Timed out&quot;); break; default: throw new Exception($message-&gt;errstr(), $message-&gt;err); break; &#125; &#125; &#125; æµ‹è¯•ç”Ÿäº§è€…æ˜¯ä¸€ä¸ªrestfulçš„apiï¼Œç›´æŽ¥è°ƒç”¨ä¼šå¾€kafkaé‡Œå†™å…¥1ä¸ªä¸­æ–‡å§“åçš„æ¶ˆæ¯ã€‚ æ¶ˆè´¹è€…æ˜¯ä¸€ä¸ªPHPè„šæœ¬è¿›ç¨‹ï¼Œå¯åŠ¨ä¼šå¼€å§‹æ¶ˆè´¹kafkaæ¶ˆæ¯ php bin/cli.php kafka consume é—®é¢˜è™½ç„¶å·²ç»æ­å»ºäº†kafkaæ¶ˆæ¯ä¸­é—´ä»¶,å’Œç¼–å†™äº†ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€….ä½†æ˜¯å…³äºŽå…¶ä¸­çš„è®¸å¤šç»†èŠ‚è¿˜è¦æžæ¸…é™¤ã€‚åŒ…æ‹¬: ä»€ä¹ˆæ˜¯broken ä»€ä¹ˆæ˜¯partition æ¶ˆæ¯flushæ˜¯åšä»€ä¹ˆ pollåˆæ˜¯åšä»€ä¹ˆ ç­‰ç­‰æ›´å¤šç»†èŠ‚ broken","categories":[],"tags":[{"name":"kafka","slug":"kafka","permalink":"http://visonforcoding.xyz/tags/kafka/"}]},{"title":"ä¸€ä¸ªçº¿ä¸Šé—®é¢˜å¼•å‘çš„å¯¹PHPç”Ÿå‘½å‘¨æœŸå’ŒSESSIONæœºåˆ¶æ€è€ƒ","slug":"php/ä¸€ä¸ªçº¿ä¸Šé—®é¢˜å¼•å‘çš„å¯¹PHPç”Ÿå‘½å‘¨æœŸå’ŒSESSIONæœºåˆ¶æ€è€ƒ","date":"2020-07-01T01:59:26.000Z","updated":"2021-10-30T02:59:33.280Z","comments":true,"path":"2020/07/01/php/ä¸€ä¸ªçº¿ä¸Šé—®é¢˜å¼•å‘çš„å¯¹PHPç”Ÿå‘½å‘¨æœŸå’ŒSESSIONæœºåˆ¶æ€è€ƒ/","link":"","permalink":"http://visonforcoding.xyz/2020/07/01/php/%E4%B8%80%E4%B8%AA%E7%BA%BF%E4%B8%8A%E9%97%AE%E9%A2%98%E5%BC%95%E5%8F%91%E7%9A%84%E5%AF%B9PHP%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%92%8CSESSION%E6%9C%BA%E5%88%B6%E6%80%9D%E8%80%83/","excerpt":"","text":"","categories":[],"tags":[]},{"title":"PHPç”Ÿæ€ä¹‹è‡ªåŠ¨åŒ–æµ‹è¯•","slug":"php/PHPç”Ÿæ€ä¹‹è‡ªåŠ¨åŒ–æµ‹è¯•","date":"2020-07-01T01:58:44.000Z","updated":"2021-10-30T02:59:33.279Z","comments":true,"path":"2020/07/01/php/PHPç”Ÿæ€ä¹‹è‡ªåŠ¨åŒ–æµ‹è¯•/","link":"","permalink":"http://visonforcoding.xyz/2020/07/01/php/PHP%E7%94%9F%E6%80%81%E4%B9%8B%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/","excerpt":"PHP TESTING FOR EVERYONE","text":"PHP TESTING FOR EVERYONE åœ¨é•¿ä¹…çš„å·¥ä½œç»åŽ†ä¸­ï¼Œæµ‹è¯•å¤§ä½¬å¸¸ä¼šåœ¨ä½ è€³æ—å˜€å’•å¼€å‘è¦è‡ªæµ‹è¦è‡ªæµ‹ã€‚ä½†æ˜¯å®žé™…ä¸Šå¼€å‘å¾€å¾€åªä¼šå…³å¿ƒå½“å‰è´Ÿè´£çš„å•å…ƒåŠŸèƒ½çš„æ­£ç¡®ä¸Žå¦ã€‚ç¹æ‚çš„å¼€å‘ä»»åŠ¡å½“ä¸­ï¼Œè¿˜è¦å…¼é¡¾æ‰€æœ‰æµç¨‹çš„åŠŸèƒ½è¿è½¬å¯èƒ½å°±æ²¡é‚£ä¸ªç²¾åŠ›äº†ï¼Œæˆ–è€…è¯´è¿™æœ¬èº«å°±æ˜¯æµ‹è¯•çš„å·¥ä½œã€‚åœ¨è¿œå¤æ—¶ä»£äº’è”ç½‘é¢†åŸŸå·¥ä½œè¿˜æ²¡ç»†åˆ†åˆ°å‰ç«¯ã€åŽç«¯ã€æµ‹è¯•ã€UIçš„æ—¶å€™ï¼Œæ‰€æœ‰ä¸€æ½å­æ´»éƒ½åªæœ‰ä¸€ä¸ªäººåšï¼Œé‚£å°±æ˜¯ç¨‹åºå‘˜ã€‚ ä½†æ˜¯å¦‚ä½•å°½é‡ä¿è¯ç¨‹åºè¿”å›žç»“æžœæ˜¯é¢„æœŸçš„ï¼Ÿ èƒ½å¦åšåˆ°æ¯æ¬¡å‘å¸ƒä¹‹å‰è‡ªåŠ¨å¯¹ç¨‹åºæµ‹è¯•çœ‹æ˜¯å¦è¾¾åˆ°é¢„æœŸï¼Ÿè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥å¼•å…¥è‡ªåŠ¨åŒ–æµ‹è¯•ã€‚ è‡ªåŠ¨åŒ–æµ‹è¯•èŒƒå›´ UIæµ‹è¯• æŽ¥å£æµ‹è¯• å•å…ƒæµ‹è¯• æ•°æ®æµ‹è¯• å…¶ä¸­UIæµ‹è¯•å’Œæ•°æ®æµ‹è¯•çš„è‡ªåŠ¨åŒ–å¯èƒ½æ˜¯æœ€ä¸å®¹æ˜“åšä¸”æ•ˆç›Šæœ€å°çš„ã€‚è¿™éƒ¨åˆ†å¯èƒ½æœ€å¥½æ˜¯äººä¸ºçš„è¿›è¡Œæµ‹è¯•æ•ˆæžœæœ€å¥½ã€‚ åœ¨ä½“éªŒäº†java çš„junitä¹‹åŽç‰¹åˆ«è§‰å¾—junitçš„å¼ºå¤§,å…¶å®žPHPä¹Ÿå¯ä»¥åšã€‚æŽ¥ä¸‹æ¥æˆ‘ä»¬æ¥äº†è§£ä¸‹PHPçš„æµ‹è¯•æ¡†æž¶codeception å®‰è£…ä½¿ç”¨installcomposer require &quot;codeception&#x2F;codeception&quot; --dev setupphp vendor&#x2F;bin&#x2F;codecept bootstrap è¯¥å‘½ä»¤ä¼šåˆå§‹åŒ–é…ç½®æ–‡ä»¶å’Œç›®å½• è½»é‡å®‰è£…Use predefined installation templates for common use cases. Run them instead of bootstrap command. bootstrapä¼šé»˜è®¤åˆå§‹åŒ–æ‰€æœ‰æµ‹è¯•ç±»åž‹æ‰€éœ€è¦çš„ç»„ä»¶ï¼Œæœ‰äº›ä½ ä¸ä¼šç”¨åˆ°çš„ç±»åº“ä¹Ÿä¼šå®‰è£…ã€‚æŽ¨èä½¿ç”¨è½»é‡å®‰è£…æ‰€ç”¨èƒ½åˆ°çš„æµ‹è¯•ç±»åž‹ã€‚ ä¾‹å¦‚ä½ åªéœ€è¦å•å…ƒæµ‹è¯•ï¼Œåˆ™å¯ä»¥ php vendor&#x2F;bin&#x2F;codecept init unit suiteé…ç½® åˆå§‹åŒ–ä¹‹åŽè¿˜è¦å¯¹æµ‹è¯•ç±»åž‹è¿›è¡Œç›¸åº”çš„é…ç½®,åœ¨testsç›®å½•ä¸‹æ–°å»ºunitçš„é…ç½® # unit.suite.yml # Codeception Test Suite Configuration # # Suite for unit or integration tests. actor: UnitTester modules: enabled: - Asserts - \\Helper\\Unit step_decorators: ~ codeceptionå•å…ƒæµ‹è¯• codeceptionçš„å•å…ƒæµ‹è¯•å…¶å®žä¹Ÿæ˜¯åŸºäºŽphpunitä¹‹ä¸Šæž„å»ºçš„ã€‚phpunitçš„å•å…ƒæµ‹è¯•ç”¨ä¾‹å¯ä»¥ä¹‹å‰åœ¨codeceptionä¸Šæ‰§è¡Œã€‚ åˆ›å»ºå•å…ƒæµ‹è¯•php vendor&#x2F;bin&#x2F;codecept generate:test unit Example æ‰§è¡Œå®Œä¼šåœ¨tests/unitç›®å½•é‡Œåˆ›å»ºæµ‹è¯•ç”¨ä¾‹æ–‡ä»¶ class ExampleTest extends \\Codeception\\Test\\Unit &#123; /** * @var \\UnitTester */ protected $tester; protected function _before() &#123; &#125; protected function _after() &#123; &#125; // tests public function testMe() &#123; &#125; &#125; all public methods with test prefix are tests _before method is executed before each test (like setUp in PHPUnit) _after method is executed after each test (like tearDown in PHPUnit) è¿è¡Œç”¨ä¾‹php vendor&#x2F;bin&#x2F;codecept run unit ExampleTest å¦‚æžœæœ‰ç›®å½•å¯ä»¥æ‰§è¡Œåˆ°æ–‡ä»¶ php bin&#x2F;codecept run unit tests&#x2F;unit&#x2F;src&#x2F;Service&#x2F;InvoiceServiceTest.php è¿è¡Œæ‰€æœ‰å•å…ƒæµ‹è¯•ç”¨ä¾‹ php vendor&#x2F;bin&#x2F;codecept run unit class UserTest extends \\Codeception\\Test\\Unit &#123; public function testValidation() &#123; $user = new User(); $user->setName(null); $this->assertFalse($user->validate(['username'])); $user->setName('toolooooongnaaaaaaameeee'); $this->assertFalse($user->validate(['username'])); $user->setName('davert'); $this->assertTrue($user->validate(['username'])); &#125; &#125; ç»“æžœ å¯ä»¥ç»Ÿè®¡åˆ°æ‰€æœ‰æ–‡ä»¶çš„è¦†ç›–çŽ‡å’Œç”¨ä¾‹æµ‹è¯•ç»“æžœã€‚ ç»“åˆgité’©å­æˆ‘ä»¬å¯ä»¥åœ¨æ¯æ¬¡åˆ†æ”¯æäº¤æ—¶è¿›è¡Œè‡ªåŠ¨çš„ç”¨ä¾‹æµ‹è¯•ï¼Œèƒ½ä¸€å®šç¨‹åº¦ä¸Šé˜²æ­¢ä»£ç æ›´æ”¹äº†è€Œæ²¡æµ‹è¯•äº§ç”Ÿéžé¢„æœŸçš„é—®é¢˜ã€‚","categories":[],"tags":[{"name":"php","slug":"php","permalink":"http://visonforcoding.xyz/tags/php/"}]},{"title":"intlå®‰è£…çš„é‚£äº›äº‹å„¿","slug":"php/intlå®‰è£…çš„é‚£äº›äº‹å„¿","date":"2020-06-19T02:41:25.000Z","updated":"2021-10-30T02:59:33.279Z","comments":true,"path":"2020/06/19/php/intlå®‰è£…çš„é‚£äº›äº‹å„¿/","link":"","permalink":"http://visonforcoding.xyz/2020/06/19/php/intl%E5%AE%89%E8%A3%85%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF/","excerpt":"è¢«intlæŠ˜ç£¨çš„è¿˜ä¸å¤Ÿä¹ˆ","text":"è¢«intlæŠ˜ç£¨çš„è¿˜ä¸å¤Ÿä¹ˆ To build the extension you need to install the Â» ICU library, version 4.0.0 or newer is required. As of PHP 7.4.0 ICU 50.1 or newer is required. This extension is bundled with PHP as of PHP version 5.3.0. Alternatively, the PECL version of this extension may be used with all PHP versions greater than 5.2.0 (5.2.4+ recommended). ICUå®‰è£…çŽ°åœ¨icuå·²è¢«æ”¾åˆ°githubï¼Œä¸‹è½½å»ºè®®ç›´æŽ¥ä»Žgithubä¸‹è½½æºç åˆ°æœ¬åœ°ã€‚ https://github.com/unicode-org/icu/releases/tag/release-60-3 ä¸‹è½½åŽç¼–è¯‘å®‰è£… æ‹“å±•å®‰è£…pecl install intl æ€»ä¼šé‡åˆ°é—®é¢˜,å»ºè®®ç”¨phpize æºç å®‰è£…ã€‚è¿›å…¥æºç extä¸‹çš„intlç›®å½• .&#x2F;configure --enable-intl --with-php-config&#x3D;&#x2F;usr&#x2F;local&#x2F;php7&#x2F;bin&#x2F;php-config make make install é‡å¯php-fpm","categories":[],"tags":[{"name":"php","slug":"php","permalink":"http://visonforcoding.xyz/tags/php/"}]},{"title":"MyBatis Dynamic SQLä½¿ç”¨å°è¯•","slug":"java/MyBatis-Dynamic-SQLä½¿ç”¨å°è¯•","date":"2020-06-01T15:05:29.000Z","updated":"2021-10-30T02:59:33.276Z","comments":true,"path":"2020/06/01/java/MyBatis-Dynamic-SQLä½¿ç”¨å°è¯•/","link":"","permalink":"http://visonforcoding.xyz/2020/06/01/java/MyBatis-Dynamic-SQL%E4%BD%BF%E7%94%A8%E5%B0%9D%E8%AF%95/","excerpt":"é¦–å…ˆè¯´æ˜Žä¸‹ï¼Œæˆ‘å¯èƒ½æ˜¯è¢«è¿™ä¸ªæ’ä»¶çš„åå­—ç»™è¯¯å¯¼äº†ã€‚æˆ‘åŽŸæœ¬ä»¥ä¸ºDynamic SQLæ˜¯ä¸ºäº†è§£å†³åŠ¨æ€æŸ¥è¯¢åœºæ™¯çš„ã€‚ä½†å¯èƒ½MyBatis Dynamic SQL å¹¶ä¸æ˜¯æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„ã€‚ 20.06.04æ›´æ–° æ‰“è„¸äº†ï¼ŒåŽŸæ¥å®ƒæ˜¯æ”¯æŒçš„ï¼Œæžœç„¶æ˜¯åŠ¨æ€sql.å¹¶ä¸”è¿˜çœŸé¦™ï¼","text":"é¦–å…ˆè¯´æ˜Žä¸‹ï¼Œæˆ‘å¯èƒ½æ˜¯è¢«è¿™ä¸ªæ’ä»¶çš„åå­—ç»™è¯¯å¯¼äº†ã€‚æˆ‘åŽŸæœ¬ä»¥ä¸ºDynamic SQLæ˜¯ä¸ºäº†è§£å†³åŠ¨æ€æŸ¥è¯¢åœºæ™¯çš„ã€‚ä½†å¯èƒ½MyBatis Dynamic SQL å¹¶ä¸æ˜¯æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„ã€‚ 20.06.04æ›´æ–° æ‰“è„¸äº†ï¼ŒåŽŸæ¥å®ƒæ˜¯æ”¯æŒçš„ï¼Œæžœç„¶æ˜¯åŠ¨æ€sql.å¹¶ä¸”è¿˜çœŸé¦™ï¼ MyBatis Dynamic SQLå®˜æ–¹å®šä¹‰This library is a framework for generating dynamic SQL statements. Think of it as a typesafe SQL templating library, with additional support for MyBatis3 and Spring JDBC Templates. The primary goals of the library are: Typesafe - to the extent possible, the library will ensure that parameter types match the database column types Expressive - statements are built in a way that clearly communicates their meaning (thanks to Hamcrest for some inspiration) Flexible - where clauses can be built using any combination of and, or, and nested conditions Extensible - the library will render statements for MyBatis3, Spring JDBC templates or plain JDBC. It can be extended to generate clauses for other frameworks as well. Custom where conditions can be added easily if none of the built in conditions are sufficient for your needs. Small - the library is a small dependency to add. It has no transitive dependencies. å®˜æ–¹ä¼¼ä¹Žè¯´åˆ°è¿™ä¸ªç±»åº“çš„ä¸»è¦ç›®æ ‡æ˜¯è§£å†³ç±»åž‹å®‰å…¨é—®é¢˜ã€‚ This library grew out of a desire to create a utility that could be used to improve the code generated by MyBatis Generator, but the library can be used on itâ€™s own with very little setup required. å®˜æ–¹è¯´å¯ä»¥ä½¿ç”¨MyBatis Generatorç”Ÿæˆä»£ç æ–‡ä»¶ã€‚ &lt;dependency> &lt;groupId>org.mybatis.dynamic-sql&lt;/groupId> &lt;artifactId>mybatis-dynamic-sql&lt;/artifactId> &lt;version>1.1.4&lt;/version> &lt;/dependency> &lt;dependency> &lt;groupId>mysql&lt;/groupId> &lt;artifactId>mysql-connector-java&lt;/artifactId> &lt;/dependency> MyBatis GeneratorMyBatis Generator may generate: Java or Kotlin classes that match the table structure. This may include: a class to match the primary key of the table (if there is a primary key) a class to match the non-primary key fields of the table (except BLOB fields) a class to include the BLOB fields of a table (if the table has BLOB fields) a class to enable dynamic selects, updates, and deletes MyBatis Generatorå°†ä¼šç”Ÿæˆä¸‹è¿°ä¸‰ä¸ªæ–‡ä»¶ï¼š ä¸Žè¡¨å¯¹åº”çš„ model ç±» Employee.java å®šä¹‰äº†è¡¨ä¿¡æ¯å’Œåˆ—ä¿¡æ¯çš„ support ç±» EmployeeDynamicSqlSupport.java ä»¥æ³¨è§£å½¢å¼å®žçŽ°çš„ mapper æŽ¥å£ EmployeeMapper.java Running MyBatis Generator With Maven é…ç½®pom.xml &lt;plugin> &lt;groupId>org.mybatis.generator&lt;/groupId> &lt;artifactId>mybatis-generator-maven-plugin&lt;/artifactId> &lt;version>1.4.0&lt;/version> &lt;executions> &lt;execution> &lt;id>Generate MyBatis Artifacts&lt;/id> &lt;goals> &lt;goal>generate&lt;/goal> &lt;/goals> &lt;/execution> &lt;/executions> &lt;dependencies> &lt;dependency> &lt;groupId>mysql&lt;/groupId> &lt;artifactId>mysql-connector-java&lt;/artifactId> &lt;version>8.0.20&lt;/version> &lt;/dependency> &lt;/dependencies> &lt;/plugin> æ³¨æ„mysql-connector-javaä¾èµ–é…ç½® é…ç½® generatorConfig.xml åœ¨resourceä¸­é…ç½®ç”Ÿæˆé…ç½®æ–‡ä»¶generatorConfig.xml &lt;!DOCTYPE generatorConfiguration PUBLIC \"-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN\" \"http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd\"> &lt;generatorConfiguration> &lt;context id=\"dsql\" targetRuntime=\"MyBatis3DynamicSql\"> &lt;jdbcConnection driverClass=\"com.mysql.jdbc.Driver\" connectionURL=\"jdbc:mysql://localhost:3306/db_itdoc\" userId=\"username\" password=\"password\" /> &lt;javaModelGenerator targetPackage=\"com.vison.itdoc.entity\" targetProject=\"src/main/java\"/> &lt;javaClientGenerator targetPackage=\"com.vison.itdoc.dao\" targetProject=\"src/main/java\"/> &lt;table tableName=\"task\" /> &lt;/context> &lt;/generatorConfiguration> userIdå’Œpasswordåˆ†åˆ«æ˜¯æ•°æ®åº“ç”¨æˆ·åå’Œå¯†ç  æ‰§è¡Œç”Ÿæˆ $ mvn mybatis-generator:generate ä½¿ç”¨MyBatis Dynamic SQLå½“ç›¸åº”çš„æ–‡ä»¶ç”Ÿæˆä¹‹åŽï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ç›´æŽ¥ä½¿ç”¨äº†ã€‚ SelectStatementProvider queryCount = select(count()) .from(task) .build() .render(RenderingStrategies.MYBATIS3); Long taskCount = taskMapper.count(queryCount); double total = Math.ceil(taskCount / iPageSize); SelectStatementProvider tasksQuerypProvider = select(createTime).from(task) .orderBy(createTime) .limit(iPageSize).offset(iOffset).build() .render(RenderingStrategy.MYBATIS3); List&lt;Task> tasks = taskMapper.selectMany(tasksQuerypProvider); MyBatis Dynamic SQLéžå¸¸ä¼˜é›…å¾—sqlbuilderæ–¹å¼,ä¼šæç¤ºè¡¨å­—æ®µåã€‚ åŠ¨æ€sqlåœ¨è¿™ä¹‹å‰mybatiså¯ä»¥ä½¿ç”¨xmlæˆ–æ³¨è§£æ–¹å¼è¿›è¡ŒåŠ¨æ€ç»„ç»‡sql public class TaskService &#123; public String queryCount(String type, String remark) &#123; return new SQL() &#123; &#123; SELECT(\"T.ID\"); FROM(\"TASK T\"); if (type != null) &#123; WHERE(\"T.type = #&#123;type&#125;\"); &#125; if (remark != null) &#123; WHERE(\"T.remark = #&#123;remark&#125;\"); &#125; ORDER_BY(\"T.create_time\"); &#125; &#125;.toString(); &#125; åœ¨mapperä¸Š @SelectProvider(type = TaskService.class, method = \"queryCount\") public Object queryCount(String type, String remark); çŽ°åœ¨å¯ä»¥æ¢å¦ä¸€ç§æ–¹å¼ public SelectStatementProvider countTask(Integer typeInteger, String remarkString) &#123; QueryExpressionDSL&lt;SelectModel>.QueryExpressionWhereBuilder builder = select(count()) .from(task).where(); if (typeInteger != null) &#123; builder.and(type, isEqualTo(typeInteger)); &#125; if (remarkString != null) &#123; builder.and(remark, isEqualTo(remarkString)); &#125; return builder.build().render(RenderingStrategy.MYBATIS3); &#125; public SelectStatementProvider search(Object searchObj, Integer iPageSize, Integer iOffset) &#123; QueryExpressionDSL&lt;SelectModel>.QueryExpressionWhereBuilder builder = select(remark, type, createTime, modifyTime) .from(task).where(); builder .orderBy(createTime) .limit(iPageSize).offset(iOffset); return builder.build().render(RenderingStrategy.MYBATIS3); &#125; ä»Žç¼–ç æ„Ÿå—ä¸Šï¼Œç”±äºŽæ ¹æ®è¡¨ç»“æž„ç”Ÿæˆäº†SqlSupport.ä»»ä½•å¯¹è¡¨çš„ä¿¡æ¯å¼•ç”¨éƒ½èƒ½æœ‰æç¤ºï¼ŒåŒ…æ‹¬è¡¨åã€å­—æ®µåã€‚ List&lt;Task> tasks = taskMapper.selectMany(taskService.search(null, iPageSize, iOffset)); è°ƒç”¨ä¸Šé¢ï¼Œä¹Ÿæ— éœ€åœ¨mapperä¸Šå†ç¼–å†™æ–¹æ³•ï¼Œå› ä¸ºå·²ç»å…¨éƒ¨ç”Ÿæˆäº†ã€‚ å‚è€ƒMybatis Dynamic SQL - é‡æ–°å®šä¹‰ Mybatis åŠ¨æ€ SQL","categories":[],"tags":[{"name":"java","slug":"java","permalink":"http://visonforcoding.xyz/tags/java/"}]},{"title":"åˆ©ç”¨ä¿¡å·æŽ§åˆ¶phpå¸¸é©»è¿›ç¨‹å¹³æ»‘ä¸­æ–­æ€è€ƒ","slug":"php/phpå¸¸é©»è¿›ç¨‹å¹³æ»‘ä¸­æ–­","date":"2020-05-30T02:30:49.000Z","updated":"2021-10-30T02:59:33.280Z","comments":true,"path":"2020/05/30/php/phpå¸¸é©»è¿›ç¨‹å¹³æ»‘ä¸­æ–­/","link":"","permalink":"http://visonforcoding.xyz/2020/05/30/php/php%E5%B8%B8%E9%A9%BB%E8%BF%9B%E7%A8%8B%E5%B9%B3%E6%BB%91%E4%B8%AD%E6%96%AD/","excerpt":"å¾ˆå¤šåœºæ™¯ä¸‹æˆ‘ä»¬éƒ½éœ€è¦è¿›ç¨‹ç¨‹åºåœ¨åŽå°ä¸€ç›´å¤„ç†ä»»åŠ¡ï¼Œæ¯”å¦‚é˜Ÿåˆ—æ¶ˆè´¹ã€‚å¯é‡‡ç”¨while trueçš„æ–¹å¼è®©è¿›ç¨‹å¸¸é©»æŒ‰ä¸€å®šçš„é¢‘æ¬¡æ‰§è¡Œä»»åŠ¡ã€‚ä½†æ˜¯ä½†æˆ‘ä»¬è¦é‡å¯è¿›ç¨‹æˆ–ä¸­æ­¢è¿›ç¨‹æ—¶ï¼Œå¦‚ä½•ä¿è¯è¿›ç¨‹å†…æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡æ‰§è¡Œå®Œæ¯•å†ä¸­æ­¢å‘¢ï¼Ÿ","text":"å¾ˆå¤šåœºæ™¯ä¸‹æˆ‘ä»¬éƒ½éœ€è¦è¿›ç¨‹ç¨‹åºåœ¨åŽå°ä¸€ç›´å¤„ç†ä»»åŠ¡ï¼Œæ¯”å¦‚é˜Ÿåˆ—æ¶ˆè´¹ã€‚å¯é‡‡ç”¨while trueçš„æ–¹å¼è®©è¿›ç¨‹å¸¸é©»æŒ‰ä¸€å®šçš„é¢‘æ¬¡æ‰§è¡Œä»»åŠ¡ã€‚ä½†æ˜¯ä½†æˆ‘ä»¬è¦é‡å¯è¿›ç¨‹æˆ–ä¸­æ­¢è¿›ç¨‹æ—¶ï¼Œå¦‚ä½•ä¿è¯è¿›ç¨‹å†…æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡æ‰§è¡Œå®Œæ¯•å†ä¸­æ­¢å‘¢ï¼Ÿ æ€è€ƒä¸€ä¸‹ï¼Œå¯ä¸å¯ä»¥æˆ‘ä»¬é€šè¿‡ä¸€ç§æŒ‡ä»¤å‘Šè¯‰è¿›ç¨‹ï¼Œâ€è¯¶ï¼Œæˆ‘çŽ°åœ¨è¦é‡å¯ä¸€ä¸‹ï¼Œä½ èƒ½æŠŠæ­£åœ¨åšçš„äº‹æƒ…åšå®Œäº†å…ˆé€€å‡ºæ­‡ä¼šä¹ˆï¼Ÿâ€ killå‘½ä»¤å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ å†çœ‹killè®¸äººè‚¯å®šä¼šè§‰å¾— kill ä¸å°±æ˜¯æ€æŽ‰è¿›ç¨‹ä¹ˆï¼Ÿ æˆ‘ç»å¸¸ç”¨kill -9æ€è¿›ç¨‹ã€‚ è¿™ä¹ˆè¯´ä¹Ÿæ²¡é”™ï¼Œä¸è¿‡æˆ‘ä»¬çŽ°åœ¨å¯ä»¥ç³»ç»Ÿåœ°æ¥çœ‹çœ‹killå‘½ä»¤. æˆ‘ä»¬å…ˆçœ‹ä¸‹å®˜æ–¹çš„å®šä¹‰,è®©é‚£ä¸ªç”·äººæ¥è·Ÿæˆ‘ä»¬è®²è®²ã€‚ man shell KILL(1) User Commands KILL(1) NAME kill - terminate a process SYNOPSIS kill [-s signal|-p] [-q sigval] [-a] [--] pid... kill -l [signal] DESCRIPTION The command kill sends the specified signal to the specified process or process group. If no signal is specified, the TERM signal is sent. The TERM signal will kill processes which do not catch this signal. For other processes, it may be necessary to use the KILL (9) signal, since this signal cannot be caught. Most modern shells have a builtin kill function, with a usage rather similar to that of the command described here. The &#39;-a&#39; and &#39;-p&#39; options, and the possibility to specify processes by command name are a local extension. If sig is 0, then no signal is sent, but error checking is still performed. å®˜æ–¹è§£é‡Škillæ˜¯ç”¨æ¥ç»ˆæ­¢è¿›ç¨‹çš„ã€‚ kill å‘é€æŒ‡å®šçš„ä¿¡å·ç»™åˆ°è¿›ç¨‹æˆ–è¿›ç¨‹ç»„ã€‚ å¦‚æžœæ²¡æœ‰æŒ‡å®šä¿¡å·ï¼Œé»˜è®¤å‘é€TERMä¿¡å·ã€‚ TERMä¿¡å·å°†ä¼šæ€æŽ‰è¿›ç¨‹ï¼Œå½“TERMæœªè¢«æ•èŽ·çš„æ—¶å€™ã€‚ 9ä¿¡å·ä¸èƒ½è¢«æ•èŽ· è°ˆè°ˆæˆ‘çš„ç†è§£ killå‘½ä»¤å°±æ˜¯ç”¨æ¥æ€æŽ‰è¿›ç¨‹çš„ å®ƒå¯ä»¥ç»™è¿›ç¨‹å‘é€ä¸€äº›æŒ‡ä»¤ï¼Œè®©ç¨‹åºåŽ»æ•èŽ·åšç‰¹æ®Šå¤„ç†ã€‚æ¯”å¦‚ä¸Šé¢è¯´åˆ°çš„åœºæ™¯ï¼Œè®©ç¨‹åºæ‰§è¡Œå®Œæ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ï¼Œå†é€€å‡ºã€‚ éªŒè¯æŽ¥ä¸‹æ¥æˆ‘ä»¬ç”¨PHPè„šæœ¬æ¥éªŒè¯ä¸‹ä¸Šé¢çš„ç†è§£ã€‚æˆ‘ä»¬ç”¨pcntl_signalæ¥å¯¹ä¿¡å·è¿›è¡Œæ•èŽ·ã€‚ class SignalShell extends Shell &#123; private $taskFinish = false; public function __construct() &#123; // pcntl_signal(SIGTERM, [$this, 'sig_handler']); // pcntl_signal(SIGHUP, [$this, 'sig_handler']); pcntl_signal(SIGINT, [$this, 'sig_handler']); // pcntl_signal(SIGQUIT, [$this, 'sig_handler']); pcntl_signal(SIGILL, [$this, 'sig_handler']); pcntl_signal(SIGPIPE, [$this, 'sig_handler']); pcntl_signal(SIGALRM, [$this, 'sig_handler']); pcntl_signal(SIGUSR1, [$this, 'sig_handler']); $this->info(\"æ³¨å†Œä¿¡å·\"); &#125; public function task() &#123; while (true &amp;&amp; !$this->taskFinish) &#123; sleep(10); $this->info(uniqid()); &#125; &#125; public function sig_handler($signo) &#123; $time = date('Y-m-d H:i:s'); if ($signo == 14) &#123; //å¿½ç•¥alarmä¿¡å· echo $time . \" ignore alarm signo[&#123;$signo&#125;]\\r\\n\"; &#125; else &#123; echo $time . \" exit signo[&#123;$signo&#125;]\\r\\n\"; if ($signo == SIGUSR1) &#123; $this->info(\"æ•èŽ·è‡ªå®šä¹‰\"); $this->taskFinish = true; &#125; &#125; &#125; &#125; ä»£ç å¾ˆç®€å•ï¼Œå°±æ˜¯è®©è„šæœ¬æ¯éš”10ç§’è¾“å‡ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä»»åŠ¡ä¹‹å‰å¯¹ä¸€äº›ä¿¡å·è¿›è¡Œæ•èŽ·ã€‚ åˆ†åˆ«å¯¹è¿›ç¨‹æ‰§è¡Œäº†ï¼Œkillã€kill QUITã€kill HUP å‘çŽ°è¿›ç¨‹éƒ½ä¼šè¢«ç›´æŽ¥ç»ˆæ­¢ã€‚ ä¸‹é¢æˆ‘ä»¬å¼€å§‹,å¯¹TERMè¿›è¡Œæ•èŽ·ã€‚ pcntl_signal(SIGTERM, [$this, 'sig_handler']); æ‰“å¼€æ³¨é‡Šã€‚ 15ä¿¡å·(TERM)è¢«æ•èŽ·åˆ°äº†ï¼Œä½†æ˜¯è¿›ç¨‹å¹¶æ²¡æœ‰é€€å‡º,è¿˜å†ç»§ç»­æ‰§è¡Œã€‚ æˆ‘ä»¬å†è¯•ä¸‹USR1ä¿¡å·ã€‚ USR1è¢«æ•èŽ·åˆ°äº†ï¼Œå¹¶ä¸”ç¨‹åºç«‹å³æ‰§è¡Œå®Œä¸€æ¬¡è¾“å‡ºé€€å‡ºäº†ã€‚æ³¨æ„æˆ‘æ˜¯ç¨‹åºè‡ªå·±æŽ§åˆ¶äº†,æ•èŽ·åˆ°USR1ä¹‹åŽä¸ç»§ç»­æ‰§è¡Œå¾ªçŽ¯ã€‚ ç»†å¿ƒçš„æœ‹å‹ä»¬å¯èƒ½ä¼šå‘çŽ°ï¼Œç¨‹åºä¸­çš„sleepè¢«è·³è¿‡äº†ã€‚ è¿™æ˜¯ä»€ä¹ˆåŽŸå› å‘¢? sleepäº‹å®žä¸Šsleepæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å‡½æ•°ã€‚å…¶å®žå®˜æ–¹æ–‡æ¡£æœ‰è§£é‡Š: sleepåœ¨è¢«ä¿¡å·ä¸­æ­¢æ—¶ï¼Œä¼šè¿”å›žéž0å€¼,éžwindowsä¸‹ä¼šè¿”å›žå‰©ä½™ç§’æ•°ã€‚ è®©æˆ‘ä»¬æ¥éªŒè¯ä¸‹ã€‚ while (true &amp;&amp; !$this->taskFinish) &#123; $res = sleep(10); $this->info(\"sleepè¿”å›ž:\".$res); $this->info(uniqid()); &#125; æˆ‘ä»¬è®°å½•äº†sleepæ‰§è¡Œå®Œçš„è¿”å›žå€¼ã€‚ å‘çŽ°ä¿¡å·ç»™åˆ°æ—¶ï¼Œsleepç¡®å®žä¼šè¿”å›žå‰©ä½™ç§’æ•°ã€‚è¿™å°±è§£é‡Šäº†ä¸ºä»€ä¹ˆä¸Šé¢çœ‹åˆ°çš„sleepè¢«è·³è¿‡äº†ã€‚ æ€»ç»“ A process can define how to handle incoming POSIX signals. If a process does not define a behaviour for a signal, then the default handler for that signal is being used. The table below lists some default actions for POSIX-compliant UNIX systems, such as FreeBSD, OpenBSD and Linux. killèƒ½ç»™è¿›ç¨‹å‘é€ä¿¡å·é‡ï¼Œå‘Šè¯‰è¿›ç¨‹æŒ‰ä»€ä¹ˆæ–¹å¼ç»“æŸã€‚ killå®šä¹‰çš„ä¸åŒä¿¡å·é‡ï¼Œç”¨æ³•ä¸åŒï¼Œä½†æ˜¯éœ€è¦ç¨‹åºè‡ªå·±åŽ»å¤„ç†ã€‚å®ƒåªæ˜¯å®šä¹‰äº†ç›®çš„ï¼Œä½†æœªå®šä¹‰è¿‡ç¨‹å’Œå®žé™…ç»“æžœã€‚ å‚è€ƒhttps://en.wikipedia.org/wiki/Signal_(IPC)","categories":[],"tags":[{"name":"php linux","slug":"php-linux","permalink":"http://visonforcoding.xyz/tags/php-linux/"}]},{"title":"spring bootåˆ†çŽ¯å¢ƒè‡ªå®šä¹‰é…ç½®","slug":"java/spring-bootåˆ†çŽ¯å¢ƒè‡ªå®šä¹‰é…ç½®","date":"2020-05-26T05:03:36.000Z","updated":"2021-10-30T02:59:33.277Z","comments":true,"path":"2020/05/26/java/spring-bootåˆ†çŽ¯å¢ƒè‡ªå®šä¹‰é…ç½®/","link":"","permalink":"http://visonforcoding.xyz/2020/05/26/java/spring-boot%E5%88%86%E7%8E%AF%E5%A2%83%E8%87%AA%E5%AE%9A%E4%B9%89%E9%85%8D%E7%BD%AE/","excerpt":"åœ¨ä¸€èˆ¬è§„æ¨¡ä¼ä¸šï¼Œåº”å½“éƒ½æœ‰æµ‹è¯•çŽ¯å¢ƒå’Œæ­£å¼çŽ¯å¢ƒåŒºåˆ«ï¼Œæˆ–è€…è‡³å°‘ä¹Ÿæœ‰å¼€å‘çŽ¯å¢ƒå’Œæ­£å¼çŽ¯å¢ƒã€‚é‚£ä¸åŒçŽ¯å¢ƒå¿…ç„¶å°±ä¼šæœ‰ä¸€äº›çŽ¯å¢ƒä¾èµ–çš„ä¸åŒï¼Œä¸ç®¡æ˜¯å‡ºäºŽå®‰å…¨æ€§è€ƒè™‘è¿˜æ˜¯å…¶ä»–åŽŸå› å¯¼è‡´çš„ã€‚æ¯”å¦‚æ•°æ®åº“é…ç½®ã€OSSè´¦å·ä¿¡æ¯ç­‰ã€‚é‚£ç¨‹åºå½“ä¸­å°±éœ€è¦é…ç½®å¤šä»½é…ç½®ä¿¡æ¯å’Œæ ¹æ®ä¸åŒçŽ¯å¢ƒä½¿ç”¨ä¸åŒé…ç½®","text":"åœ¨ä¸€èˆ¬è§„æ¨¡ä¼ä¸šï¼Œåº”å½“éƒ½æœ‰æµ‹è¯•çŽ¯å¢ƒå’Œæ­£å¼çŽ¯å¢ƒåŒºåˆ«ï¼Œæˆ–è€…è‡³å°‘ä¹Ÿæœ‰å¼€å‘çŽ¯å¢ƒå’Œæ­£å¼çŽ¯å¢ƒã€‚é‚£ä¸åŒçŽ¯å¢ƒå¿…ç„¶å°±ä¼šæœ‰ä¸€äº›çŽ¯å¢ƒä¾èµ–çš„ä¸åŒï¼Œä¸ç®¡æ˜¯å‡ºäºŽå®‰å…¨æ€§è€ƒè™‘è¿˜æ˜¯å…¶ä»–åŽŸå› å¯¼è‡´çš„ã€‚æ¯”å¦‚æ•°æ®åº“é…ç½®ã€OSSè´¦å·ä¿¡æ¯ç­‰ã€‚é‚£ç¨‹åºå½“ä¸­å°±éœ€è¦é…ç½®å¤šä»½é…ç½®ä¿¡æ¯å’Œæ ¹æ®ä¸åŒçŽ¯å¢ƒä½¿ç”¨ä¸åŒé…ç½® åˆ†çŽ¯å¢ƒé…ç½® # æ¿€æ´»æ—¥å¿—çŽ¯å¢ƒ spring.profiles.active&#x3D;prd å…¬å…±é…ç½®è¿˜æ˜¯å†™åœ¨applicationã€‚ç›¸åº”é…ç½®å†™åœ¨-{env} æ–‡ä»¶é‡Œã€‚ è‡ªå®šä¹‰é…ç½®èŽ·å–ä¸Šé¢æ˜¯springæ¡†æž¶æ‰€éœ€çš„é»˜è®¤é…ç½®æ–¹æ³•ï¼Œæˆ‘ä»¬é€šå¸¸è¿˜éœ€è¦éžå¸¸å¤šçš„è‡ªå®šä¹‰é…ç½®ã€‚æ¯”å¦‚å¯†ç çš„åŠ ç›saltç­‰ç­‰ï¼Œè¿™æ˜¯é¡¹ç›®çš„è‡ªå®šä¹‰é…ç½®ã€‚ é‚£å¦‚æžœå¯¹è¿™äº›è‡ªå®šä¹‰å†…å®¹è¿›è¡Œé…ç½®å’ŒèŽ·å–å‘¢ã€‚ é…ç½®æˆ‘ä»¬ä¾ç„¶å¯ä»¥åœ¨application.propertiesè¿›è¡Œé…ç½®ã€‚ ä¾‹å¦‚ï¼š app.security.salt=zM2Y&amp;*21.rkJr=11 app.oss.host=http://oss-cn-beijing.aliyuncs.com app.oss.bucket=bucketNanme app.oss.accessKey=accessKey app.oss.accessSecret=accessSecret èŽ·å–é…ç½®@Service public class OssService &#123; @Value(\"$&#123;app.oss.host&#125;\") private String host; @Value(\"$&#123;app.oss.accessKey&#125;\") private String accessKeyId; @Value(\"$&#123;app.oss.accessSecret&#125;\") private String accessKeySecret; @Value(\"$&#123;app.oss.bucket&#125;\") private String bucketName; &#125; ä¸€å®šè¦æ˜¯åœ¨spring beané‡Œè¿›è¡ŒèŽ·å–ï¼Œå¦åˆ™æ— æ³•èŽ·å–åˆ°ã€‚ å‚è€ƒ https://docs.spring.io/spring-boot/docs/1.5.22.RELEASE/reference/html/boot-features-external-config.html","categories":[],"tags":[{"name":"java spring-boot","slug":"java-spring-boot","permalink":"http://visonforcoding.xyz/tags/java-spring-boot/"}]},{"title":"mysqlå•ä¸ªè¡¨çš„æƒé™æŽ§åˆ¶","slug":"mysqlå•ä¸ªè¡¨çš„æƒé™æŽ§åˆ¶","date":"2020-05-08T01:43:39.000Z","updated":"2021-10-30T02:59:33.278Z","comments":true,"path":"2020/05/08/mysqlå•ä¸ªè¡¨çš„æƒé™æŽ§åˆ¶/","link":"","permalink":"http://visonforcoding.xyz/2020/05/08/mysql%E5%8D%95%E4%B8%AA%E8%A1%A8%E7%9A%84%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6/","excerpt":"åœ¨ç³»ç»Ÿå¼€å‘å½“ä¸­æœ‰è¿™æ ·çš„éœ€æ±‚ï¼ŒAç³»ç»Ÿéœ€è¦è¯»å†™Bç³»ç»Ÿçš„æ•°æ®åº“æ•°æ®,ä½†æ˜¯æŸäº›ç‰¹æ®Šçš„è¡¨æ•°æ®åªå…è®¸è¯»æ“ä½œã€‚è¿™æ—¶å€™å°±éœ€è¦åšåˆ°è¡¨çº§çš„æƒé™æŽ§åˆ¶ã€‚","text":"åœ¨ç³»ç»Ÿå¼€å‘å½“ä¸­æœ‰è¿™æ ·çš„éœ€æ±‚ï¼ŒAç³»ç»Ÿéœ€è¦è¯»å†™Bç³»ç»Ÿçš„æ•°æ®åº“æ•°æ®,ä½†æ˜¯æŸäº›ç‰¹æ®Šçš„è¡¨æ•°æ®åªå…è®¸è¯»æ“ä½œã€‚è¿™æ—¶å€™å°±éœ€è¦åšåˆ°è¡¨çº§çš„æƒé™æŽ§åˆ¶ã€‚ revokeMysqlæœ¬èº«æ˜¯æ”¯æŒç”¨revokeè¿›è¡Œæƒé™å›žæ”¶æ“ä½œçš„ã€‚ https://dev.mysql.com/doc/refman/5.6/en/revoke.html REVOKE priv_type [(column_list)] [, priv_type [(column_list)]] ... ON [object_type] priv_level FROM user [, user] ... REVOKE ALL [PRIVILEGES], GRANT OPTION FROM user [, user] ... REVOKE PROXY ON user FROM user [, user] ... ä»Žè¯­æ³•å½“ä¸­å¯ä»¥çœ‹åˆ°è¿˜å¯ä»¥åšåˆ°åˆ—çº§åˆ«çš„æŽ§åˆ¶ã€‚ é—®é¢˜mysql&gt; revoke insert,delete,update on db_oms.t_order from &#39;oms_order_ro&#39;@&#39;localhost&#39;; ERROR 1147 (42000): There is no such grant defined for user &#39;oms_order_ro&#39; on host &#39;localhost&#39; on table &#39;t_order&#39; ä½†æ˜¯äº‹å®žä¸Šï¼Œæ‰§è¡Œçš„æ—¶å€™ä¼šé‡åˆ°é—®é¢˜ã€‚ ä»€ä¹ˆåŽŸå› å‘¢ï¼Ÿ mysql&gt; show grants for oms_order_ro@localhost -&gt; ; +----------------------------------------------------------------------------------+ | Grants for oms_order_ro@localhost | +----------------------------------------------------------------------------------+ | GRANT USAGE ON *.* TO &#39;oms_order_ro&#39;@&#39;localhost&#39; | | GRANT SELECT, INSERT, UPDATE, DELETE ON &#96;db_oms&#96;.* TO &#39;oms_order_ro&#39;@&#39;localhost&#39; | +----------------------------------------------------------------------------------+ ä»”ç»†çœ‹ä¸‹ï¼Œæˆ‘ä»¬æ˜¯ä½¿ç”¨çš„é€šé…ç¬¦åŽ»è¿›è¡Œèµ‹æƒé™ã€‚çœ‹èµ·æ¥è¿™é‡Œmysqlè¿˜æ˜¯è¡¨çŽ°çš„æ¯”è¾ƒæœ¬ã€‚è®¤ä¸ºæ²¡æœ‰è¯¥æƒé™è¿›è¡Œå›žæ”¶ã€‚ é‚£ä¹ˆæ­£ç¡®çš„åšæ³•åº”è¯¥æ˜¯æ€Žæ ·çš„å‘¢ï¼Ÿ Managing access in mysql can be quite dificult !! Once you gave him database.* you cannot revoke access for an object that is in that class. MySQL doesnâ€™t expand the Hotels.* wildcard to the individual tables The permissions tables store the granted permissions. Therefore, since you didnâ€™t actually grant anything on Hotels.AllHotels , thereâ€™s nothing for MySQL to revoke. In this case you need to do it granular form the start ! Remove all privileges on database, table, column levels, etccc. Grant privileges to EACH table, except â€˜you chooseâ€™.Grant privilege to specified fields in table â€˜you chooseâ€™. æˆ‘ä»¬å¿…é¡»è¦é€ä¸ªé€ä¸ªè¡¨è¿›è¡Œèµ‹æƒé™ï¼Œç„¶åŽè¿›è¡Œå›žæ”¶ã€‚ å®žé™…ä¸Šè¿™ä¹ˆæ“ä½œè™½ç„¶èƒ½è§£å†³é—®é¢˜ï¼Œä½†æ˜¯ä¼šå¸¦æ¥è·Ÿå¤šé—®é¢˜ï¼Œå¦‚æžœè¡¨å¢žåŠ äº†ã€‚ä½ å¿…é¡»å†å¯¹è¿™ä¸ªè¡¨è¿›è¡Œèµ‹æƒé™å’Œå›žæ”¶æƒé™ã€‚","categories":[],"tags":[{"name":"mysql","slug":"mysql","permalink":"http://visonforcoding.xyz/tags/mysql/"}]},{"title":"Seleniumè‡ªåŠ¨åŒ–æµ‹è¯•åœ¨é¡µé¢webæ€§èƒ½æµ‹è¯•åº”ç”¨çš„å°è¯•","slug":"Seleniumè‡ªåŠ¨åŒ–æµ‹è¯•åœ¨é¡µé¢webæ€§èƒ½æµ‹è¯•åº”æœ‰çš„å°è¯•","date":"2020-05-07T15:26:14.000Z","updated":"2021-10-30T02:59:33.275Z","comments":true,"path":"2020/05/07/Seleniumè‡ªåŠ¨åŒ–æµ‹è¯•åœ¨é¡µé¢webæ€§èƒ½æµ‹è¯•åº”æœ‰çš„å°è¯•/","link":"","permalink":"http://visonforcoding.xyz/2020/05/07/Selenium%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95%E5%9C%A8%E9%A1%B5%E9%9D%A2web%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%E5%BA%94%E6%9C%89%E7%9A%84%E5%B0%9D%E8%AF%95/","excerpt":"å¯¹äºŽwebæµ‹è¯•ï¼Œæˆ‘ä»¬é€šå¸¸åœ¨åšçš„æµ‹è¯•éƒ½æ˜¯äººå·¥çš„åŠŸèƒ½æµ‹è¯•ã€‚é‚£ä¹ˆå°‘è§çš„è‡ªåŠ¨åŒ–æµ‹è¯•åˆ°åº•é€‚ç”¨å“ªäº›åœºæ™¯å‘¢ï¼Ÿ","text":"å¯¹äºŽwebæµ‹è¯•ï¼Œæˆ‘ä»¬é€šå¸¸åœ¨åšçš„æµ‹è¯•éƒ½æ˜¯äººå·¥çš„åŠŸèƒ½æµ‹è¯•ã€‚é‚£ä¹ˆå°‘è§çš„è‡ªåŠ¨åŒ–æµ‹è¯•åˆ°åº•é€‚ç”¨å“ªäº›åœºæ™¯å‘¢ï¼Ÿ ç”¨pythonè¿›è¡Œwebè‡ªåŠ¨åŒ–æµ‹è¯• å‰æ®µæ—¶é—´ï¼Œåœ¨å®¢æœä¿¡æ¯ç³»ç»Ÿè¿›å…¥ç”¨æˆ·ä½“éªŒé˜¶æ®µæ—¶å‘çŽ°å†…å­˜å­˜åœ¨æ³„éœ²é—®é¢˜ã€‚æˆ‘ä»¬èŠ±äº†å¾ˆå¤šæ—¶é—´åŽ»æŽ’æŸ¥åŽŸå› ã€‚ç»è¿‡å„ç§å¯èƒ½çš„ä¼˜åŒ–æ–¹æ¡ˆï¼Œç»“æžœå‘çŽ°æ²¡æœ‰å®žè´¨æ€§çš„æ•ˆæžœï¼ŒäºŽæ˜¯æˆ‘ä»¬å†³å®šé‡æž„ã€‚ä½†æ˜¯å¦‚ä½•ä¿è¯é‡æž„æ–¹æ¡ˆçš„å¯è¡Œå‘¢ï¼ŸäºŽæ˜¯æˆ‘ä»¬ç”¨åˆ°äº†python+Selenium ä¸ºä»€ä¹ˆä¼šç”¨åˆ°webè‡ªåŠ¨åŒ–æµ‹è¯•webè‡ªåŠ¨åŒ–æµ‹è¯•é€‚ç”¨åœºæ™¯å¯¹äºŽwebæµ‹è¯•ï¼Œæˆ‘ä»¬é€šå¸¸åœ¨åšçš„æµ‹è¯•éƒ½æ˜¯äººå·¥çš„åŠŸèƒ½æµ‹è¯•ã€‚é‚£ä¹ˆå°‘è§çš„è‡ªåŠ¨åŒ–æµ‹è¯•åˆ°åº•é€‚ç”¨å“ªäº›åœºæ™¯å‘¢ï¼Ÿ å›žå½’æµ‹è¯•ã€‚æ¯ä¸€æ¬¡åº”ç”¨å‘å¸ƒï¼Œéƒ½ä¼´éšç€ä¸€æ¬¡å›žå½’æµ‹è¯•ã€‚å¯¹äºŽé‡å¤æ€§çš„å·¥ä½œï¼Œæœºå™¨æ˜¾ç„¶æ›´é€‚åˆã€‚ å…¼å®¹æ€§æµ‹è¯•ã€‚ä¸ç®¡æ˜¯Webæµ‹è¯•ï¼Œè¿˜æ˜¯Appæµ‹è¯•ï¼Œå…¼å®¹æ€§æµ‹è¯•éƒ½æ˜¯å¿…ä¸å¯å°‘çš„ä¸€çŽ¯ã€‚ä»¥Webæµ‹è¯•ä¸ºä¾‹ï¼ŒåŒæ ·çš„æµ‹è¯•ç”¨ä¾‹ï¼Œéœ€è¦åœ¨ä¸åŒçš„æµè§ˆå™¨ä¸Šåˆ†åˆ«è¿è¡Œä¸€éï¼Œè¿™å¯¹æµ‹è¯•äººå‘˜è€Œè¨€ä¸å¯è°“ä¸æ˜¯ä¸€ç§æŠ˜ç£¨ã€‚ å¤§è§„æ¨¡æµ‹è¯•ã€‚å¦‚æžœä¸€æ¬¡æµ‹è¯•æ¶‰åŠçš„æµ‹è¯•ç”¨ä¾‹è¿‡å¤šï¼ˆæ¯”å¦‚100+ï¼‰ï¼ŒåŠŸèƒ½æµ‹è¯•éš¾å…ä¼šæœ‰é—æ¼æˆ–è€…é‡å¤ï¼Œè€Œè‡ªåŠ¨åŒ–æµ‹è¯•å¯ä»¥è½»æ¾ç¡®ä¿ä¸€ä¸ªä¸å°‘ï¼Œä¸€ä¸ªä¹Ÿä¸å¤šã€‚ æ€§èƒ½æµ‹è¯• å¼Šç«¯ä¸‡äº‹çš†æœ‰åˆ©å¼Šï¼Œæœºå™¨çš„è‡ªåŠ¨åŒ–æµ‹è¯•æ²¡æœ‰å¹¿æ³›åº”ç”¨è‚¯å®šæ˜¯æœ‰åŽŸå› çš„ã€‚ ä¸ä½Žçš„æŠ€æœ¯é—¨æ§›ã€‚ä¸è®ºæ˜¯ä½¿ç”¨å“ªç§è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æž¶ï¼Œå¯¹äºŽæµ‹è¯•äººå‘˜è€Œè¨€ï¼Œéƒ½å­˜åœ¨ä¸€å®šçš„æŠ€æœ¯é—¨æ§›ï¼Œä¸€èˆ¬è‡³å°‘éœ€è¦å­¦ä¹ å¹¶æŽŒæ¡ä¸€é—¨ç¼–ç¨‹è¯­è¨€ã€‚å¯è§‚çš„å¼€å‘æˆæœ¬å’Œç»´æŠ¤æˆæœ¬ã€‚è·Ÿä»»ä½•ç¨‹åºä¸€æ ·ï¼Œæ— è®ºæ˜¯ç¼–å†™è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬ï¼Œè¿˜æ˜¯åœ¨éœ€æ±‚å˜åŒ–æ—¶ä¿®æ”¹è„šæœ¬ï¼Œéƒ½éœ€è¦èŠ±è´¹å¤§é‡çš„æ—¶é—´ã€‚ éœ€æ±‚è¦ç¨³å®šã€‚è‡ªåŠ¨åŒ–æµ‹è¯•çš„å‰ææ˜¯æµ‹è¯•ç”¨ä¾‹è¦ç¨³å®šï¼Œè€Œæµ‹è¯•ç”¨ä¾‹ç¨³å®šçš„å‰ææ˜¯éœ€æ±‚è¦ç¨³å®šã€‚å¯¹äºŽä¸´æ—¶çš„æˆ–è€…è¯´ä¸€æ¬¡æ€§çš„éœ€æ±‚ï¼Œè‡ªåŠ¨åŒ–æµ‹è¯•å¾€å¾€æ˜¯å¾—ä¸å¿å¤±çš„ã€‚ åº”ç”¨å‘¨æœŸé•¿ã€‚åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸè¶Šé•¿ï¼Œè‡ªåŠ¨åŒ–æµ‹è¯•èŠ‚çœçš„æ—¶é—´è¶Šå¤šï¼Œå¸¦æ¥çš„ä»·å€¼ä¹Ÿè¶Šå¤§ã€‚ æ€§èƒ½æµ‹è¯•éšç€webå‰ç«¯æŠ€æœ¯å‘å±•æ›´æ–°è¶Šæ¥è¶Šè¿…çŒ›çš„æ€åŠ¿ï¼Œå‰ç«¯æŠ€æœ¯å’Œæ¡†æž¶å±‚å‡ºä¸ç©·ã€‚ä½†å¾€å¾€æˆ‘ä»¬ä¼šåœ¨çŸ­æœŸå†…é«˜ä¼°æŠ€æœ¯å¸¦æ¥çš„å½±å“ã€‚ æ‰€ä»¥å¯¹äºŽä»»ä½•ä¸€ä¸ªæ–°çš„äº‹ç‰©ï¼Œæˆ‘ä»¬é‡‡å–ä¿å®ˆçš„æ€åº¦å¯¹å¾…å¯èƒ½ä¼šå°‘è·Œå…¥ä¸€äº›å¹»ç­çš„ä½Žè°·æœŸã€‚å¯¹äºŽæ–°æŠ€æœ¯åšå……åˆ†çš„è¯„ä¼°æµ‹è¯•ï¼Œå¯èƒ½ä¼šè®©æˆ‘ä»¬å°‘è¸©ä¸€äº›å‘ã€‚å½“ç„¶å¾€å¾€è¿™è¯ï¼Œéƒ½æ˜¯åœ¨äº‹åŽæ‰ä¼šæå‡ºæ¥ã€‚ ä¸ºä»€ä¹ˆå¯ä»¥ç”¨è‡ªåŠ¨åŒ–æµ‹è¯•åšæ€§èƒ½æµ‹è¯•ï¼Ÿç½‘ä¸Šä¼¼ä¹Žéƒ½æ²¡æœ‰è¿™ç§å…ˆä¾‹ã€‚æˆ‘æ€»ç»“ä»¥ä¸‹å‡ ä¸ªåŽŸå› ï¼š è„šæœ¬èƒ½å¼ºæœ‰è§„å¾‹åœ°é‡å¤æ‰§è¡Œæ“ä½œï¼Œè€Œå¼€å‘æˆ–æµ‹è¯•è‡ªå·±åšè¿™ä¸ªå·¥ä½œä¼šå¾ˆç¹çè€Œä¸”å‡ºäº†ä¸€æ­¥å·®é”™å°±å¾—é‡æ¥ è„šæœ¬èƒ½å°†æ‰§è¡Œæ“ä½œå’Œæ•°æ®è®°å½•ç»“åˆèµ·æ¥ã€‚è€Œäººç±»æ‰§è¡Œä¸€æ¬¡æ•°æ®è®°å½•å’ŒåŠ¨ä½œæ‰§è¡Œä¹Ÿè®¸æ²¡é—®é¢˜ï¼Œä½†é‡å¤500æ¬¡æˆ–æ›´å¤šè€Œæ— å·®é”™é‚£å°±å›°éš¾äº†ã€‚ webè‡ªåŠ¨åŒ–æµ‹è¯•æ–¹æ³• python+Selenium è·¨æµè§ˆå™¨æ”¯æŒ puppeteer ä¸“æ³¨äºŽchrome airtest è·¨å¹³å°ï¼Œå®‰å“ã€iosã€webï¼Œwebè¿˜æ˜¯ç”¨çš„Selenium æµ‹è¯•ç»“æžœ æ‰§è¡Œè„šæœ¬ è„šæœ¬è¿è¡Œæƒ…å†µï¼Œæµè§ˆå™¨åœ¨è‡ªåŠ¨è¿›è¡Œæ“ä½œ å¾—å‡ºç»Ÿè®¡ç»“æžœã€‚æˆ‘ä»¬æ¨¡æ‹Ÿç”¨æˆ·çš„æŸä¸ªæœ€é¢‘ç¹çš„æ“ä½œï¼Œå‘çŽ°é‡‡ç”¨æ–°çš„æ–¹æ¡ˆåŽå†…å­˜ä¼šåœ¨çŸ­æ—¶é—´å†…æœ‰æ•ˆå›žæ”¶ã€‚æ•´ä½“ä¸Šï¼Œé¡µé¢å†…å­˜ä¼šè¶‹äºŽç¨³å®šçš„æ€åŠ¿ã€‚ é‡åˆ°çš„é—®é¢˜åŠ¨æ€çš„ggcodeggcode = prompt(\"è¾“å…¥è°·æ­Œç : \") ç”±äºŽç™»å½•ç”¨çš„è°·æ­Œç æ˜¯åŠ¨æ€çš„ï¼Œæ‰€ä»¥è¿™é‡Œåªèƒ½æ¯æ¬¡è¾“å…¥è¿›è¡Œå¡«å……ã€‚è¿™é‡Œæˆ‘ä»¬å¼•å…¥prompt_toolkitè¿›è¡Œç»ˆç«¯çš„äº¤äº’ èŽ·å–å…ƒç´ å¦‚ä»Šçš„å‰ç«¯é¡¹ç›®ï¼Œç”±äºŽä½¿ç”¨çš„æ˜¯æ•°æ®é©±åŠ¨domï¼Œä¸æ˜¯ä¼ ç»Ÿçš„jqueryæ“ä½œï¼ŒçŽ°åœ¨åŸºæœ¬çœ‹ä¸åˆ°id classç­‰è¿›è¡Œå…ƒç´ å®šä½ã€‚çŽ°åœ¨æœ€æ–¹ä¾¿çš„åšæ³•åªèƒ½æ˜¯é€šè¿‡xpathå¯»æ‰¾å…ƒç´ ã€‚ xpath &#x3D; &#39;&#x2F;&#x2F;*[@id&#x3D;&quot;app&quot;]&#x2F;div&#x2F;div[2]&#x2F;div[1]&#39; element &#x3D; self.browser.find_element_by_xpath( xpath) ç”±äºŽä¸æ˜¯å›ºå®šidï¼Œé¡µé¢ä¸€æ—¦æ”¹å˜xpathå¾ˆæœ‰å¯èƒ½æ”¹å˜ï¼Œä¼šå¯¼è‡´å…ƒç´ æ‰¾ä¸åˆ°ã€‚ webdriverè¿›ç¨‹ä¸é€€å‡ºåœ¨ä½¿ç”¨è¿‡ç¨‹å½“ä¸­å‘çŽ°æä¾›çš„quit() æ–¹æ³•å¹¶ä¸èƒ½è®©è¿›ç¨‹é€€å‡ºï¼Œæ‰€ä»¥åªèƒ½è‡ªå·±å°†è¿›ç¨‹killæŽ‰ã€‚ def close_browser(self): ç‚¹å‡»åœ¨è¿›è¡ŒæŒ‰é’®ç‚¹å‡»çš„æ—¶å€™ï¼Œç»å¸¸ä¼šå› ä¸ºé¡µé¢æœªåŠ è½½å®Œç­‰åŽŸå› å¯¼è‡´æ— æ³•ç‚¹å‡»ã€‚ç»“æžœå°±æ˜¯å¯èƒ½ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚å¯¹äºŽè¿™ç§æƒ…å†µwebdriveræœ¬èº«æœ‰æä¾›waitç­‰å¾…ã€‚ wait = WebDriverWait(self.browser, 30) element = wait.until(EC.element_to_be_clickable((By.XPATH, xpath))) WebDriverWait éœ€è¦è®¾ç½®ä¸€ä¸ªç­‰å¾…æ—¶é•¿ï¼Œä¸å¯èƒ½æ— é™ç­‰å¾… è¿˜æœ‰äº›æƒ…å†µä¸‹ï¼Œæ˜¯ç”±äºŽéœ€è¦ä¸‹æ‹‰æ»šåŠ¨æ¡æ‰èƒ½è¿›è¡Œç‚¹å‡»ã€‚è¿™ç§æƒ…å†µå¯ä»¥è€ƒè™‘æ‰§è¡Œjsè¿›è¡Œç‚¹å‡»ã€‚ js_click_next_page = 'document.querySelector(\"body > div.worker-order-search-list > div.content-wrapper > section > ul > li.ivu-page-next\").click()' browser.execute_script(js_click_next_page) ä½¿ç”¨webdriver.clickè¿˜æ˜¯ç”¨jsç‚¹å‡»ï¼Ÿ When Should You Use JavaScript for Clicking?If you are using Selenium for testing an application, my answer to this question is â€œalmost neverâ€. By and large, your Selenium test should reproduce what a user would do with the browser. Taking the example of the drop down menu: a test should click on the button that brings up the drop down first, and then click on the menu item. If there is a problem with the GUI because the button is invisible, or the button fails to show the menu items, or something similar, then your test will fail and youâ€™ll have detected the bug. If you use JavaScript to click around, you wonâ€™t be able to detect these bugs through automated testing. æ€»ä¹‹è¿˜æ˜¯çœ‹ä½ çš„ä½¿ç”¨ç›®çš„ï¼Œå¦‚æžœè‡ªåŠ¨åŒ–æµ‹è¯•çš„ç›®çš„å€¾å‘äºŽæµ‹è¯•é¡µé¢åŠŸèƒ½ã€‚é‚£ä¹ˆå»ºè®®ä½¿ç”¨webdriver.clickã€‚å¦‚æžœæ˜¯ä¸ºäº†æµ‹è¯•æ€§èƒ½ï¼Œé‚£å¯ä»¥è¿›è¡Œjsç‚¹å‡»äº†ã€‚ èŽ·å–é¡µé¢å†…å­˜æµè§ˆå™¨çš„ä»»åŠ¡ç®¡ç†å™¨å¯ä»¥å¾ˆå®¹æ˜“çš„çœ‹åˆ°é¡µé¢çš„å†…å­˜ã€cpuã€ç½‘ç»œæƒ…å†µï¼Œä½†æ˜¯å¦‚ä½•èŽ·å–åˆ°è®°å½•å¹¶ç»Ÿè®¡å‘¢ï¼Ÿ ç­”æ¡ˆæ˜¯ï¼Œå¾ˆå¯æƒœçŽ°åœ¨è¿˜æ²¡æ‰¾åˆ°ã€‚å¦‚æžœæœ‰å®˜æ–¹åŠžæ³•ï¼Œè¯·å‘Šè¯‰æˆ‘ã€‚ æˆ‘èµ°äº†ä¸€ä¸ªå…¶ä»–é€”å¾„èŽ·å–ï¼Œä»Žæ“ä½œç³»ç»Ÿå±‚é¢èŽ·å–è¿›ç¨‹ã€‚èŽ·å–ä¸€ä¸ªè¿›ç¨‹å¾—å†…å­˜å ç”¨æ˜¯ä¸€ä¸ªç®€å•çš„äº‹ï¼Œä½†æ˜¯å¦‚ä½•çŸ¥é“æŸä¸ªé¡µé¢çš„è¿›ç¨‹idå‘¢ã€‚å¾ˆé—æ†¾çš„æ˜¯ï¼ŒwebdriveråŒæ ·æ²¡æœ‰æŽ¥å£æ–¹æ³•æä¾›ã€‚äºŽæ˜¯æˆ‘åªèƒ½ä»Žwebdriverå­è¿›ç¨‹å…¥æ‰‹ï¼Œçœ‹æœ‰æ²¡æœ‰ä¿¡æ¯èƒ½ä¸Žpageå…³è”ä¸Šã€‚å¾ˆé—æ†¾çš„äº‹ï¼Œå•å•ä»Žå­è¿›ç¨‹åçœ‹ä¸Žé¡µé¢æ¯«æ— å…³è”ã€‚æ‰€ä»¥ã€‚ã€‚æœ€åŽï¼Œæˆ‘åªèƒ½åšä¸€ä¸ªå‡è®¾ï¼Œå‡è®¾æµè§ˆå™¨å¯åŠ¨ç±»ä¼¼linuxå¯åŠ¨ã€‚å¯åŠ¨çš„ç¨‹åºæ˜¯æœ‰å…ˆåŽå…³ç³»çš„ã€‚ def get_page_pid(self, page_num=1): \"\"\"[èŽ·å–å¯åŠ¨é¡µé¢çš„è¿›ç¨‹id,éžå®˜æ–¹æ–¹æ³•,ä¸ä¸€å®šæ­£ç¡®ã€‚ åŽŸç†:å‡è®¾chromeä¸»è¿›ç¨‹å¯åŠ¨å­è¿›ç¨‹æ˜¯æœ‰é¡ºåºçš„,é‚£ä¹ˆæ‰“å¼€çš„é¡µé¢è¿›ç¨‹åœ¨ç¬¬4ä¸ªå¼€å§‹å¯åŠ¨] Returns: [type] -- [description] \"\"\" webdriver_pid = self.browser.service.process.pid ps = psutil.Process(webdriver_pid) ps_children = ps.children(True) return ps_children[3+page_num-1].pid è¿™æ˜¯ä¸€ç§å¯¹é¡¹ç›®æ— ä¾µå…¥çš„åšæ³•ï¼Œä½ ä¸éœ€è¦æ”¹åŠ¨é¡¹ç›®ä»£ç ï¼Œå°±å¯ä»¥å¯¹æµè§ˆå™¨é¡µé¢å†…å­˜è¿›è¡Œç»Ÿè®¡ã€‚è¿˜æœ‰å…¶ä»–åšæ³•ï¼Œå¯ä»¥å¯¹é¡¹ç›®è¿›è¡Œå¢žåŠ å†…å­˜ä¸ŠæŠ¥è¿›è¡Œç»Ÿè®¡ã€‚ä½†è¿™æ ·çš„åšæ³•åŒæ ·æœ‰å¼Šç«¯ï¼š éœ€è¦åŠ¨è¢«æµ‹é¡¹ç›®ï¼Œå¯¹é¡¹ç›®å¹²æ‰° å¢žåŠ å·¥ä½œé‡ï¼Œä¸å…‰æ˜¯ä¸ŠæŠ¥è¿˜åŒ…æ‹¬æŽ¥æ”¶ä¸ŠæŠ¥æŽ¥å£ å¦‚æžœæ˜¯å¤šiframeé¡µç­¾æ–¹å¼ï¼Œç»Ÿè®¡èšåˆä¸ŠæŠ¥å°†éžå¸¸ç¹ç éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç»Ÿè®¡é¡µé¢è¿›ç¨‹æ–¹æ³•ã€‚å¾—åˆ°çš„æ•°æ®æ˜¯æ•´ä¸ªé¡µé¢è¿›ç¨‹æ‰€å ç”¨çš„å†…å­˜ï¼Œå¹¶éžé¡µé¢jså ç”¨å†…å­˜ã€‚ ç»Ÿè®¡åœ¨ç»Ÿè®¡ä¸Šï¼Œæˆ‘ä½¿ç”¨äº†chartify+pandas,åªè¦ä¼ å…¥æ•°æ®å°±èƒ½å¿«æ·åœ°ç”Ÿæˆå›¾è¡¨ def chartArea(self, data, x_column, y_column): \"\"\"[ç»˜åˆ¶åŒºåŸŸå›¾] Arguments: data &#123;[dict]&#125; -- [æ•°æ®çŸ©é˜µ,æ‹¿åŽ»æž„å»ºpandas dataFrame] x_column &#123;[type]&#125; -- [xè½´å­—æ®µ] y_column &#123;[type]&#125; -- [yè½´å­—æ®µ] \"\"\" data_frame = pd.DataFrame(data) print(data_frame) self.ch.plot.area(data_frame=data_frame, x_column=x_column, y_column=y_column, stacked=True) def show(self, show_type='html'): self.ch.save('./output/%s-%s.png' % (self.subtitle, time.strftime(\"%Y%m%d%H%M%S\")), 'png') æ€»ç»“æ­£å¦‚å‰é¢æ‰€è¯´ï¼Œwebè‡ªåŠ¨åŒ–æµ‹è¯•æ²¡æœ‰å¹¿æ³›åº”ç”¨è‚¯å®šæ˜¯æœ‰åŽŸå› çš„ã€‚ä½†æ˜¯åšä¸ºå‰ç«¯é—®é¢˜çš„è®ºè¯è¿˜æ˜¯æœ‰å¾ˆå¤§æ„ä¹‰ã€‚ æ¯”å¦‚ï¼Œé¡µé¢å ç”¨å†…å­˜é™åˆ¶æ˜¯å¤šå°‘ï¼Ÿæˆ‘æ‰¾äº†å¾ˆå¤šèµ„æ–™æ²¡æœ‰æ‰¾åˆ°(å®˜æ–¹çš„æ‰å¯ä¿¡)ã€‚ é€šè¿‡æµ‹è¯•ï¼Œæˆ‘å¾—åˆ°çš„ç»“æžœæ˜¯ï¼Œchrome å¯¹å•é¡µé¢js å†…å­˜æœ‰é™åˆ¶2G,å¯¹é¡µé¢è¿›ç¨‹å†…å­˜æ— é™åˆ¶ã€‚ä½ ä¸€ä¸ªé¡µé¢è¿›ç¨‹ç”šè‡³å¯ä»¥è·‘åˆ°20Gã€‚ python+Selenium ä½¿ç”¨èµ·æ¥å¾ˆç®€å•ï¼Œæ„Ÿå…´è¶£åˆæœ‰éœ€è¦çš„è¯ï¼Œä¸å¦¨ä¸€è¯•ã€‚ é™„åŠ ","categories":[],"tags":[{"name":"python","slug":"python","permalink":"http://visonforcoding.xyz/tags/python/"}]},{"title":"Hello world","slug":"Hello-world","date":"2020-05-07T12:08:35.000Z","updated":"2021-11-28T05:26:44.174Z","comments":true,"path":"2020/05/07/Hello-world/","link":"","permalink":"http://visonforcoding.xyz/2020/05/07/Hello-world/","excerpt":"","text":"hello,world","categories":[],"tags":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://visonforcoding.xyz/tags/%E9%9A%8F%E7%AC%94/"}]},{"title":"å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨-ç¨‹åºå‘˜å·¥å…·","slug":"å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨","date":"2019-04-04T12:00:57.000Z","updated":"2021-10-30T02:59:33.283Z","comments":true,"path":"2019/04/04/å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨/","link":"","permalink":"http://visonforcoding.xyz/2019/04/04/%E5%B7%A5%E6%AC%B2%E5%96%84%E5%85%B6%E4%BA%8B%E5%BF%85%E5%85%88%E5%88%A9%E5%85%B6%E5%99%A8/","excerpt":"æé«˜å·¥ä½œæ•ˆçŽ‡ï¼Œé¦–å…ˆä½ å¾—æœ‰ä¸€å¥—ç”¨çš„é¡ºæ‰‹çš„å·¥å…· å›¾åºŠ","text":"æé«˜å·¥ä½œæ•ˆçŽ‡ï¼Œé¦–å…ˆä½ å¾—æœ‰ä¸€å¥—ç”¨çš„é¡ºæ‰‹çš„å·¥å…· å›¾åºŠ PicGo æ”¯æŒç²˜è´´æ¿ï¼Œç›´æŽ¥ä¸Šä¼ åˆ°äº‘å­˜å‚¨ã€‚ æˆ‘ç”¨ä¸ƒç‰›äº‘ï¼Œä¸Šä¼ ä¹‹åŽåˆ¶åŠ¨æŠŠmarkdownçš„æ ¼å¼åœ°å€ï¼Œæ”¾åˆ°ç²˜è´´æ¿ç›´æŽ¥å¯ä»¥ç²˜è´´åˆ°markdown. å¯¹å–œæ¬¢ç”¨markdownå†™ä½œçš„åŒå­¦éžå¸¸æ–¹ä¾¿ è®°äº‹æœ¬avenote ä¹‹å‰avenoteæ— æ³•å†™markdownï¼Œæˆ‘æ˜¯æ€Žä¹ˆä¹Ÿå–œæ¬¢ä¸ä¸Šã€‚æœ€è¿‘å‘çŽ°ç‰ˆæœ¬æ›´æ–°ä¹‹åŽå¯ä»¥æ–°å»ºmarkdownæ ¼å¼ã€‚æˆ‘ç”¨é‡æ–°ä½¿ç”¨ä¸Šäº†ã€‚ boostnote è¿™æ˜¯ä¸€æ¬¾ä¸“ä¸ºç¨‹åºå‘˜è®¾è®¡çš„è®°äº‹æœ¬ï¼Œæ”¯æŒä»£ç ç‰‡æ®µæ ¼å¼å’Œmarkdownæ ¼å¼ã€‚ æˆ‘æœ€å–œæ¬¢çš„ä¸€ç‚¹æ˜¯å®ƒçš„å¾…åŠžè¿›åº¦å±•ç¤ºï¼Œå¾ˆç›´è§‚ã€‚ ç¼ºç‚¹å°±æ˜¯æ²¡æœ‰äº‘ç«¯åŠŸèƒ½å’Œæ²¡æœ‰æ‰‹æœºç‰ˆã€‚ restå®¢æˆ·ç«¯Insomnia å®ƒæœ€å¤§çš„äº®ç‚¹æ˜¯èƒ½æ”¯æŒä»Žcurlå‘½ä»¤é‡Œæ–°å»ºrequestå®žä¾‹ï¼Œèƒ½ä»Žchromeåˆ©çš„copy as curl å¤åˆ¶è¿‡æ¥æ— ç¼å¯¹æŽ¥ã€‚åœ¨è°ƒè¯•æŽ¥å£çš„æ—¶å€™ç®€ç›´æ˜¯å®Œç¾Žï¼ gitå®¢æˆ·ç«¯gitKarken ç« é±¼ðŸ™å“¥æ˜¯æˆ‘åˆ°ç›®å‰ä¸ºæ­¢æœ€å–œæ¬¢çš„gitå®¢æˆ·ç«¯ï¼Œç•Œé¢ç¾Žè§‚ï¼Œæ“ä½œè®¾è®¡èˆ’æœï¼Œå¯¹gitflowä¼˜é›…æ”¯æŒã€‚ git flow æ“ä½œå¾ˆæ–¹ä¾¿äº†ã€‚ æŒç»­æ›´æ–°ä¸­ã€‚ã€‚ã€‚","categories":[],"tags":[{"name":"ç¨‹åºäººç”Ÿ","slug":"ç¨‹åºäººç”Ÿ","permalink":"http://visonforcoding.xyz/tags/%E7%A8%8B%E5%BA%8F%E4%BA%BA%E7%94%9F/"}]},{"title":"docker+compose+nginx+php","slug":"docker-compose-nginx-php","date":"2018-07-22T08:52:09.000Z","updated":"2021-10-30T02:59:33.275Z","comments":true,"path":"2018/07/22/docker-compose-nginx-php/","link":"","permalink":"http://visonforcoding.xyz/2018/07/22/docker-compose-nginx-php/","excerpt":"","text":"Docker å¯ä»¥è®©å¼€å‘è€…æ‰“åŒ…ä»–ä»¬çš„åº”ç”¨ä»¥åŠä¾èµ–åŒ…åˆ°ä¸€ä¸ªè½»é‡çº§ã€å¯ç§»æ¤çš„å®¹å™¨ä¸­ï¼Œç„¶åŽå‘å¸ƒåˆ°ä»»ä½•æµè¡Œçš„ Linux æœºå™¨ä¸Šï¼Œä¹Ÿå¯ä»¥å®žçŽ°è™šæ‹ŸåŒ–ã€‚ æˆ‘ç”¨dockeråšä»€ä¹ˆï¼Ÿå¿«é€Ÿæ­å»ºå¼€å‘æ‰€éœ€çŽ¯å¢ƒï¼Œæµ‹è¯•å®žéªŒæ–°ç»„ä»¶(å¦‚rabbitmq,kafka).é¿å…å› å®‰è£…è€Œæµªè´¹å¤ªå¤šæ—¶é—´ï¼Œæˆ‘çš„ç›®çš„æ˜¯å¿«é€Ÿå°è¯•ä½¿ç”¨ã€‚ å®‰è£…dockerbrew cask install docker docker-composeCompose æ˜¯ä¸€ä¸ªç”¨æˆ·å®šä¹‰å’Œè¿è¡Œå¤šä¸ªå®¹å™¨çš„ Docker åº”ç”¨ç¨‹åºã€‚åœ¨ Compose ä¸­ä½ å¯ä»¥ä½¿ç”¨ YAML æ–‡ä»¶æ¥é…ç½®ä½ çš„åº”ç”¨æœåŠ¡ã€‚ç„¶åŽï¼Œåªéœ€è¦ä¸€ä¸ªç®€å•çš„å‘½ä»¤ï¼Œå°±å¯ä»¥åˆ›å»ºå¹¶å¯åŠ¨ä½ é…ç½®çš„æ‰€æœ‰æœåŠ¡ã€‚ ç›®å½•ç»“æž„ ä¸€ç»„æœåŠ¡å»ºç«‹ä¸€ä¸ªç›®å½• é…ç½®æ–‡ä»¶version: '2' services: php7.2: image: php:7.2-fpm ports: - \"9000:9000\" volumes: - ./php:/usr/local/etc/php - /Users/caowenpeng/www:/www nginx: image: nginx ports: - \"80:80\" volumes: - /Users/caowenpeng/www:/www - ./nginx:/etc/nginx å¯åŠ¨docker-compose up -d å¸¸ç”¨å‘½ä»¤ å‘½ä»¤ è¯´æ˜Ž up åˆ›å»ºå’Œå¯åŠ¨å®¹å™¨ ps åˆ—å‡ºæ‰€æœ‰å®¹å™¨ down åœæ­¢å¹¶åˆ é™¤å®¹å™¨ï¼Œé•œåƒï¼ŒæŒ‚è½½ start å¯åŠ¨æœåŠ¡ stop åœæ­¢æœåŠ¡ restart é‡å¯æœåŠ¡ ç¬¬ä¸€æ¬¡ä½¿ç”¨up,ä¹‹åŽä½¿ç”¨start,å¦‚æžœå†æ¬¡ä½¿ç”¨upå°†ä¼šé‡æ–°åˆ›å»ºå®¹å™¨ï¼Œä¸€äº›å¯¹å®¹å™¨çš„ä¿®æ”¹å°†ä¼šä¸¢å¤± å…¶ä»–é—®é¢˜è¿›å…¥å®¹å™¨ docker-compose exec php7.2 bash è¿›å…¥å®¹å™¨åŽä¼šå‘çŽ°åªèƒ½ç”¨å°‘é‡å‘½ä»¤ï¼Œè¿žpsç­‰éƒ½æ²¡æœ‰ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦å®‰è£…ä¸€äº›ç¨‹åº apt-get update ##æ›´æ–°å…ƒ apt-get install procps ## å®‰è£… ps å®‰è£…php-rdkafkaæ‹“å±• apt-get install wget wget https://github.com/edenhill/librdkafka/archive/master.zip apt-get install unzip unzip master.zip cd librdkafka ./configure make make install pecl install http://pecl.php.net/get/rdkafka-3.0.4.tgz #åœ¨php.ini é…ç½®å¯ç”¨ rdkafkaæ‹“å±•","categories":[],"tags":[{"name":"docker","slug":"docker","permalink":"http://visonforcoding.xyz/tags/docker/"}]},{"title":"åœ°ç†ä½ç½®geoå¤„ç†ä¹‹mysqlå‡½æ•°","slug":"åœ°ç†ä½ç½®geoå¤„ç†ä¹‹mysqlå‡½æ•°","date":"2017-12-01T09:39:29.000Z","updated":"2021-10-30T02:59:33.283Z","comments":true,"path":"2017/12/01/åœ°ç†ä½ç½®geoå¤„ç†ä¹‹mysqlå‡½æ•°/","link":"","permalink":"http://visonforcoding.xyz/2017/12/01/%E5%9C%B0%E7%90%86%E4%BD%8D%E7%BD%AEgeo%E5%A4%84%E7%90%86%E4%B9%8Bmysql%E5%87%BD%E6%95%B0/","excerpt":"ç›®å‰è¶Šæ¥è¶Šå¤šçš„ä¸šåŠ¡éƒ½ä¼šåŸºäºŽLBSï¼Œé™„è¿‘çš„äººï¼Œå¤–å–ä½ç½®ï¼Œé™„è¿‘å•†å®¶ç­‰ç­‰ï¼ŒçŽ°å°±è®¨è®ºç¦»æˆ‘æœ€è¿‘è¿™ä¸€ä¸šåŠ¡åœºæ™¯çš„è§£å†³æ–¹æ¡ˆã€‚ ç›®å‰å·²çŸ¥è§£å†³æ–¹æ¡ˆæœ‰: mysql è‡ªå®šä¹‰å‡½æ•°è®¡ç®— mysql geoç´¢å¼• mongodb geoç´¢å¼• postgresql PostGisç´¢å¼• redis geo ElasticSearch æœ¬æ–‡æµ‹è¯•ä¸‹mysql å‡½æ•°è¿ç®—çš„æ€§èƒ½","text":"ç›®å‰è¶Šæ¥è¶Šå¤šçš„ä¸šåŠ¡éƒ½ä¼šåŸºäºŽLBSï¼Œé™„è¿‘çš„äººï¼Œå¤–å–ä½ç½®ï¼Œé™„è¿‘å•†å®¶ç­‰ç­‰ï¼ŒçŽ°å°±è®¨è®ºç¦»æˆ‘æœ€è¿‘è¿™ä¸€ä¸šåŠ¡åœºæ™¯çš„è§£å†³æ–¹æ¡ˆã€‚ ç›®å‰å·²çŸ¥è§£å†³æ–¹æ¡ˆæœ‰: mysql è‡ªå®šä¹‰å‡½æ•°è®¡ç®— mysql geoç´¢å¼• mongodb geoç´¢å¼• postgresql PostGisç´¢å¼• redis geo ElasticSearch æœ¬æ–‡æµ‹è¯•ä¸‹mysql å‡½æ•°è¿ç®—çš„æ€§èƒ½ å‡†å¤‡å·¥ä½œåˆ›å»ºæ•°æ®è¡¨CREATE TABLE `driver` ( `id` int(11) unsigned NOT NULL AUTO_INCREMENT, `lng` float DEFAULT NULL, `lat` float DEFAULT NULL, PRIMARY KEY (`id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; åˆ›å»ºæµ‹è¯•æ•°æ®åœ¨åˆ›å»ºæ•°æ®ä¹‹å‰å…ˆäº†è§£ä¸‹åŸºæœ¬çš„åœ°ç†çŸ¥è¯†: å…¨çƒç»çº¬åº¦çš„å–å€¼èŒƒå›´ä¸º: çº¬åº¦-9090ï¼Œç»åº¦-180180 ä¸­å›½çš„ç»çº¬åº¦èŒƒå›´å¤§çº¦ä¸ºï¼š çº¬åº¦3.8653.55ï¼Œç»åº¦73.66135.05 åŒ—äº¬è¡Œæ”¿ä¸­å¿ƒçš„çº¬åº¦ä¸º39.92ï¼Œç»åº¦ä¸º116.46 è¶ŠåŒ—é¢çš„åœ°æ–¹çº¬åº¦æ•°å€¼è¶Šå¤§ï¼Œè¶Šä¸œé¢çš„åœ°æ–¹ç»åº¦æ•°å€¼è¶Šå¤§ åº¦åˆ†è½¬æ¢ï¼š å°†åº¦åˆ†å•ä½æ•°æ®è½¬æ¢ä¸ºåº¦å•ä½æ•°æ®ï¼Œå…¬å¼ï¼šåº¦=åº¦+åˆ†/60 åˆ†ç§’è½¬æ¢ï¼š å°†åº¦åˆ†ç§’å•ä½æ•°æ®è½¬æ¢ä¸ºåº¦å•ä½æ•°æ®ï¼Œå…¬å¼ï¼šåº¦ = åº¦ + åˆ† / 60 + ç§’ / 60 / 60 åœ¨çº¬åº¦ç›¸ç­‰çš„æƒ…å†µä¸‹ï¼š ç»åº¦æ¯éš”0.00001åº¦ï¼Œè·ç¦»ç›¸å·®çº¦1ç±³ åœ¨ç»åº¦ç›¸ç­‰çš„æƒ…å†µä¸‹ï¼š çº¬åº¦æ¯éš”0.00001åº¦ï¼Œè·ç¦»ç›¸å·®çº¦1.1ç±³ mysqlå‡½æ•°è®¡ç®—DELIMITER // CREATE DEFINER=`root`@`localhost` FUNCTION `getDistance`( `lng1` float(10,7) , `lat1` float(10,7) , `lng2` float(10,7) , `lat2` float(10,7) ) RETURNS double COMMENT 'è®¡ç®—2åæ ‡ç‚¹è·ç¦»' BEGIN declare d double; declare radius int; set radius = 6371000; #å‡è®¾åœ°çƒä¸ºæ­£çƒå½¢ï¼Œç›´å¾„ä¸º6371000ç±³ set d = (2*ATAN2(SQRT(SIN((lat1-lat2)*PI()/180/2) *SIN((lat1-lat2)*PI()/180/2)+ COS(lat2*PI()/180)*COS(lat1*PI()/180) *SIN((lng1-lng2)*PI()/180/2) *SIN((lng1-lng2)*PI()/180/2)), SQRT(1-SIN((lat1-lat2)*PI()/180/2) *SIN((lat1-lat2)*PI()/180/2) +COS(lat2*PI()/180)*COS(lat1*PI()/180) *SIN((lng1-lng2)*PI()/180/2) *SIN((lng1-lng2)*PI()/180/2))))*radius; return d; END// DELIMITER ; åˆ›å»ºæ•°æ®pythonè„šæœ¬# coding=utf-8 from orator import DatabaseManager, Model import logging import random import threading \"\"\" ä¸­å›½çš„ç»çº¬åº¦èŒƒå›´ çº¬åº¦3.86~53.55ï¼Œç»åº¦73.66~135.05ã€‚å¤§æ¦‚0.00001åº¦å·®è·1ç±³ \"\"\" # åˆ›å»º æ—¥å¿— å¯¹è±¡ logger = logging.getLogger() handler = logging.StreamHandler() formatter = logging.Formatter( '%(asctime)s %(name)-12s %(levelname)-8s %(message)s') handler.setFormatter(formatter) logger.addHandler(handler) logger.setLevel(logging.DEBUG) # Connect to the database config = &#123; 'mysql': &#123; 'driver': 'mysql', 'host': 'localhost', 'database': 'dbtest', 'user': 'root', 'password': '', 'prefix': '' &#125; &#125; db = DatabaseManager(config) Model.set_connection_resolver(db) class Driver(Model): __table__ = 'driver' __timestamps__ = False pass def ins_driver(thread_name,nums): logger.info('å¼€å¯çº¿ç¨‹%s' % thread_name) for _ in range(nums): lng = '%.5f' % random.uniform(73.66, 135.05) lat = '%.5f' % random.uniform(3.86, 53.55) driver = Driver() driver.lng = lng driver.lat = lat driver.save() thread_nums = 10 for i in range(thread_nums): t = threading.Thread(target=ins_driver, args=(i, 400000)) t.start() ä»¥ä¸Šè„šæœ¬åˆ›å»º10ä¸ªçº¿ç¨‹ï¼Œ10ä¸ªçº¿ç¨‹æ’å…¥4ä¸‡æ¡æ•°æ®ã€‚è€—è´¹150.18sæ‰§è¡Œå®Œ,æ€»å…±æ’å…¥40ä¸‡æ¡æ•°æ® æµ‹è¯• æµ‹è¯•çŽ¯å¢ƒ ç³»ç»Ÿï¼šmac os å†…å­˜ï¼š16G cpu: intel core i5 ç¡¬ç›˜: 500g å›ºæ€ç¡¬ç›˜ æµ‹è¯•ä¸‹æŸ¥æ‰¾è·ç¦»(134.38753,18.56734)è¿™ä¸ªåæ ‡ç‚¹æœ€è¿‘çš„10ä¸ªå¸æœº select *,`getDistance`(134.38753,18.56734,`lng`,`lat`) as dis from driver ORDER BY dis limit 10 è€—æ—¶ï¼š18.0s explain:å…¨è¡¨æ‰«æ æˆ‘æµ‹è¯•äº†ä»Ž1ä¸‡åˆ°10ä¸‡é—´éš”1ä¸‡å’Œä»Ž10ä¸‡åˆ°90ä¸‡æ¯é—´éš”10ä¸‡æµ‹è¯•çš„ç»“æžœå˜åŒ– ç»“è®º æ­¤æ–¹æ¡ˆåœ¨æ•°æ®é‡è¾¾åˆ°3ä¸‡æ¡æŸ¥è¯¢è€—æ—¶å°±ä¼šè¶…è¿‡1ç§’ å¤§çº¦æ¯å¢žåŠ 1ä¸‡æ¡å°±ä¼šå¢žåŠ 0.4ç§’çš„è€—æ—¶","categories":[],"tags":[{"name":"mysql","slug":"mysql","permalink":"http://visonforcoding.xyz/tags/mysql/"}]},{"title":"åœ°ç†ä½ç½®geoå¤„ç†ä¹‹mongodb geo ç´¢å¼•","slug":"åœ°ç†ä½ç½®å¤„ç†ä¹‹mongodb","date":"2017-12-01T02:34:00.000Z","updated":"2021-10-30T02:59:33.283Z","comments":true,"path":"2017/12/01/åœ°ç†ä½ç½®å¤„ç†ä¹‹mongodb/","link":"","permalink":"http://visonforcoding.xyz/2017/12/01/%E5%9C%B0%E7%90%86%E4%BD%8D%E7%BD%AE%E5%A4%84%E7%90%86%E4%B9%8Bmongodb/","excerpt":"ç›®å‰è¶Šæ¥è¶Šå¤šçš„ä¸šåŠ¡éƒ½ä¼šåŸºäºŽLBSï¼Œé™„è¿‘çš„äººï¼Œå¤–å–ä½ç½®ï¼Œé™„è¿‘å•†å®¶ç­‰ç­‰ï¼ŒçŽ°å°±è®¨è®ºç¦»æˆ‘æœ€è¿‘è¿™ä¸€ä¸šåŠ¡åœºæ™¯çš„è§£å†³æ–¹æ¡ˆã€‚ ç›®å‰å·²çŸ¥è§£å†³æ–¹æ¡ˆæœ‰: mysql è‡ªå®šä¹‰å‡½æ•°è®¡ç®— mysql geoç´¢å¼• mongodb geoç´¢å¼• postgresql PostGisç´¢å¼• redis geo ElasticSearch æœ¬æ–‡æµ‹è¯•ä¸‹mongodb geoç´¢å¼• å‡½æ•°è¿ç®—çš„æ€§èƒ½","text":"ç›®å‰è¶Šæ¥è¶Šå¤šçš„ä¸šåŠ¡éƒ½ä¼šåŸºäºŽLBSï¼Œé™„è¿‘çš„äººï¼Œå¤–å–ä½ç½®ï¼Œé™„è¿‘å•†å®¶ç­‰ç­‰ï¼ŒçŽ°å°±è®¨è®ºç¦»æˆ‘æœ€è¿‘è¿™ä¸€ä¸šåŠ¡åœºæ™¯çš„è§£å†³æ–¹æ¡ˆã€‚ ç›®å‰å·²çŸ¥è§£å†³æ–¹æ¡ˆæœ‰: mysql è‡ªå®šä¹‰å‡½æ•°è®¡ç®— mysql geoç´¢å¼• mongodb geoç´¢å¼• postgresql PostGisç´¢å¼• redis geo ElasticSearch æœ¬æ–‡æµ‹è¯•ä¸‹mongodb geoç´¢å¼• å‡½æ•°è¿ç®—çš„æ€§èƒ½ å‡†å¤‡å·¥ä½œåˆ›å»ºæ•°æ®è¡¨db.driver.createIndex(&#123;loc: \"2dsphere\"&#125;) åˆ›å»ºæ•°æ®pythonè„šæœ¬# coding=utf-8 from pymongo import MongoClient import logging import random import threading \"\"\" ä¸­å›½çš„ç»çº¬åº¦èŒƒå›´ çº¬åº¦3.86~53.55ï¼Œç»åº¦73.66~135.05ã€‚å¤§æ¦‚0.00001åº¦å·®è·1ç±³ \"\"\" # åˆ›å»º æ—¥å¿— å¯¹è±¡ logger = logging.getLogger() handler = logging.StreamHandler() formatter = logging.Formatter( '%(asctime)s %(name)-12s %(levelname)-8s %(message)s') handler.setFormatter(formatter) logger.addHandler(handler) logger.setLevel(logging.DEBUG) # Connect to the mongodb database mongoconn = MongoClient('127.0.0.1', 27017) mdb = mongoconn.geo_analysis driver_collection = mdb.driver def ins_driver(thread_name, nums): logger.info('å¼€å¯çº¿ç¨‹%s' % thread_name) for i in range(nums): lng = '%.5f' % random.uniform(73.66, 135.05) lat = '%.5f' % random.uniform(3.86, 53.55) logging.debug('æ’å…¥è®°å½•:%s' % i) driver_collection.insert_one(&#123; \"loc\":[ float(lng), float(lat) ] &#125;) thread_nums = 10 for i in range(thread_nums): t = threading.Thread(target=ins_driver, args=(i, 40000)) t.start() ä»¥ä¸Šè„šæœ¬åˆ›å»º10ä¸ªçº¿ç¨‹ï¼Œ10ä¸ªçº¿ç¨‹æ’å…¥4ä¸‡æ¡æ•°æ®ã€‚è€—è´¹52.43sæ‰§è¡Œå®Œ,æ€»å…±æ’å…¥40ä¸‡æ¡æ•°æ® æµ‹è¯• æµ‹è¯•çŽ¯å¢ƒ ç³»ç»Ÿï¼šmac os å†…å­˜ï¼š16G cpu: intel core i5 ç¡¬ç›˜: 500g å›ºæ€ç¡¬ç›˜ æµ‹è¯•ä¸‹æŸ¥æ‰¾è·ç¦»(134.38753,18.56734)é™„è¿‘20å…¬é‡Œçš„å¸æœº db.runCommand(&#123;geoNear:'driver', near:[134.38753,18.56734], spherical:true, maxDistance:20000/6378000, distanceMultiplier:6378000&#125;); è€—æ—¶ï¼š0.001s explain:ä½¿ç”¨ç´¢å¼•","categories":[],"tags":[{"name":"æ–¹æ¡ˆ","slug":"æ–¹æ¡ˆ","permalink":"http://visonforcoding.xyz/tags/%E6%96%B9%E6%A1%88/"}]},{"title":"ç¨‹åºå‘˜ä»£ç ä¸‹çš„è®¸è±ªæ°(æŠ€æœ¯ç¯‡)","slug":"python/ç¨‹åºå‘˜ä»£ç ä¸‹çš„è®¸è±ªæ°-æŠ€æœ¯ç¯‡","date":"2017-08-05T05:16:00.000Z","updated":"2021-10-30T02:59:33.281Z","comments":true,"path":"2017/08/05/python/ç¨‹åºå‘˜ä»£ç ä¸‹çš„è®¸è±ªæ°-æŠ€æœ¯ç¯‡/","link":"","permalink":"http://visonforcoding.xyz/2017/08/05/python/%E7%A8%8B%E5%BA%8F%E5%91%98%E4%BB%A3%E7%A0%81%E4%B8%8B%E7%9A%84%E8%AE%B8%E8%B1%AA%E6%9D%B0-%E6%8A%80%E6%9C%AF%E7%AF%87/","excerpt":"æŽ¥ä¸Šç¯‡ï¼Œè¿™ä¸€ç¯‡å°†ä»ŽæŠ€æœ¯å±‚é¢è®²è®²æ˜¯å¦‚ä½•å®žçŽ°çš„ã€‚é˜…è¯»æœ¬æ–‡æ‚¨å°†ä¼šäº†è§£å¦‚ä½•ç”¨pythonçˆ¬å–å¾®åšçš„è¯„è®ºä»¥åŠå¦‚ä½•ç”¨python word_cloudåº“è¿›è¡Œæ•°æ®å¯è§†åŒ–ã€‚ ä¸Šä¸€ç¯‡:ç¨‹åºå‘˜ä»£ç ä¸‹çš„è®¸è±ªæ°","text":"æŽ¥ä¸Šç¯‡ï¼Œè¿™ä¸€ç¯‡å°†ä»ŽæŠ€æœ¯å±‚é¢è®²è®²æ˜¯å¦‚ä½•å®žçŽ°çš„ã€‚é˜…è¯»æœ¬æ–‡æ‚¨å°†ä¼šäº†è§£å¦‚ä½•ç”¨pythonçˆ¬å–å¾®åšçš„è¯„è®ºä»¥åŠå¦‚ä½•ç”¨python word_cloudåº“è¿›è¡Œæ•°æ®å¯è§†åŒ–ã€‚ ä¸Šä¸€ç¯‡:ç¨‹åºå‘˜ä»£ç ä¸‹çš„è®¸è±ªæ° å‡†å¤‡å·¥ä½œæ‰“å¼€å¾®åšpc mç«™å¹¶æ‰¾åˆ°è®¸è±ªæ°è¯¥æ¡å¾®åšåœ°å€:https://m.weibo.cn/status/4132385564040383 ä¸ºä»€ä¹ˆè¦ç”¨mç«™åœ°å€ï¼Ÿå› ä¸ºmç«™å¯ä»¥ç›´æŽ¥æŠ“å–åˆ°api jsonæ•°æ®,è€Œpcç«™è™½ç„¶ä¹Ÿæœ‰apiè¿”å›žçš„æ˜¯html,ç›¸æ¯”è€Œè¨€é€‰å–mç«™ä¼šçœåŽ»å¾ˆå¤šéº»çƒ¦ æ‰“å¼€è¯¥é¡µé¢ï¼Œå¹¶ä¸”ç”¨chrome çš„æ£€æŸ¥å·¥å…· æŸ¥çœ‹networkï¼Œå¯ä»¥èŽ·å–åˆ°è¯„è®ºçš„apiåœ°å€ã€‚ æ•°æ®æŠ“å–é¦–å…ˆè§‚å¯Ÿapiè¿”å›ž ä»Žè¿”å›žåœ°å€ä¸Šå¯ä»¥çœ‹åˆ°å¯ä»¥é€šè¿‡å‚æ•°page æ”¹å˜è¯·æ±‚çš„é¡µç ,å¹¶ä¸”æ¯é¡µéƒ½å›žè¿”å›žæ€»æ¡æ•°å’Œæ€»é¡µç æ•°ã€‚è¿™é‡Œæˆ‘å†³å®šé‡‡ç”¨å¤šçº¿ç¨‹æ¥æŠ“åŽ»(å…¶å®žæ•°æ®é‡ä¸å¤§,ä¹Ÿå¯ä»¥å•çº¿ç¨‹è·‘)ã€‚ å…¶ä¸­åœ¨çˆ¬å–æ•°æ®çš„æ—¶å€™ä¼šé¢ä¸´å‡ ä¸ªé—®é¢˜ï¼š1.å­˜å‚¨é€‰æ‹© æˆ‘è¿™é‡Œé€‰ç”¨äº†MongoDBä½œä¸ºæ•°æ®å­˜å‚¨ï¼Œå› ä¸ºapié€šå¸¸è¿”å›žçš„æ˜¯jsonæ•°æ®è€Œjsonç»“æž„å’ŒMongoDBçš„å­˜å‚¨æ–¹å¼å¯ä»¥ç»“åˆçš„å¾ˆé»˜å¥‘ï¼Œä¸éœ€è¦ç»è¿‡ä»»ä½•å¤„ç†å¯ä»¥ç›´æŽ¥çš„è¿›è¡Œæ’å…¥ã€‚ 2.é˜²çˆ¬è™« å¾ˆå¤šç½‘ç«™å¯èƒ½ä¼šåšä¸€äº›é˜²çˆ¬è™«çš„å¤„ç†ï¼Œé¢å¯¹åŒä¸€ä¸ªè¯·æ±‚ipçš„çŸ­æ—¶é—´çš„é«˜é¢‘çŽ‡è¯·æ±‚ä¼šè¿›è¡ŒæœåŠ¡éš”æ–­(ç›´æŽ¥å‘Šè¯‰ä½ æœåŠ¡ä¸å¯ç”¨)ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥åŽ»ç½‘ä¸Šæ‰¾ä¸€äº›ä»£ç†è¿›è¡Œè¯·æ±‚ã€‚ 3.å¤šçº¿ç¨‹çš„ä»»åŠ¡åˆ†é… é‡‡ç”¨å¤šçº¿ç¨‹çˆ¬å–ä½ å½“ç„¶ä¸èƒ½è®©å¤šä¸ªçº¿ç¨‹åŽ»çˆ¬å–åŒæ ·çš„é“¾æŽ¥åšåˆ«äººå·²ç»åšè¿‡çš„äº‹æƒ…ï¼Œé‚£æ ·å¤šçº¿ç¨‹æ¯«æ— æ„ä¹‰ã€‚æ‰€ä»¥ä½ éœ€è¦åˆ¶å®šä¸€å¥—è§„åˆ™ï¼Œè®©ä¸åŒçº¿ç¨‹çˆ¬å–ä¸åŒçš„é“¾æŽ¥ã€‚ # coding=utf-8 from __future__ import division from pymongo import MongoClient import requests import sys import re import random import time import logging import threading import json from os import path import math # çˆ¬å–å¾®åšè¯„è®º # mç«™å¾®åšåœ°å€ weibo_url = 'https://m.weibo.cn/status/4132385564040383' thread_nums = 5 #çº¿ç¨‹æ•° #ä»£ç†åœ°å€ proxies = &#123; \"http\": \"http://171.92.4.67:9000\", \"http\": \"http://163.125.222.240:8118\", \"http\": \"http://121.232.145.251:9000\", \"http\": \"http://121.232.147.247:9000\", &#125; # åˆ›å»º æ—¥å¿— å¯¹è±¡ logger = logging.getLogger() handler = logging.StreamHandler() formatter = logging.Formatter( '%(asctime)s %(name)-12s %(levelname)-8s %(message)s') handler.setFormatter(formatter) logger.addHandler(handler) logger.setLevel(logging.DEBUG) mongoconn = MongoClient('127.0.0.1', 27017) mdb = mongoconn.data_analysis das_collection = mdb.weibo weiboid_reobj = re.match(r'.*status/(\\d+)', weibo_url) weibo_id = weiboid_reobj.group(1) def scrapy_comments(weibo_id, page): weibo_comment_url = 'https://m.weibo.cn/api/comments/show?id=%s&amp;page=%d' % ( weibo_id, page) res = requests.get(weibo_comment_url) res_obj = json.loads(res.content) return res_obj def import_comments(threadName, weibo_id, page_start, page_end): logger.info('å¼€å§‹çº¿ç¨‹:%s' % threadName) for page in range(page_start, page_end + 1): logging.info('è¯»å–ç¬¬%sé¡µ' % page) time.sleep(1) # continue try: res_obj = scrapy_comments(weibo_id, page) logging.info('è¯¥é¡µæœ‰%sæ¡è®°å½•' % len(res_obj['data'])) except: logging.error('è¯»å–%sé¡µæ—¶å‘ç”Ÿé”™è¯¯' % page) continue if res_obj['ok'] == 1: comments = res_obj['data'] for comment in comments: comment_text = re.sub( r'&lt;/?\\w+[^>]*>', '', comment['text']).encode('utf-8') if re.search(r'å›žå¤@.*:', comment_text): # è¿‡æ»¤æŽ‰å›žå¤åˆ«äººçš„è¯„è®º continue comment['text'] = comment_text comment['weibo_id'] = weibo_id logging.info('è¯»å–è¯„è®º:%s' % comment['id']) try: if das_collection.find_one(&#123;'id': comment['id']&#125;): logging.info('åœ¨mongodbä¸­å­˜åœ¨') else: logging.info('æ’å…¥è®°å½•:%s' % comment['id']) das_collection.insert_one(comment) except: logging.error('mongodbå‘ç”Ÿé”™è¯¯') else: logging.error('è¯»å–ç¬¬%sé¡µæ—¶å‘ç”Ÿé”™è¯¯' % page) logging.info('çº¿ç¨‹%sç»“æŸ' % threadName) # res_obj = scrapy_comments(weibo_id, page) if __name__ == '__main__': # åˆ†é…ä¸åŒé“¾æŽ¥åˆ°ä¸åŒçš„çº¿ç¨‹ä¸ŠåŽ» res_obj = scrapy_comments(weibo_id, 1) if res_obj['ok'] == 1: total_number = res_obj['total_number'] logging.info('è¯¥æ¡å¾®åšæœ‰:%sæ¡è¯„è®º' % total_number) max_page = res_obj['max'] page_nums = math.ceil(max_page / thread_nums) else: raise # print max_page # print page_nums for i in range(1, thread_nums + 1): if i &lt; thread_nums: page_end = page_nums * i else: page_end = max_page page_start = (i - 1) * page_nums + 1 t = threading.Thread(target=import_comments, args=( i, weibo_id, int(page_start), int(page_end))) t.start() æ•°æ®æ•´ç†å¯è§†åŒ–(data visualization)è¿è¡Œè„šæœ¬å®Œæ¯•ï¼Œæˆ‘çš„MongoDBå¾—åˆ°äº†2ä¸‡å¤šæ¡è¯„è®ºæ•°æ®ï¼ŒæŽ¥ä¸‹æ¥è¦åšçš„äº‹æ˜¯å¯¹è¿™éƒ¨åˆ†æ•°æ®è¿›è¡Œæå–ã€æ¸…æ´—ã€ç»“æž„åŒ–ç­‰æ“ä½œã€‚è¿™é‡Œé¡ºä¾¿è¯´æ˜Žä¸€ä¸‹python æ•°æ®åˆ†æžçš„ å¤§è‡´åŸºæœ¬æµç¨‹ã€‚ 1.ä¸Žå¤–ç•Œè¿›è¡Œäº¤äº’è¿™ä¸ªè¿‡ç¨‹åŒ…æ‹¬æ•°æ®çš„èŽ·å–ã€è¯»å–ã€‚ä¸ç®¡æ˜¯ä»Žç½‘ç»œèµ„æºä¸Šçˆ¬å–ã€è¿˜æ˜¯ä»ŽçŽ°æœ‰èµ„æº(å„æ ·çš„æ–‡ä»¶å¦‚æ–‡æœ¬ã€excelã€æ•°æ®åº“å­˜å‚¨å¯¹è±¡) 2.å‡†å¤‡å·¥ä½œå¯¹æ•°æ®è¿›è¡Œæ¸…æ´—(cleaning)ã€ä¿®æ•´(munging)ã€æ•´åˆ(combining)ã€è§„èŒƒåŒ–(normalizing)ã€é‡å¡‘(reshaping)ã€åˆ‡ç‰‡(slicing)å’Œåˆ‡å—(dicing) 3.è½¬æ¢å¯¹æ•°æ®é›†åšä¸€äº›æ•°å­¦å’Œç»Ÿè®¡è¿ç®—äº§ç”Ÿæ–°çš„æ•°æ®é›† 4.å»ºæ¨¡å’Œè®¡ç®—å°†æ•°æ®è·Ÿç»Ÿè®¡æ¨¡åž‹ã€æœºå™¨å­¦ä¹ ç®—æ³•æˆ–å…¶ä»–è®¡ç®—å·¥å…·è”ç³»èµ·æ¥ 5.å±•ç¤ºåˆ›å»ºäº¤äº’å¼çš„æˆ–é™æ€çš„å›¾ç‰‡æˆ–æ–‡å­—æ‘˜è¦ ä¸‹é¢æˆ‘ä»¬æ¥è¿›è¡Œ2ã€3åŠ5çš„å·¥ä½œ: # coding=utf-8 import sys from pymongo import MongoClient import random # åˆ†è¯åº“ # from snownlp import SnowNLP import jieba import uniout from collections import Counter, OrderedDict # è¯è¯­äº‘ æ–‡æœ¬ç»Ÿè®¡å¯è§†åŒ–åº“ from wordcloud import WordCloud mongoconn = MongoClient('127.0.0.1', 27017) mdb = mongoconn.data_analysis das_collection = mdb.weibo total_counts = das_collection.find().count() # random_int = random.randint(0, total_counts - 1) docs = das_collection.find() print docs.count() words_counts = &#123;&#125; for doc in docs: print doc comment_text = doc['text'].encode('utf-8') if len(comment_text) == 0: continue words = jieba.cut(comment_text) for word in words: if word not in words_counts: words_counts[word] = 1 else: words_counts[word] += 1 for word in words_counts.keys(): if words_counts[word] &lt; 2 or len(word) &lt; 2: del words_counts[word] # print words_counts.items() #æ³¨æ„è¦è®©ä¸­æ–‡ä¸ä¹±ç è¦æŒ‡å®šä¸­æ–‡å­—ä½“ #fit_words æŽ¥æ”¶å‚æ•°æ˜¯dict eg:&#123;'ä½ ':333,'å¥½':23&#125; æ–‡å­—:å‡ºçŽ°æ¬¡æ•° wordcloud = WordCloud( font_path='/Users/cwp/font/msyh.ttf', background_color='white', width=1200, height=1000 ).fit_words(words_counts) import matplotlib.pyplot as plt plt.imshow(wordcloud, interpolation='bilinear') plt.axis(\"off\") plt.show() ä»‹ç»ä¸‹ä»¥ä¸Šä»£ç ï¼šæˆ‘ä»¬ä¸»è¦ç”¨åˆ°äº†2ä¸ªå·¥å…·ï¼Œjiebaå’Œword_cloudã€‚å‰è€…å¯¹ä¸­æ–‡è¿›è¡Œåˆ†è¯åŽè€…å›¾å½¢åŒ–å±•ç¤ºè¯è¯­çš„å‡ºçŽ°é¢‘çŽ‡ã€‚ä¼—æ‰€å‘¨çŸ¥ï¼Œä¸­æ–‡ç³»çš„è¯­è¨€å¤„ç†ææ€•æ˜¯æœ€éš¾çš„è‡ªç„¶è¯­è¨€å¤„ç†(NLP)çš„è¯­ç§ã€‚å°±åŸºæœ¬çš„åˆ†è¯è€Œè¨€éƒ½æ˜¯ä¸€é¡¹æ¯”è¾ƒå›°éš¾çš„å·¥ä½œ,(è‹±è¯­å¥å­ä¸­æ¯ä¸ªå•è¯éƒ½æ˜¯æœ‰ç©ºæ ¼åˆ†å¼€çš„ï¼Œè€Œä¸­æ–‡æ˜¯ç”±å•ä¸ªå­—ç»„æˆè¯è¿žæŽ¥æˆä¸²ç»„æˆå¥).ä¸¾ä¸ªä¾‹å­,è¯·ç”¨â€œå­©æâ€é€ å¥,â€é‚£ä¸ªç”·å­©æäº¤å®Œä»£ç å°±ä¸‹ç­äº†â€ã€‚å¦‚æžœäººå·¥åˆ†è¯ï¼Œå¯ä»¥çŸ¥é“â€ç”·å­©â€å’Œâ€æäº¤â€åº”è¯¥æ˜¯åˆ†å¼€çš„2ä¸ªè¯ï¼Œä½†æ˜¯å¯¹äºŽæœºå™¨è€Œè¨€ï¼Œè¦è¾¨åˆ«â€æâ€åº”è¯¥ä¸Žâ€ç”·â€è¿˜æ˜¯â€äº¤â€è¿›è¡Œç»„è¯å°±å¾ˆéš¾åŠžäº†ã€‚è¦æƒ³æœºå™¨èƒ½å¤Ÿæ›´ç²¾ç¡®çš„è¾¨åˆ«è¿™ç±»é—®é¢˜ï¼Œå°±éœ€è¦è®©æœºå™¨ä¸åœå­¦ä¹ ï¼Œè®©å®ƒçŸ¥é“è¿™ç§æƒ…å†µè¯¥è¿™ä¹ˆåˆ†è€Œä¸æ˜¯é‚£ä¹ˆåˆ†ã€‚ç ”ç©¶ä¸­æ–‡è‡ªç„¶è¯­è¨€å¤„ç†å°†æ˜¯ä¸€ä¸ªé•¿ä¹…è€Œå¤§çš„å·¥ç¨‹ï¼Œå¯¹äºŽåˆ†æžæ•°æ®(æˆ‘ä»¬ä¸æ˜¯è¦ç ”ç©¶è‡ªç„¶è¯­è¨€å¤„ç†ðŸ˜)ï¼Œè¿™é‡Œå°±å€ŸåŠ©jiebaè¿™ä¸ªåº“è¿›è¡Œå·¥ä½œäº†. å¯¹äºŽword_cloud,å›¾å½¢åŒ–æ–‡æœ¬ç»Ÿè®¡ï¼Œç½‘ä¸Šæœ‰ä¸å°‘çš„åšæ–‡éƒ½è´´äº†ä»£ç ï¼Œä½†æˆ‘æƒ³è¯´çš„æ˜¯æˆ‘ä¸äº†è§£å®ƒä»¬æ˜¯ä¸æ˜¯çœŸçš„è¿è¡Œå‡ºäº†ç»“æžœã€‚å› ä¸ºfit_words è¿™ä¸ªå‡½æ•°æŽ¥æ”¶çš„æ˜¯dictè€Œä¸æ˜¯listï¼Œå®˜æ–¹æ–‡æ¡£å’Œå‡½æ•°docå…¶å®žå†™é”™äº†,åœ¨githubä¸Šæœ‰æŠ«éœ²ã€‚ æœ€åŽå¾—åˆ°ç»“æžœ: ä¸€äº›ç”¨åˆ°çš„å·¥å…·1.word_cloud A little word cloud generator in Python 2.jieba ç»“å·´ä¸­æ–‡åˆ†è¯ 3.Requests is the only Non-GMO HTTP library for Python, safe for human consumption.","categories":[],"tags":[]}],"categories":[],"tags":[{"name":"ç¼–ç äººç”Ÿ","slug":"ç¼–ç äººç”Ÿ","permalink":"http://visonforcoding.xyz/tags/%E7%BC%96%E7%A0%81%E4%BA%BA%E7%94%9F/"},{"name":"java","slug":"java","permalink":"http://visonforcoding.xyz/tags/java/"},{"name":"PHP","slug":"PHP","permalink":"http://visonforcoding.xyz/tags/PHP/"},{"name":"è½¯ä»¶","slug":"è½¯ä»¶","permalink":"http://visonforcoding.xyz/tags/%E8%BD%AF%E4%BB%B6/"},{"name":"ç®¡ç†","slug":"ç®¡ç†","permalink":"http://visonforcoding.xyz/tags/%E7%AE%A1%E7%90%86/"},{"name":"æŠ€æœ¯å·¥ç¨‹","slug":"æŠ€æœ¯å·¥ç¨‹","permalink":"http://visonforcoding.xyz/tags/%E6%8A%80%E6%9C%AF%E5%B7%A5%E7%A8%8B/"},{"name":"php","slug":"php","permalink":"http://visonforcoding.xyz/tags/php/"},{"name":"æž¶æž„","slug":"æž¶æž„","permalink":"http://visonforcoding.xyz/tags/%E6%9E%B6%E6%9E%84/"},{"name":"mysql","slug":"mysql","permalink":"http://visonforcoding.xyz/tags/mysql/"},{"name":"web","slug":"web","permalink":"http://visonforcoding.xyz/tags/web/"},{"name":"è½¯ä»¶å·¥ç¨‹","slug":"è½¯ä»¶å·¥ç¨‹","permalink":"http://visonforcoding.xyz/tags/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B/"},{"name":"æ–¹æ¡ˆ","slug":"æ–¹æ¡ˆ","permalink":"http://visonforcoding.xyz/tags/%E6%96%B9%E6%A1%88/"},{"name":"JAVA","slug":"JAVA","permalink":"http://visonforcoding.xyz/tags/JAVA/"},{"name":"Java","slug":"Java","permalink":"http://visonforcoding.xyz/tags/Java/"},{"name":"spring-boot","slug":"spring-boot","permalink":"http://visonforcoding.xyz/tags/spring-boot/"},{"name":"è¿ç»´","slug":"è¿ç»´","permalink":"http://visonforcoding.xyz/tags/%E8%BF%90%E7%BB%B4/"},{"name":"devops","slug":"devops","permalink":"http://visonforcoding.xyz/tags/devops/"},{"name":"webå‰ç«¯","slug":"webå‰ç«¯","permalink":"http://visonforcoding.xyz/tags/web%E5%89%8D%E7%AB%AF/"},{"name":"python","slug":"python","permalink":"http://visonforcoding.xyz/tags/python/"},{"name":"kafka","slug":"kafka","permalink":"http://visonforcoding.xyz/tags/kafka/"},{"name":"php linux","slug":"php-linux","permalink":"http://visonforcoding.xyz/tags/php-linux/"},{"name":"java spring-boot","slug":"java-spring-boot","permalink":"http://visonforcoding.xyz/tags/java-spring-boot/"},{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://visonforcoding.xyz/tags/%E9%9A%8F%E7%AC%94/"},{"name":"ç¨‹åºäººç”Ÿ","slug":"ç¨‹åºäººç”Ÿ","permalink":"http://visonforcoding.xyz/tags/%E7%A8%8B%E5%BA%8F%E4%BA%BA%E7%94%9F/"},{"name":"docker","slug":"docker","permalink":"http://visonforcoding.xyz/tags/docker/"}]}