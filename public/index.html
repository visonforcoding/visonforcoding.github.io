<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>麦田麦穗</title>

  
  <meta name="author" content="vison">
  

  

  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  

  <meta property="og:site_name" content="麦田麦穗"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="麦田麦穗" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">麦田麦穗</a>
    </h1>
    <p class="site-description"></p>
  </div>
  <nav class="site-navigation">
    <ul>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    
  <article>

  
    
    <h3 class="article-title"><a href="/2021/06/02/mysql的waitimeout/"><span>mysql的waitimeout</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2021/06/02/mysql的waitimeout/" rel="bookmark">
        <time class="entry-date published" datetime="2021-06-02T12:33:18.000Z">
          2021-06-02
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>首先，我们看下</p>
<pre><code class="shell">show GLOBAL VARIABLES like &#39;%timeout%&#39;;</code></pre>
<p>默认值为28800s即8小时,我们改为100s</p>
<pre><code class="ini"># Default Homebrew MySQL server config
[mysqld]
# Only allow connections from localhost
bind-address = 0.0.0.0
wait_timeout=100
interactive_timeout=100</code></pre>
<p>重新查看结果</p>
<p><img src="https://vison-blog.oss-cn-beijing.aliyuncs.com/20210603144255.png" alt=""></p>
<p>查看对守护进程连接的影响</p>
<pre><code class="php"> public function longT()
    &#123;
        $TicketModel = new TicketModel();
        $this-&gt;success(&#39;开始建立连接...&#39;);
        while (true) &#123;
            sleep(120);
            dump($TicketModel-&gt;select(&#39;t_id&#39;)-&gt;fetch());
        &#125;
    &#125;</code></pre>
<p>发现在100s后的连接已被主动断开</p>
<p><img src="https://vison-blog.oss-cn-beijing.aliyuncs.com/20210603144315.png" alt=""></p>
<p>代码中的场景是，<strong>在wait_timeout之内无任何操作会自动关闭</strong></p>
<h2 id="官方解释"><a href="#官方解释" class="headerlink" title="官方解释"></a>官方解释</h2><p>interactive_timeout 28800</p>
<blockquote>
<p>The number of seconds the server waits for activity on an interactive connection before closing it. An interactive client is defined as a client that uses the <strong>CLIENT_INTERACTIVE</strong> option to mysql_real_connect(). See also wait_timeout.</p>
</blockquote>
<p>waitimeout 28800</p>
<p>The number of seconds the server waits for activity on a noninteractive connection before closing it.</p>
<p>On thread startup, the session wait_timeout value is initialized from the global wait_timeout value or from the global interactive_timeout value, depending on the type of client (as defined by the CLIENT_INTERACTIVE connect option to mysql_real_connect()). See also interactive_timeout.</p>
<p>通过MySQL客户端连接db的是交互会话，通过jdbc等程序连接db的是非交互会话。 </p>
<p>总结：</p>
<p>如果应用程序长时间的使用一个连接，而有机会长时间不进行任何操作。则会导致连接被关闭。</p>
<p>参考文献:</p>
<p>1.<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/5.7/en/server-system-variables.html">https://dev.mysql.com/doc/refman/5.7/en/server-system-variables.html</a><br>2.<a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1181515">https://cloud.tencent.com/developer/article/1181515</a></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/mysql/">mysql</a>
    </span>
    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2021/04/09/vue-quasar-electron-springboot-mysql撸一个TODO-LIST-看板/"><span>vue+quasar+electron+springboot+mysql撸一个TODO LIST 看板</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2021/04/09/vue-quasar-electron-springboot-mysql撸一个TODO-LIST-看板/" rel="bookmark">
        <time class="entry-date published" datetime="2021-04-09T03:39:08.000Z">
          2021-04-09
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>先看效果</p>
<p><img src="https://vison-blog.oss-cn-beijing.aliyuncs.com/20210330200044.png" alt=""></p>
<p>写本项目的目的有几点：</p>
<ol>
<li>学习下vue+electron桌面开发</li>
<li>学习下java和spring开发(本人一直使用PHP)</li>
<li>一直缺少一款能适合自己的TODO LIST软件，能有桌面端的</li>
</ol>
        
      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/web/">web</a>
    </span>
    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2021/03/03/编发编程日记-线程不安全的危害/"><span>并发编程日记-线程不安全的危害</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2021/03/03/编发编程日记-线程不安全的危害/" rel="bookmark">
        <time class="entry-date published" datetime="2021-03-03T11:16:37.000Z">
          2021-03-03
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p><img src="https://vison-blog.oss-cn-beijing.aliyuncs.com/20210303192545.png" alt=""></p>
        
      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/java/">java</a>
    </span>
    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2021/02/23/java/spring-boot记录sql探索/"><span>spring-boot记录sql探索</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2021/02/23/java/spring-boot记录sql探索/" rel="bookmark">
        <time class="entry-date published" datetime="2021-02-23T11:28:29.000Z">
          2021-02-23
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <blockquote>
<p>目标记录每次请求内的http、es、mysql耗时，本篇讨论mysql部分</p>
</blockquote>
<p>为什么说要探索，这不是很简单的事么？但是能满足以下几点么？</p>
<ul>
<li>能记录limit等参数</li>
<li>能将参数和sql写一起，能直接使用</li>
<li>能记录耗时</li>
<li>能计数累加,统计一次请求中sql执行的总数和总耗时</li>
</ul>
        
      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/java/">java</a>
    </span>
    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2021/02/22/spring-boot-vue的前后端分离部署/"><span>spring-boot+vue+supervisor+nginx的前后端分离部署</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2021/02/22/spring-boot-vue的前后端分离部署/" rel="bookmark">
        <time class="entry-date published" datetime="2021-02-22T06:43:54.000Z">
          2021-02-22
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <ul>
<li>要保证同域部署,因为跨域会有很多问题要重新解决</li>
</ul>
<p>顺便树下，但其实现在互联网产品一般都有多客户端，pc web 、小程序、app。保守的同域session模式保持会话已经满足不了一些需求。比如，单端登录等。</p>
<p>言归正传，我采取的思路是，前端请求接口时统一加上api前缀，nginx将api前缀的路由请求代理转发到spring-boot</p>
        
      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/java/">java</a>
    </span>
    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2021/01/23/利用Locust进行性能测试/"><span>利用Locust进行性能测试</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2021/01/23/利用Locust进行性能测试/" rel="bookmark">
        <time class="entry-date published" datetime="2021-01-23T02:17:02.000Z">
          2021-01-23
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <ul>
<li>要看一个项目的最大可用能力是多少，性能测试工作少不了.</li>
<li>每一个项目都应该做压测</li>
<li>多线程并发模型一定要做压测</li>
</ul>
        
      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/软件工程/">软件工程</a>
    </span>
    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2021/01/21/黑启动/"><span>黑启动</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2021/01/21/黑启动/" rel="bookmark">
        <time class="entry-date published" datetime="2021-01-21T13:38:28.000Z">
          2021-01-21
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h2 id="facebook案例"><a href="#facebook案例" class="headerlink" title="facebook案例"></a>facebook案例</h2><p>作为黑启动流程的一部分，每个Facebook 用户会话（在用户端浏览器中运行<br>JavaScript 代码）都加载了测试工具。虽然聊天功能的用户界面元素被隐藏起来，但浏览器<br>还是会向已部署在生产环境中的后台聊天服务器发送用户不可见的聊天测试信息，这使开</p>
<p>发团队能够在整个项目过程中模拟出类生产负载，从而在发布之前找出并解决性能问题。</p>
<p><img src="https://vison-blog.oss-cn-beijing.aliyuncs.com/20210121214126.jpeg" alt=""></p>
<p>老子惊了,这有点牛皮</p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2021/01/06/java/servlet集成mybatis-无xml-注解方式/"><span>servlet集成mybatis-无xml&amp;注解方式</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2021/01/06/java/servlet集成mybatis-无xml-注解方式/" rel="bookmark">
        <time class="entry-date published" datetime="2021-01-06T08:14:24.000Z">
          2021-01-06
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <blockquote>
<p>习惯了php项目之后，恐怕非常不喜欢操作xml吧.本章将介绍servlet+mybatis无xml配置模式。</p>
</blockquote>
        
      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/java/">java</a>
    </span>
    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2020/12/22/java/手撕javaweb开发/"><span>手撕javaweb开发</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2020/12/22/java/手撕javaweb开发/" rel="bookmark">
        <time class="entry-date published" datetime="2020-12-22T06:17:22.228Z">
          2020-12-22
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>本系列文章将以几乎0基础javaweb为背景手写一个javaweb框架并进行开发。</p>
<h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><ul>
<li>0基础javaweb,没有javaweb开发的实际经验</li>
<li>有多年PHPweb实战经验</li>
<li>有一定java语法基础</li>
<li>有5分(满分100)的spring boot知识储备，毕竟用spring boot启动一个hello world还是比较简单的。</li>
</ul>
<h2 id="宗旨"><a href="#宗旨" class="headerlink" title="宗旨"></a>宗旨</h2><p>本文宗旨是想通过手写java web框架的方式，让有其他语言web开发经验的同事能由浅入深学会java web开发和理解其中原理。本系列文章将有以下几点原则。</p>
<ul>
<li>注重实践，一定会有源代码运行成功案例</li>
<li>有理有据，一些实现必须有官方或权威文献解释</li>
</ul>
<h2 id="更新目录"><a href="#更新目录" class="headerlink" title="更新目录"></a>更新目录</h2><ol>
<li><a target="_blank" rel="noopener" href="https://visonforcoding.github.io/2020/12/18/java/%E6%98%A5%E5%A4%A9%E4%B9%8B%E5%89%8D-http/">手撕javaweb-HTTP前世</a></li>
</ol>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/java/">java</a>
    </span>
    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2020/12/21/java/log4j使用指南/"><span>log4j使用指南</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2020/12/21/java/log4j使用指南/" rel="bookmark">
        <time class="entry-date published" datetime="2020-12-21T06:28:40.445Z">
          2020-12-21
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>对于刚开始接触java的人来说，用什么来打日志似乎快被java的这么多概念搞懵了。log4j、log4j2、slf4j、logback?!!</p>
        
      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/java/">java</a>
    </span>
    

    </div>

    
  </div>
</article>




<nav class="pagination">
  
  
  <a href="/page/2/" class="pagination-next">Next</a>
  
</nav>
    </main>

    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    </br>
    
    &copy; 2021 vison
    
  </p>
</footer>
    
    
  </div>
</div>
</body>
</html>